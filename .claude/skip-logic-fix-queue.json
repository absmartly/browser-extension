{
  "queueVersion": "2.0",
  "created": "2025-10-28",
  "campaign": "Fix Erroneous Skip Logic in E2E Tests",
  "phase": "Skip Logic Remediation - Remove Blanket Skips on 'No Experiments' Condition",
  "totalTasks": 7,
  "executionStrategy": "Parallel execution: Agents 1-3 fix in parallel, Agents 4-7 verify in parallel after fixes complete",
  "critical": true,
  "criticalReason": "Phase 1, 2, and 3 agents added fundamentally incorrect skip logic that hides bugs. Tests should NOT skip when API has no experiments - that's expected behavior to test.",
  "instructions": "Each agent picks ONE task from their assigned group. Wave 1 agents (1-3) perform fixes and commit. Wave 2 agents (4-7) run tests and document results. All agents report git status when done.",
  "tasks": [
    {
      "id": "skip-fix-1a",
      "wave": "Wave 1 - Remove Erroneous Skips",
      "file": "tests/e2e/visual-editor-unified.spec.ts",
      "priority": "P0",
      "type": "Skip Logic Removal",
      "status": "pending",
      "assignedTo": "Agent-1",
      "knownIssue": "Contains erroneous test.skip() when 'No experiments found' message appears",
      "description": "Remove the conditional check that skips test when sidebar shows 'No experiments found' message. This message is CORRECT behavior when API returns no data - tests should verify this, not skip.",
      "estimatedMinutes": 15,
      "rootCauseAnalysis": "Phase 1 agents misunderstood test purpose. 'No experiments' is a valid UI state, not a reason to skip the test. Tests should verify the UI displays correctly in this state.",
      "fixStrategy": "Find lines that check for 'No experiments found' text and call test.skip(). Remove those lines entirely. Keep test structure, let it run and verify the message appears.",
      "checklist": [
        "Read file to locate exact erroneous skip pattern (around lines 126-131)",
        "Identify the block that checks for 'No experiments found' and calls test.skip()",
        "Remove ONLY the erroneous conditional skip block (keep rest of test intact)",
        "Verify test structure is still valid TypeScript",
        "Run test: npx playwright test tests/e2e/visual-editor-unified.spec.ts",
        "Verify test runs (may fail, but should not skip due to missing experiments)",
        "Commit: 'fix: remove erroneous no-experiments skip from visual-editor-unified'"
      ],
      "expectedOutcome": "Test will no longer skip when API has no experiments. Test may fail if experiment loading is broken, which is correct.",
      "reportingRequirements": "Document: (1) Exact lines removed, (2) Test run result (pass/fail/skip count), (3) Git status after commit"
    },
    {
      "id": "skip-fix-1b",
      "wave": "Wave 1 - Remove Erroneous Skips",
      "file": "All E2E test files",
      "priority": "P0",
      "type": "Skip Logic Removal - Bulk Scan",
      "status": "pending",
      "assignedTo": "Agent-2",
      "knownIssue": "Multiple test files may contain same erroneous skip pattern from Phase 1/2/3 agents",
      "description": "Scan ALL test files (tests/e2e/*.spec.ts) for the erroneous pattern: test.skip() called immediately after checking for 'No experiments found' text. Remove all such instances.",
      "estimatedMinutes": 30,
      "searchPattern": "Look for: test.skip() that comes after checking 'text=/No experiments found/i' or 'text=/no experiments/i'",
      "fixStrategy": "Use grep to find all instances of this pattern. For each file found: (1) Read the file, (2) Identify the erroneous block, (3) Remove it, (4) Commit separately with filename in message.",
      "checklist": [
        "Search for pattern: grep -r \"test.skip()\" tests/e2e/ --include=\"*.spec.ts\"",
        "For each match, check if it's preceded by 'No experiments found' check",
        "Create list of files needing fixes",
        "For each file: read, identify block, remove erroneous skip logic, run test, commit",
        "Document all files processed and their status",
        "Report any files you couldn't process due to syntax or complexity"
      ],
      "expectedOutcome": "All blanket 'no experiments' skips removed. Conditional skips that check for BOTH missing data AND missing empty state message will remain (those are legitimate).",
      "reportingRequirements": "Document: (1) Total files scanned, (2) Files with erroneous skips found, (3) Files fixed, (4) Git log showing commits made, (5) Any patterns that need manual review"
    },
    {
      "id": "skip-fix-1c",
      "wave": "Wave 1 - Review and Document",
      "file": "All test files with remaining skip() calls",
      "priority": "P0",
      "type": "Skip Logic Documentation",
      "status": "pending",
      "assignedTo": "Agent-3",
      "knownIssue": "After erroneous skips are removed, legitimate skips need clear documentation of WHY they exist",
      "description": "Review all remaining test.skip() calls in test files. For EACH skip: determine if it's legitimate (environmental limitation, platform constraint, etc.) and add clear comments explaining why.",
      "estimatedMinutes": 25,
      "examplesOfLegitimate": [
        "BroadcastChannel API doesn't work in Playwright headless (visual-editor-persistence.spec.ts)",
        "OAuth/auth timing depends on environment configuration",
        "Requires specific API setup that varies between environments"
      ],
      "examplesOfIllegitimate": [
        "Skipping when data is missing (not a skip reason - test should handle empty data)",
        "Skipping when API doesn't return experiments (should test empty state handling)",
        "Skipping when test complexity is high (test should be simplified, not skipped)"
      ],
      "checklist": [
        "Find all test.skip() calls in tests/e2e/ directory",
        "For each skip call, examine the context and condition",
        "Classify: Is this LEGITIMATE (environmental) or SUSPICIOUS (data-based)?",
        "For LEGITIMATE skips: add detailed comment explaining the limitation",
        "For SUSPICIOUS skips: flag for removal (should have been removed in Fix-1a/1b)",
        "Create summary list: [File, Line, Reason, Status]",
        "Commit documentation changes: 'docs: document skip reasons in test files'",
        "Report any skips you think are still erroneous"
      ],
      "expectedOutcome": "All remaining skips have clear documented reasons. No 'mystery skips' that happen for unclear reasons.",
      "reportingRequirements": "Document: (1) Complete list of all skip() calls found, (2) Classification (legitimate/suspicious), (3) Reason each skip exists, (4) Any skips flagged as still-erroneous, (5) Commit reference"
    },
    {
      "id": "skip-fix-verify-1",
      "wave": "Wave 2 - Verify Fixes",
      "file": "tests/e2e/visual-editor-simple.spec.ts",
      "priority": "P0",
      "type": "Test Verification",
      "status": "pending",
      "assignedTo": "Agent-4",
      "knownIssue": "This file had erroneous skip removed - need to verify test runs correctly",
      "description": "Run visual-editor-simple test after erroneous skip has been removed. Document results and compare with previous behavior.",
      "estimatedMinutes": 10,
      "checklist": [
        "Build extension: npm run build:dev (wait for completion)",
        "Run test: npx playwright test tests/e2e/visual-editor-simple.spec.ts",
        "Document full output: pass count, fail count, skip count",
        "If test fails, note the failure reason (this is useful information)",
        "Check git status - should show no uncommitted changes (fixes should be committed)",
        "Report: Did test skip before? Does it skip now? Why or why not?"
      ],
      "expectedOutcome": "Test runs without skipping due to 'no experiments' condition. Test result (pass/fail/skip) is now accurate.",
      "reportingRequirements": "Document: (1) Test command run, (2) Full test output/summary, (3) Pass/fail/skip counts, (4) Any errors or timeouts, (5) Git status showing clean working directory"
    },
    {
      "id": "skip-fix-verify-2",
      "wave": "Wave 2 - Verify Fixes",
      "file": "tests/e2e/visual-editor-demo.spec.ts and visual-editor-summary.spec.ts",
      "priority": "P0",
      "type": "Test Verification",
      "status": "pending",
      "assignedTo": "Agent-5",
      "knownIssue": "These two files had erroneous skips removed - run both to verify",
      "description": "Run both visual-editor-demo and visual-editor-summary tests. Document results.",
      "estimatedMinutes": 15,
      "checklist": [
        "Build extension: npm run build:dev",
        "Run tests: npx playwright test tests/e2e/visual-editor-demo.spec.ts tests/e2e/visual-editor-summary.spec.ts",
        "Document output: pass count, fail count, skip count for each",
        "Note any differences from before fixes",
        "Check git status",
        "Report on test health after skip removal"
      ],
      "expectedOutcome": "Both tests run without skipping due to missing experiments. Results reflect actual test status.",
      "reportingRequirements": "Document: (1) Test commands run, (2) Full output, (3) Pass/fail/skip for each file, (4) Git status"
    },
    {
      "id": "skip-fix-verify-3",
      "wave": "Wave 2 - Verify Fixes",
      "file": "tests/e2e/visual-editor-unified.spec.ts",
      "priority": "P0",
      "type": "Test Verification",
      "status": "pending",
      "assignedTo": "Agent-6",
      "knownIssue": "This file had erroneous skip removed in Fix-1a - verify it runs",
      "description": "Run visual-editor-unified test to verify the erroneous skip removal worked correctly.",
      "estimatedMinutes": 10,
      "checklist": [
        "Build extension: npm run build:dev",
        "Run test: npx playwright test tests/e2e/visual-editor-unified.spec.ts",
        "Document: pass/fail/skip counts",
        "Verify test no longer skips when 'No experiments found' appears",
        "Check git status",
        "Report results"
      ],
      "expectedOutcome": "Test runs correctly without the erroneous skip logic.",
      "reportingRequirements": "Document: (1) Test command, (2) Output summary, (3) Pass/fail/skip count, (4) Git status"
    },
    {
      "id": "skip-fix-verify-4",
      "wave": "Wave 2 - Verify Fixes",
      "file": "tests/e2e/ (Full Suite)",
      "priority": "P1",
      "type": "Full Suite Verification",
      "status": "pending",
      "assignedTo": "Agent-7",
      "knownIssue": "Need overall picture of test suite health after all fixes",
      "description": "Run full E2E test suite to get overall health metrics. Compare pass/fail/skip counts with previous run to see impact of skip logic fixes.",
      "estimatedMinutes": 40,
      "checklist": [
        "Build extension: npm run build:dev (wait for completion)",
        "Run full suite: npx playwright test tests/e2e/ --reporter=list",
        "Capture complete output with: npx playwright test tests/e2e/ --reporter=list 2>&1 | tee test-results-after-fix.txt",
        "Extract summary: total tests, passed, failed, skipped",
        "Compare with pre-fix numbers if available",
        "Document any NEW failures (these indicate bugs that were previously hidden by skips)",
        "Document any NEW passes (these indicate fixes that worked)",
        "Check git status",
        "Report overall suite health"
      ],
      "expectedOutcome": "Full test suite runs. Some tests may fail (that's good - they were being hidden before). Overall health metrics show accurate test status.",
      "reportingRequirements": "Document: (1) Full test command and output, (2) Summary statistics (total/passed/failed/skipped), (3) Compare to pre-fix if available, (4) NEW failures identified, (5) NEW passes, (6) Git status, (7) Assessment of overall suite health"
    }
  ]
}

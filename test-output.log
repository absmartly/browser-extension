ðŸš€ Starting global test setup...
âœ… Extension already built
âš ï¸  Note: Using existing build. Delete build/chrome-mv3-dev/manifest.json to force rebuild.
âœ… Copied seed.html to build directory
âœ… Copied local-test-page.html to build directory
âœ… Loaded environment variables from .env.local
âœ… API credentials found in environment
âœ… Global setup completed successfully
---

Running 1 test using 1 worker

âœ… Test page loaded (test mode enabled)
Extension ID: elelnihlihbhpkobodjiodoefdjpdcjp

ðŸ“‚ STEP 1: Injecting sidebar
âœ… Sidebar visible

âš™ï¸ STEP 2: Navigating to Settings
[CONSOLE] log: [SettingsView] checkAuthStatus called with endpoint: https://demo-2.absmartly.com/v1
[CONSOLE] log: [SettingsView] Sending CHECK_AUTH message...
[CONSOLE] log: [SettingsView] CHECK_AUTH response received: {success: false, error: Not authenticated}
[CONSOLE] log: [SettingsView] checkAuthStatus finally block - setting checkingAuth to false
âœ… Settings page loaded

ðŸ”‘ STEP 3: Configuring API Key authentication
  âœ“ Selected API Key authentication method
  âœ“ Filled endpoint
  âœ“ Filled API key
  ðŸ”„ Testing authentication before saving...
[CONSOLE] log: [SettingsView] checkAuthStatus called with endpoint: https://demo-2.absmartly.com/v1
[CONSOLE] log: [SettingsView] Sending CHECK_AUTH message...
  âœ“ Clicked Refresh button
  ðŸ“¸ Debug screenshot saved after refresh
  Debug: auth-user-info visible? [33mfalse[39m
  Debug: auth-not-authenticated visible? [33mfalse[39m
  âœ˜  1 [chromium] â€º tests/e2e/settings-auth.spec.ts:46:7 â€º Settings Authentication Tests â€º should show authenticated user data with API Key authentication (2.5s)


  1) [chromium] â€º tests/e2e/settings-auth.spec.ts:46:7 â€º Settings Authentication Tests â€º should show authenticated user data with API Key authentication â€º Configure API Key authentication and test BEFORE saving 

    Error: [2mexpect([22m[31mreceived[39m[2m).[22mtoBeTruthy[2m()[22m

    Received: [31mfalse[39m

      133 |       console.log('  Debug: auth-not-authenticated visible?', isNotAuthVisible)
      134 |
    > 135 |       expect(hasUserInfoBeforeSave).toBeTruthy()
          |                                     ^
      136 |       console.log('  âœ… Shows authenticated state BEFORE saving!')
      137 |
      138 |       // Now save settings
        at /Users/joalves/git_tree/absmartly-browser-extension/tests/e2e/settings-auth.spec.ts:135:37
        at /Users/joalves/git_tree/absmartly-browser-extension/tests/e2e/settings-auth.spec.ts:84:5

  1 failed
    [chromium] â€º tests/e2e/settings-auth.spec.ts:46:7 â€º Settings Authentication Tests â€º should show authenticated user data with API Key authentication 

To open last HTML report run:
[36m[39m
[36m  npx playwright show-report[39m
[36m[39m


> absmartly-launchpad@0.0.2 test
> npm run test:unit && npm run test:e2e


> absmartly-launchpad@0.0.2 test:unit
> jest

  console.log
    [ABSmartly] Using parent ID with tag path (moderately fast): #unique-header h1

      at getSelector (src/utils/selector-generator-visual.ts:185:19)

  console.log
    [ABSmartly] Using unique ID (fastest): unique-span

      at getSelector (src/utils/selector-generator-visual.ts:108:17)

  console.log
    [ABSmartly] Using parent ID with tag path (moderately fast): #test\:id span

      at getSelector (src/utils/selector-generator-visual.ts:185:19)

  console.log
    [ABSmartly] Simple selectors not unique. Adding specificity...

      at getSelector (src/utils/selector-generator-visual.ts:389:11)

  console.log
    [ABSmartly] WARNING: Using nth-child selectors (poor performance)...

      at getSelector (src/utils/selector-generator-visual.ts:393:11)

  console.log
    [ABSmartly] Using nth-of-type selector (slow but unique): #product-list > div:nth-of-type(1) > div

      at getSelector (src/utils/selector-generator-visual.ts:427:19)

  console.log
    [ABSmartly] Simple selectors not unique. Adding specificity...

      at getSelector (src/utils/selector-generator-visual.ts:389:11)

  console.log
    [ABSmartly] WARNING: Using nth-child selectors (poor performance)...

      at getSelector (src/utils/selector-generator-visual.ts:393:11)

  console.log
    [ABSmartly] Using nth-of-type selector (slow but unique): #product-list > div:nth-of-type(2) > div

      at getSelector (src/utils/selector-generator-visual.ts:427:19)

  console.log
    [ABSmartly] Simple selectors not unique. Adding specificity...

      at getSelector (src/utils/selector-generator-visual.ts:389:11)

  console.log
    [ABSmartly] WARNING: Using nth-child selectors (poor performance)...

      at getSelector (src/utils/selector-generator-visual.ts:393:11)

  console.log
    [ABSmartly] Using nth-of-type selector (slow but unique): #container > div:nth-of-type(1)

      at getSelector (src/utils/selector-generator-visual.ts:427:19)

  console.log
    [ABSmartly] Simple selectors not unique. Adding specificity...

      at getSelector (src/utils/selector-generator-visual.ts:389:11)

  console.log
    [ABSmartly] WARNING: Using nth-child selectors (poor performance)...

      at getSelector (src/utils/selector-generator-visual.ts:393:11)

  console.log
    [ABSmartly] Using nth-of-type selector (slow but unique): #container > div:nth-of-type(2)

      at getSelector (src/utils/selector-generator-visual.ts:427:19)

  console.log
    [ABSmartly] Simple selectors not unique. Adding specificity...

      at getSelector (src/utils/selector-generator-visual.ts:389:11)

  console.log
    [ABSmartly] WARNING: Using nth-child selectors (poor performance)...

      at getSelector (src/utils/selector-generator-visual.ts:393:11)

  console.log
    [ABSmartly] Using nth-of-type selector (slow but unique): #container > div:nth-of-type(3)

      at getSelector (src/utils/selector-generator-visual.ts:427:19)

  console.log
    [ABSmartly] Using parent ID with tag path (moderately fast): #content article > section > p

      at getSelector (src/utils/selector-generator-visual.ts:185:19)

  console.log
    [ABSmartly] Using parent ID with tag path (moderately fast): #parent span

      at getSelector (src/utils/selector-generator-visual.ts:185:19)

  console.log
    [ABSmartly] Using data attribute (slower but stable): [data-testid="submit-button"]

      at getSelector (src/utils/selector-generator-visual.ts:267:17)

  console.log
    [ABSmartly] Using unique ID (fastest): submit-btn

      at getSelector (src/utils/selector-generator-visual.ts:108:17)

  console.log
    [ABSmartly] Using data attribute (slower but stable): [data-test="email-input"]

      at getSelector (src/utils/selector-generator-visual.ts:267:17)

  console.log
    [ABSmartly] Using data attribute (slower but stable): [data-cy="login-button"]

      at getSelector (src/utils/selector-generator-visual.ts:267:17)

  console.log
    [ABSmartly] Using parent ID with tag path (moderately fast): #content span

      at getSelector (src/utils/selector-generator-visual.ts:185:19)

  console.log
    [ABSmartly] Using parent ID with tag path (moderately fast): #parent div > span

      at getSelector (src/utils/selector-generator-visual.ts:185:19)

  console.log
    [ABSmartly] Simple selectors not unique. Adding specificity...

      at getSelector (src/utils/selector-generator-visual.ts:389:11)

  console.log
    [ABSmartly] WARNING: Using nth-child selectors (poor performance)...

      at getSelector (src/utils/selector-generator-visual.ts:393:11)

  console.log
    [ABSmartly] Using nth-of-type selector (slow but unique): #menu > li:nth-of-type(2)

      at getSelector (src/utils/selector-generator-visual.ts:427:19)

  console.log
    [ABSmartly] Simple selectors not unique. Adding specificity...

      at getSelector (src/utils/selector-generator-visual.ts:389:11)
          at Array.map (<anonymous>)

  console.log
    [ABSmartly] WARNING: Using nth-child selectors (poor performance)...

      at getSelector (src/utils/selector-generator-visual.ts:393:11)
          at Array.map (<anonymous>)

  console.log
    [ABSmartly] Using nth-of-type selector (slow but unique): #list > span:nth-of-type(1)

      at getSelector (src/utils/selector-generator-visual.ts:427:19)
          at Array.map (<anonymous>)

  console.error
    Error: Not implemented: navigation (except hash changes)
        at module.exports (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/browser/not-implemented.js:9:17)
        at navigateFetch (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/navigation.js:77:3)
        at exports.navigate (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/navigation.js:55:3)
        at LocationImpl._locationObjectNavigate (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/Location-impl.js:30:5)
        at LocationImpl._locationObjectSetterNavigate (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/Location-impl.js:24:17)
        at LocationImpl.set href [as href] (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/Location-impl.js:46:10)
        at Location.set href [as href] (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/generated/Location.js:125:37)
        at Reflect.set (<anonymous>)
        at Window.set location [as location] (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/browser/Window.js:424:15)
        at Object.<anonymous> (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/src/sdk-bridge/__tests__/experiment/code-injector.test.ts:25:30)
        at Promise.finally.completed (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1557:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1497:10)
        at _callCircusHook (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:976:40)
        at processTicksAndRejections (node:internal/process/task_queues:105:5)
        at _runTest (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:941:5)
        at /Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:849:7
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:862:11)
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:857:11)
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:857:11)
        at run (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:761:3)
        at runAndTransformResultsToJestFormat (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1918:21)
        at jestAdapter (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/runner.js:101:19)
        at runTestInternal (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:275:16)
        at runTest (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:343:7)
        at Object.worker (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:497:12) {
      type: 'not implemented'
    }

      23 |     // Mock window.location
      24 |     delete (window as any).location
    > 25 |     ;(window as any).location = {
         |                              ^
      26 |       href: 'https://example.com/path/to/page?query=value#hash',
      27 |       pathname: '/path/to/page',
      28 |       hostname: 'example.com',

      at VirtualConsole.<anonymous> (node_modules/@jest/environment-jsdom-abstract/build/index.js:87:23)
          at Reflect.set (<anonymous>)
      at Object.<anonymous> (src/sdk-bridge/__tests__/experiment/code-injector.test.ts:25:30)

PASS src/visual-editor/core/__tests__/context-menu.test.ts (6.741 s)
  ContextMenu
    Constructor and Initialization
      ✓ should create ContextMenu instance with StateManager (9 ms)
      ✓ should have default handleAction method that logs action (2 ms)
      ✓ should allow overriding handleAction method (33 ms)
    Menu Items
      ✓ should not include Move up and Move down in menu items (232 ms)
      ✓ should include Change image source for img elements (5 ms)
      ✓ should include Change image source for elements with background-image (114 ms)
      ✓ should not include Change image source for regular elements (7 ms)
      ✓ should include standard menu items (31 ms)
    show() method
      ✓ should create menu host element with correct ID and positioning (67 ms)
      ✓ should remove existing menu before showing new one (19 ms)
      ✓ should create shadow DOM with open mode (15 ms)
      ✓ should position menu correctly within viewport bounds (53 ms)
      ✓ should use absolute positioning when menu is taller than viewport (9 ms)
      ✓ should handle viewport boundaries correctly (64 ms)
    Menu Items Creation
      ✓ should create all menu actions (6 ms)
      ✓ should create menu items with correct structure (48 ms)
      ✓ should include shortcuts for specific actions (23 ms)
    Menu Item Rendering
      ✓ should create menu item HTML element with correct structure (2 ms)
      ✓ should create menu item without shortcut when not provided (1 ms)
    Event Handling and Interactions
      ✓ should handle menu item clicks and call handleAction (3 ms)
      ✓ should remove menu when handleAction is called (44 ms)
      ✓ should stop event propagation for menu clicks (115 ms)
    Click Outside to Close
      ✓ should close menu when clicking outside (13 ms)
      ✓ should handle backdrop click events (3 ms)
    Shadow DOM and Style Injection
      ✓ should inject correct styles for menu positioning (6 ms)
      ✓ should generate styles for absolute positioning (2 ms)
      ✓ should generate styles for fixed positioning (2 ms)
      ✓ should include scrollbar styles for overflow content (3 ms)
      ✓ should include hover styles for menu items (4 ms)
    Menu Positioning Edge Cases
      ✓ should handle negative coordinates (10 ms)
      ✓ should handle coordinates beyond viewport (3 ms)
      ✓ should handle scrolled page positioning (78 ms)
      ✓ should calculate menu dimensions correctly (2 ms)
    Menu Actions Catalog
      ✓ should have all expected edit actions (20 ms)
      ✓ should have all expected movement actions (35 ms)
      ✓ should have all expected clipboard actions (2 ms)
      ✓ should have all expected content actions (2 ms)
      ✓ should have all expected destructive actions (3 ms)
    Menu Item Icons and Labels
      ✓ should have appropriate icons for each action type (11 ms)
      ✓ should have descriptive labels for actions (3 ms)
      ✓ should use appropriate emoji icons (2 ms)
    Error Handling and Edge Cases
      ✓ should handle missing element gracefully (4 ms)
      ✓ should handle multiple rapid show calls (8 ms)
      ✓ should handle extreme viewport dimensions (27 ms)
    Accessibility and Keyboard Support
      ✓ should include user-select: none for menu items (3 ms)
      ✓ should have proper cursor styles for interactive elements (2 ms)
      ✓ should have adequate color contrast (1 ms)
      ✓ should have hover states for better UX (1 ms)
    Performance Considerations
      ✓ should reuse menu calculations efficiently (2 ms)
      ✓ should clean up previous menu before creating new one (62 ms)
    Shadow DOM Event Handlers
      ✓ should handle backdrop click events to close menu (4 ms)
      ✓ should handle menu container click events (6 ms)
      ✓ should handle menu container click without menu item (39 ms)
      ✓ should handle showNotification method (2 ms)
      ✓ should handle menu container click with action but no dataset (3 ms)

  console.log
    [ABSmartly] Simple selectors not unique. Adding specificity...

      at getSelector (src/utils/selector-generator-visual.ts:389:11)
          at Array.map (<anonymous>)

  console.error
    Error: Not implemented: navigation (except hash changes)
        at module.exports (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/browser/not-implemented.js:9:17)
        at navigateFetch (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/navigation.js:77:3)
        at exports.navigate (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/navigation.js:55:3)
        at LocationImpl._locationObjectNavigate (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/Location-impl.js:30:5)
        at LocationImpl._locationObjectSetterNavigate (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/Location-impl.js:24:17)
        at LocationImpl.set href [as href] (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/Location-impl.js:46:10)
        at Location.set href [as href] (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/generated/Location.js:125:37)
        at Reflect.set (<anonymous>)
        at Window.set location [as location] (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/browser/Window.js:424:15)
        at Object.<anonymous> (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/src/sdk-bridge/__tests__/experiment/code-injector.test.ts:25:30)
        at Promise.finally.completed (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1557:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1497:10)
        at _callCircusHook (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:976:40)
        at processTicksAndRejections (node:internal/process/task_queues:105:5)
        at _runTest (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:941:5)
        at /Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:849:7
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:862:11)
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:857:11)
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:857:11)
        at run (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:761:3)
        at runAndTransformResultsToJestFormat (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1918:21)
        at jestAdapter (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/runner.js:101:19)
        at runTestInternal (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:275:16)
        at runTest (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:343:7)
        at Object.worker (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:497:12) {
      type: 'not implemented'
    }

      23 |     // Mock window.location
      24 |     delete (window as any).location
    > 25 |     ;(window as any).location = {
         |                              ^
      26 |       href: 'https://example.com/path/to/page?query=value#hash',
      27 |       pathname: '/path/to/page',
      28 |       hostname: 'example.com',

      at VirtualConsole.<anonymous> (node_modules/@jest/environment-jsdom-abstract/build/index.js:87:23)
          at Reflect.set (<anonymous>)
      at Object.<anonymous> (src/sdk-bridge/__tests__/experiment/code-injector.test.ts:25:30)

  console.error
    Error: Not implemented: navigation (except hash changes)
        at module.exports (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/browser/not-implemented.js:9:17)
        at navigateFetch (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/navigation.js:77:3)
        at exports.navigate (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/navigation.js:55:3)
        at LocationImpl._locationObjectNavigate (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/Location-impl.js:30:5)
        at LocationImpl._locationObjectSetterNavigate (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/Location-impl.js:24:17)
        at LocationImpl.set href [as href] (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/Location-impl.js:46:10)
        at Location.set href [as href] (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/generated/Location.js:125:37)
        at Reflect.set (<anonymous>)
        at Window.set location [as location] (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/browser/Window.js:424:15)
        at Object.<anonymous> (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/src/sdk-bridge/__tests__/experiment/code-injector.test.ts:25:30)
        at Promise.finally.completed (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1557:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1497:10)
        at _callCircusHook (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:976:40)
        at processTicksAndRejections (node:internal/process/task_queues:105:5)
        at _runTest (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:941:5)
        at /Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:849:7
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:862:11)
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:857:11)
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:857:11)
        at run (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:761:3)
        at runAndTransformResultsToJestFormat (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1918:21)
        at jestAdapter (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/runner.js:101:19)
        at runTestInternal (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:275:16)
        at runTest (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:343:7)
        at Object.worker (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:497:12) {
      type: 'not implemented'
    }

      23 |     // Mock window.location
      24 |     delete (window as any).location
    > 25 |     ;(window as any).location = {
         |                              ^
      26 |       href: 'https://example.com/path/to/page?query=value#hash',
      27 |       pathname: '/path/to/page',
      28 |       hostname: 'example.com',

      at VirtualConsole.<anonymous> (node_modules/@jest/environment-jsdom-abstract/build/index.js:87:23)
          at Reflect.set (<anonymous>)
      at Object.<anonymous> (src/sdk-bridge/__tests__/experiment/code-injector.test.ts:25:30)

  console.error
    Error: Not implemented: navigation (except hash changes)
        at module.exports (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/browser/not-implemented.js:9:17)
        at navigateFetch (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/navigation.js:77:3)
        at exports.navigate (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/navigation.js:55:3)
        at LocationImpl._locationObjectNavigate (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/Location-impl.js:30:5)
        at LocationImpl._locationObjectSetterNavigate (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/Location-impl.js:24:17)
        at LocationImpl.set href [as href] (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/Location-impl.js:46:10)
        at Location.set href [as href] (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/generated/Location.js:125:37)
        at Reflect.set (<anonymous>)
        at Window.set location [as location] (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/browser/Window.js:424:15)
        at Object.<anonymous> (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/src/sdk-bridge/__tests__/experiment/code-injector.test.ts:25:30)
        at Promise.finally.completed (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1557:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1497:10)
        at _callCircusHook (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:976:40)
        at processTicksAndRejections (node:internal/process/task_queues:105:5)
        at _runTest (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:941:5)
        at /Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:849:7
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:862:11)
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:857:11)
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:857:11)
        at run (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:761:3)
        at runAndTransformResultsToJestFormat (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1918:21)
        at jestAdapter (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/runner.js:101:19)
        at runTestInternal (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:275:16)
        at runTest (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:343:7)
        at Object.worker (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:497:12) {
      type: 'not implemented'
    }

      23 |     // Mock window.location
      24 |     delete (window as any).location
    > 25 |     ;(window as any).location = {
         |                              ^
      26 |       href: 'https://example.com/path/to/page?query=value#hash',
      27 |       pathname: '/path/to/page',
      28 |       hostname: 'example.com',

      at VirtualConsole.<anonymous> (node_modules/@jest/environment-jsdom-abstract/build/index.js:87:23)
          at Reflect.set (<anonymous>)
      at Object.<anonymous> (src/sdk-bridge/__tests__/experiment/code-injector.test.ts:25:30)

  console.log
    [ABSmartly] WARNING: Using nth-child selectors (poor performance)...

      at getSelector (src/utils/selector-generator-visual.ts:393:11)
          at Array.map (<anonymous>)

  console.log
    [ABSmartly] Using nth-of-type selector (slow but unique): #list > span:nth-of-type(2)

      at getSelector (src/utils/selector-generator-visual.ts:427:19)
          at Array.map (<anonymous>)

  console.error
    Error: Not implemented: navigation (except hash changes)
        at module.exports (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/browser/not-implemented.js:9:17)
        at navigateFetch (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/navigation.js:77:3)
        at exports.navigate (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/navigation.js:55:3)
        at LocationImpl._locationObjectNavigate (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/Location-impl.js:30:5)
        at LocationImpl._locationObjectSetterNavigate (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/Location-impl.js:24:17)
        at LocationImpl.set href [as href] (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/Location-impl.js:46:10)
        at Location.set href [as href] (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/generated/Location.js:125:37)
        at Reflect.set (<anonymous>)
        at Window.set location [as location] (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/browser/Window.js:424:15)
        at Object.<anonymous> (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/src/sdk-bridge/__tests__/experiment/code-injector.test.ts:25:30)
        at Promise.finally.completed (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1557:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1497:10)
        at _callCircusHook (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:976:40)
        at processTicksAndRejections (node:internal/process/task_queues:105:5)
        at _runTest (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:941:5)
        at /Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:849:7
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:862:11)
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:857:11)
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:857:11)
        at run (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:761:3)
        at runAndTransformResultsToJestFormat (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1918:21)
        at jestAdapter (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/runner.js:101:19)
        at runTestInternal (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:275:16)
        at runTest (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:343:7)
        at Object.worker (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:497:12) {
      type: 'not implemented'
    }

      23 |     // Mock window.location
      24 |     delete (window as any).location
    > 25 |     ;(window as any).location = {
         |                              ^
      26 |       href: 'https://example.com/path/to/page?query=value#hash',
      27 |       pathname: '/path/to/page',
      28 |       hostname: 'example.com',

      at VirtualConsole.<anonymous> (node_modules/@jest/environment-jsdom-abstract/build/index.js:87:23)
          at Reflect.set (<anonymous>)
      at Object.<anonymous> (src/sdk-bridge/__tests__/experiment/code-injector.test.ts:25:30)

  console.log
    [ABSmartly] Simple selectors not unique. Adding specificity...

      at getSelector (src/utils/selector-generator-visual.ts:389:11)
          at Array.map (<anonymous>)

  console.error
    Error: Not implemented: navigation (except hash changes)
        at module.exports (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/browser/not-implemented.js:9:17)
        at navigateFetch (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/navigation.js:77:3)
        at exports.navigate (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/navigation.js:55:3)
        at LocationImpl._locationObjectNavigate (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/Location-impl.js:30:5)
        at LocationImpl._locationObjectSetterNavigate (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/Location-impl.js:24:17)
        at LocationImpl.set href [as href] (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/Location-impl.js:46:10)
        at Location.set href [as href] (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/generated/Location.js:125:37)
        at Reflect.set (<anonymous>)
        at Window.set location [as location] (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/browser/Window.js:424:15)
        at Object.<anonymous> (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/src/sdk-bridge/__tests__/experiment/code-injector.test.ts:25:30)
        at Promise.finally.completed (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1557:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1497:10)
        at _callCircusHook (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:976:40)
        at processTicksAndRejections (node:internal/process/task_queues:105:5)
        at _runTest (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:941:5)
        at /Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:849:7
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:862:11)
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:857:11)
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:857:11)
        at run (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:761:3)
        at runAndTransformResultsToJestFormat (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1918:21)
        at jestAdapter (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/runner.js:101:19)
        at runTestInternal (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:275:16)
        at runTest (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:343:7)
        at Object.worker (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:497:12) {
      type: 'not implemented'
    }

      23 |     // Mock window.location
      24 |     delete (window as any).location
    > 25 |     ;(window as any).location = {
         |                              ^
      26 |       href: 'https://example.com/path/to/page?query=value#hash',
      27 |       pathname: '/path/to/page',
      28 |       hostname: 'example.com',

      at VirtualConsole.<anonymous> (node_modules/@jest/environment-jsdom-abstract/build/index.js:87:23)
          at Reflect.set (<anonymous>)
      at Object.<anonymous> (src/sdk-bridge/__tests__/experiment/code-injector.test.ts:25:30)

  console.log
    [ABSmartly] WARNING: Using nth-child selectors (poor performance)...

      at getSelector (src/utils/selector-generator-visual.ts:393:11)
          at Array.map (<anonymous>)

  console.error
    Error: Not implemented: navigation (except hash changes)
        at module.exports (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/browser/not-implemented.js:9:17)
        at navigateFetch (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/navigation.js:77:3)
        at exports.navigate (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/navigation.js:55:3)
        at LocationImpl._locationObjectNavigate (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/Location-impl.js:30:5)
        at LocationImpl._locationObjectSetterNavigate (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/Location-impl.js:24:17)
        at LocationImpl.set href [as href] (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/Location-impl.js:46:10)
        at Location.set href [as href] (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/generated/Location.js:125:37)
        at Reflect.set (<anonymous>)
        at Window.set location [as location] (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/browser/Window.js:424:15)
        at Object.<anonymous> (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/src/sdk-bridge/__tests__/experiment/code-injector.test.ts:25:30)
        at Promise.finally.completed (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1557:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1497:10)
        at _callCircusHook (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:976:40)
        at processTicksAndRejections (node:internal/process/task_queues:105:5)
        at _runTest (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:941:5)
        at /Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:849:7
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:862:11)
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:857:11)
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:857:11)
        at run (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:761:3)
        at runAndTransformResultsToJestFormat (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1918:21)
        at jestAdapter (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/runner.js:101:19)
        at runTestInternal (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:275:16)
        at runTest (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:343:7)
        at Object.worker (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:497:12) {
      type: 'not implemented'
    }

      23 |     // Mock window.location
      24 |     delete (window as any).location
    > 25 |     ;(window as any).location = {
         |                              ^
      26 |       href: 'https://example.com/path/to/page?query=value#hash',
      27 |       pathname: '/path/to/page',
      28 |       hostname: 'example.com',

      at VirtualConsole.<anonymous> (node_modules/@jest/environment-jsdom-abstract/build/index.js:87:23)
          at Reflect.set (<anonymous>)
      at Object.<anonymous> (src/sdk-bridge/__tests__/experiment/code-injector.test.ts:25:30)

  console.error
    Error: Not implemented: navigation (except hash changes)
        at module.exports (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/browser/not-implemented.js:9:17)
        at navigateFetch (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/navigation.js:77:3)
        at exports.navigate (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/navigation.js:55:3)
        at LocationImpl._locationObjectNavigate (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/Location-impl.js:30:5)
        at LocationImpl._locationObjectSetterNavigate (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/Location-impl.js:24:17)
        at LocationImpl.set href [as href] (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/Location-impl.js:46:10)
        at Location.set href [as href] (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/generated/Location.js:125:37)
        at Reflect.set (<anonymous>)
        at Window.set location [as location] (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/browser/Window.js:424:15)
        at Object.<anonymous> (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/src/sdk-bridge/__tests__/experiment/code-injector.test.ts:25:30)
        at Promise.finally.completed (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1557:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1497:10)
        at _callCircusHook (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:976:40)
        at processTicksAndRejections (node:internal/process/task_queues:105:5)
        at _runTest (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:941:5)
        at /Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:849:7
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:862:11)
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:857:11)
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:857:11)
        at run (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:761:3)
        at runAndTransformResultsToJestFormat (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1918:21)
        at jestAdapter (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/runner.js:101:19)
        at runTestInternal (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:275:16)
        at runTest (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:343:7)
        at Object.worker (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:497:12) {
      type: 'not implemented'
    }

      23 |     // Mock window.location
      24 |     delete (window as any).location
    > 25 |     ;(window as any).location = {
         |                              ^
      26 |       href: 'https://example.com/path/to/page?query=value#hash',
      27 |       pathname: '/path/to/page',
      28 |       hostname: 'example.com',

      at VirtualConsole.<anonymous> (node_modules/@jest/environment-jsdom-abstract/build/index.js:87:23)
          at Reflect.set (<anonymous>)
      at Object.<anonymous> (src/sdk-bridge/__tests__/experiment/code-injector.test.ts:25:30)

  console.log
    [ABSmartly] Using nth-of-type selector (slow but unique): #list > span:nth-of-type(3)

      at getSelector (src/utils/selector-generator-visual.ts:427:19)
          at Array.map (<anonymous>)

  console.log
    [ABSmartly] Simple selectors not unique. Adding specificity...

      at getSelector (src/utils/selector-generator-visual.ts:389:11)

  console.log
    [ABSmartly] WARNING: Using nth-child selectors (poor performance)...

      at getSelector (src/utils/selector-generator-visual.ts:393:11)

  console.log
    [ABSmartly] Using nth-of-type selector (slow but unique): #search-results > div:nth-of-type(1) > div:nth-of-type(1)

      at getSelector (src/utils/selector-generator-visual.ts:427:19)

  console.log
    [ABSmartly] Simple selectors not unique. Adding specificity...

      at getSelector (src/utils/selector-generator-visual.ts:389:11)
          at Array.map (<anonymous>)

  console.log
    [ABSmartly] WARNING: Using nth-child selectors (poor performance)...

      at getSelector (src/utils/selector-generator-visual.ts:393:11)
          at Array.map (<anonymous>)

  console.log
    [ABSmartly] Using nth-of-type selector (slow but unique): #bhp-ab-gateway-desktop-atf-6 > div > div > div > ul > li:nth-of-type(1) > a > div > span

      at getSelector (src/utils/selector-generator-visual.ts:427:19)
          at Array.map (<anonymous>)

  console.log
    [ABSmartly] Simple selectors not unique. Adding specificity...

      at getSelector (src/utils/selector-generator-visual.ts:389:11)
          at Array.map (<anonymous>)

  console.log
    [ABSmartly] WARNING: Using nth-child selectors (poor performance)...

      at getSelector (src/utils/selector-generator-visual.ts:393:11)
          at Array.map (<anonymous>)

  console.error
    Error: Not implemented: navigation (except hash changes)
        at module.exports (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/browser/not-implemented.js:9:17)
        at navigateFetch (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/navigation.js:77:3)
        at exports.navigate (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/navigation.js:55:3)
        at LocationImpl._locationObjectNavigate (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/Location-impl.js:30:5)
        at LocationImpl._locationObjectSetterNavigate (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/Location-impl.js:24:17)
        at LocationImpl.set href [as href] (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/Location-impl.js:46:10)
        at Location.set href [as href] (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/generated/Location.js:125:37)
        at Reflect.set (<anonymous>)
        at Window.set location [as location] (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/browser/Window.js:424:15)
        at Object.<anonymous> (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/src/sdk-bridge/__tests__/experiment/code-injector.test.ts:25:30)
        at Promise.finally.completed (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1557:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1497:10)
        at _callCircusHook (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:976:40)
        at processTicksAndRejections (node:internal/process/task_queues:105:5)
        at _runTest (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:941:5)
        at /Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:849:7
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:862:11)
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:857:11)
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:857:11)
        at run (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:761:3)
        at runAndTransformResultsToJestFormat (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1918:21)
        at jestAdapter (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/runner.js:101:19)
        at runTestInternal (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:275:16)
        at runTest (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:343:7)
        at Object.worker (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:497:12) {
      type: 'not implemented'
    }

      23 |     // Mock window.location
      24 |     delete (window as any).location
    > 25 |     ;(window as any).location = {
         |                              ^
      26 |       href: 'https://example.com/path/to/page?query=value#hash',
      27 |       pathname: '/path/to/page',
      28 |       hostname: 'example.com',

      at VirtualConsole.<anonymous> (node_modules/@jest/environment-jsdom-abstract/build/index.js:87:23)
          at Reflect.set (<anonymous>)
      at Object.<anonymous> (src/sdk-bridge/__tests__/experiment/code-injector.test.ts:25:30)

  console.log
    [ABSmartly] Using nth-of-type selector (slow but unique): #bhp-ab-gateway-desktop-atf-6 > div > div > div > ul > li:nth-of-type(2) > a > div > span

      at getSelector (src/utils/selector-generator-visual.ts:427:19)
          at Array.map (<anonymous>)

  console.error
    Error: Not implemented: navigation (except hash changes)
        at module.exports (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/browser/not-implemented.js:9:17)
        at navigateFetch (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/navigation.js:77:3)
        at exports.navigate (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/navigation.js:55:3)
        at LocationImpl._locationObjectNavigate (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/Location-impl.js:30:5)
        at LocationImpl._locationObjectSetterNavigate (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/Location-impl.js:24:17)
        at LocationImpl.set href [as href] (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/Location-impl.js:46:10)
        at Location.set href [as href] (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/generated/Location.js:125:37)
        at Reflect.set (<anonymous>)
        at Window.set location [as location] (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/browser/Window.js:424:15)
        at Object.<anonymous> (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/src/sdk-bridge/__tests__/experiment/code-injector.test.ts:25:30)
        at Promise.finally.completed (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1557:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1497:10)
        at _callCircusHook (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:976:40)
        at processTicksAndRejections (node:internal/process/task_queues:105:5)
        at _runTest (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:941:5)
        at /Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:849:7
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:862:11)
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:857:11)
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:857:11)
        at run (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:761:3)
        at runAndTransformResultsToJestFormat (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1918:21)
        at jestAdapter (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/runner.js:101:19)
        at runTestInternal (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:275:16)
        at runTest (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:343:7)
        at Object.worker (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:497:12) {
      type: 'not implemented'
    }

      23 |     // Mock window.location
      24 |     delete (window as any).location
    > 25 |     ;(window as any).location = {
         |                              ^
      26 |       href: 'https://example.com/path/to/page?query=value#hash',
      27 |       pathname: '/path/to/page',
      28 |       hostname: 'example.com',

      at VirtualConsole.<anonymous> (node_modules/@jest/environment-jsdom-abstract/build/index.js:87:23)
          at Reflect.set (<anonymous>)
      at Object.<anonymous> (src/sdk-bridge/__tests__/experiment/code-injector.test.ts:25:30)

  console.log
    [ABSmartly] Single tag selector too brittle, continuing search: span

      at getSelector (src/utils/selector-generator-visual.ts:357:17)

FAIL src/sdk-bridge/__tests__/experiment/override-manager.test.ts (6.858 s)
  OverrideManager
    parseCookieOverrides
      ✕ should return empty overrides for empty string (1 ms)
      ✕ should parse simple format (variant only) (2 ms)
      ✕ should parse format with env (variant.env)
      ✕ should parse full format (variant.env.id)
      ✕ should parse devEnv prefix
      ✕ should decode URL-encoded devEnv
      ✕ should decode URL-encoded experiment names
      ✕ should handle mixed format overrides
      ✕ should skip invalid entries with no name
      ✕ should skip invalid entries with no values
      ✕ should skip invalid entries with no colon
      ✕ should handle devEnv without experiments
      ✕ should handle empty devEnv
      ✕ should handle malformed cookie gracefully (1 ms)
      ✕ should log warning for parsing errors
      ✕ should handle single experiment
      ✕ should parse variant numbers correctly
    checkOverridesCookie
      ✕ should log when cookie is found (1 ms)
      ✕ should log when cookie is not found
      ✕ should log devEnv when present
      ✕ should decode devEnv URL encoding
      ✕ should handle errors gracefully
    getCookieValue
      ✕ should return cookie value when cookie exists
      ✕ should return null when cookie does not exist
      ✕ should handle multiple cookies
      ✕ should handle errors gracefully
    getOverrides
      ✕ should return parsed overrides when cookie exists
      ✕ should return empty overrides when cookie does not exist
      ✕ should return parsed overrides with devEnv (1 ms)
    custom cookie name
      ✕ should use custom cookie name
      ✕ should check custom cookie name
    edge cases
      ✕ should handle very long experiment names
      ✕ should handle many experiments
      ✕ should handle special characters in experiment names
      ✕ should handle whitespace in cookie value
      ✕ should handle variant value of 0
      ✕ should handle large variant numbers

  ● OverrideManager › parseCookieOverrides › should return empty overrides for empty string

    TypeError: Cannot redefine property: cookie
        at Function.defineProperty (<anonymous>)

      16 |     // Mock document.cookie for JSDOM once
      17 |     mockCookies = {}
    > 18 |     Object.defineProperty(document, 'cookie', {
         |            ^
      19 |       get: () => {
      20 |         return Object.entries(mockCookies)
      21 |           .map(([name, value]) => `${name}=${value}`)

      at Object.<anonymous> (src/sdk-bridge/__tests__/experiment/override-manager.test.ts:18:12)

  ● OverrideManager › parseCookieOverrides › should parse simple format (variant only)

    TypeError: Cannot redefine property: cookie
        at Function.defineProperty (<anonymous>)

      16 |     // Mock document.cookie for JSDOM once
      17 |     mockCookies = {}
    > 18 |     Object.defineProperty(document, 'cookie', {
         |            ^
      19 |       get: () => {
      20 |         return Object.entries(mockCookies)
      21 |           .map(([name, value]) => `${name}=${value}`)

      at Object.<anonymous> (src/sdk-bridge/__tests__/experiment/override-manager.test.ts:18:12)

  ● OverrideManager › parseCookieOverrides › should parse format with env (variant.env)

    TypeError: Cannot redefine property: cookie
        at Function.defineProperty (<anonymous>)

      16 |     // Mock document.cookie for JSDOM once
      17 |     mockCookies = {}
    > 18 |     Object.defineProperty(document, 'cookie', {
         |            ^
      19 |       get: () => {
      20 |         return Object.entries(mockCookies)
      21 |           .map(([name, value]) => `${name}=${value}`)

      at Object.<anonymous> (src/sdk-bridge/__tests__/experiment/override-manager.test.ts:18:12)

  ● OverrideManager › parseCookieOverrides › should parse full format (variant.env.id)

    TypeError: Cannot redefine property: cookie
        at Function.defineProperty (<anonymous>)

      16 |     // Mock document.cookie for JSDOM once
      17 |     mockCookies = {}
    > 18 |     Object.defineProperty(document, 'cookie', {
         |            ^
      19 |       get: () => {
      20 |         return Object.entries(mockCookies)
      21 |           .map(([name, value]) => `${name}=${value}`)

      at Object.<anonymous> (src/sdk-bridge/__tests__/experiment/override-manager.test.ts:18:12)

  ● OverrideManager › parseCookieOverrides › should parse devEnv prefix

    TypeError: Cannot redefine property: cookie
        at Function.defineProperty (<anonymous>)

      16 |     // Mock document.cookie for JSDOM once
      17 |     mockCookies = {}
    > 18 |     Object.defineProperty(document, 'cookie', {
         |            ^
      19 |       get: () => {
      20 |         return Object.entries(mockCookies)
      21 |           .map(([name, value]) => `${name}=${value}`)

      at Object.<anonymous> (src/sdk-bridge/__tests__/experiment/override-manager.test.ts:18:12)

  ● OverrideManager › parseCookieOverrides › should decode URL-encoded devEnv

    TypeError: Cannot redefine property: cookie
        at Function.defineProperty (<anonymous>)

      16 |     // Mock document.cookie for JSDOM once
      17 |     mockCookies = {}
    > 18 |     Object.defineProperty(document, 'cookie', {
         |            ^
      19 |       get: () => {
      20 |         return Object.entries(mockCookies)
      21 |           .map(([name, value]) => `${name}=${value}`)

      at Object.<anonymous> (src/sdk-bridge/__tests__/experiment/override-manager.test.ts:18:12)

  ● OverrideManager › parseCookieOverrides › should decode URL-encoded experiment names

    TypeError: Cannot redefine property: cookie
        at Function.defineProperty (<anonymous>)

      16 |     // Mock document.cookie for JSDOM once
      17 |     mockCookies = {}
    > 18 |     Object.defineProperty(document, 'cookie', {
         |            ^
      19 |       get: () => {
      20 |         return Object.entries(mockCookies)
      21 |           .map(([name, value]) => `${name}=${value}`)

      at Object.<anonymous> (src/sdk-bridge/__tests__/experiment/override-manager.test.ts:18:12)

  ● OverrideManager › parseCookieOverrides › should handle mixed format overrides

    TypeError: Cannot redefine property: cookie
        at Function.defineProperty (<anonymous>)

      16 |     // Mock document.cookie for JSDOM once
      17 |     mockCookies = {}
    > 18 |     Object.defineProperty(document, 'cookie', {
         |            ^
      19 |       get: () => {
      20 |         return Object.entries(mockCookies)
      21 |           .map(([name, value]) => `${name}=${value}`)

      at Object.<anonymous> (src/sdk-bridge/__tests__/experiment/override-manager.test.ts:18:12)

  ● OverrideManager › parseCookieOverrides › should skip invalid entries with no name

    TypeError: Cannot redefine property: cookie
        at Function.defineProperty (<anonymous>)

      16 |     // Mock document.cookie for JSDOM once
      17 |     mockCookies = {}
    > 18 |     Object.defineProperty(document, 'cookie', {
         |            ^
      19 |       get: () => {
      20 |         return Object.entries(mockCookies)
      21 |           .map(([name, value]) => `${name}=${value}`)

      at Object.<anonymous> (src/sdk-bridge/__tests__/experiment/override-manager.test.ts:18:12)

  ● OverrideManager › parseCookieOverrides › should skip invalid entries with no values

    TypeError: Cannot redefine property: cookie
        at Function.defineProperty (<anonymous>)

      16 |     // Mock document.cookie for JSDOM once
      17 |     mockCookies = {}
    > 18 |     Object.defineProperty(document, 'cookie', {
         |            ^
      19 |       get: () => {
      20 |         return Object.entries(mockCookies)
      21 |           .map(([name, value]) => `${name}=${value}`)

      at Object.<anonymous> (src/sdk-bridge/__tests__/experiment/override-manager.test.ts:18:12)

  ● OverrideManager › parseCookieOverrides › should skip invalid entries with no colon

    TypeError: Cannot redefine property: cookie
        at Function.defineProperty (<anonymous>)

      16 |     // Mock document.cookie for JSDOM once
      17 |     mockCookies = {}
    > 18 |     Object.defineProperty(document, 'cookie', {
         |            ^
      19 |       get: () => {
      20 |         return Object.entries(mockCookies)
      21 |           .map(([name, value]) => `${name}=${value}`)

      at Object.<anonymous> (src/sdk-bridge/__tests__/experiment/override-manager.test.ts:18:12)

  ● OverrideManager › parseCookieOverrides › should handle devEnv without experiments

    TypeError: Cannot redefine property: cookie
        at Function.defineProperty (<anonymous>)

      16 |     // Mock document.cookie for JSDOM once
      17 |     mockCookies = {}
    > 18 |     Object.defineProperty(document, 'cookie', {
         |            ^
      19 |       get: () => {
      20 |         return Object.entries(mockCookies)
      21 |           .map(([name, value]) => `${name}=${value}`)

      at Object.<anonymous> (src/sdk-bridge/__tests__/experiment/override-manager.test.ts:18:12)

  ● OverrideManager › parseCookieOverrides › should handle empty devEnv

    TypeError: Cannot redefine property: cookie
        at Function.defineProperty (<anonymous>)

      16 |     // Mock document.cookie for JSDOM once
      17 |     mockCookies = {}
    > 18 |     Object.defineProperty(document, 'cookie', {
         |            ^
      19 |       get: () => {
      20 |         return Object.entries(mockCookies)
      21 |           .map(([name, value]) => `${name}=${value}`)

      at Object.<anonymous> (src/sdk-bridge/__tests__/experiment/override-manager.test.ts:18:12)

  ● OverrideManager › parseCookieOverrides › should handle malformed cookie gracefully

    TypeError: Cannot redefine property: cookie
        at Function.defineProperty (<anonymous>)

      16 |     // Mock document.cookie for JSDOM once
      17 |     mockCookies = {}
    > 18 |     Object.defineProperty(document, 'cookie', {
         |            ^
      19 |       get: () => {
      20 |         return Object.entries(mockCookies)
      21 |           .map(([name, value]) => `${name}=${value}`)

      at Object.<anonymous> (src/sdk-bridge/__tests__/experiment/override-manager.test.ts:18:12)

  ● OverrideManager › parseCookieOverrides › should log warning for parsing errors

    TypeError: Cannot redefine property: cookie
        at Function.defineProperty (<anonymous>)

      16 |     // Mock document.cookie for JSDOM once
      17 |     mockCookies = {}
    > 18 |     Object.defineProperty(document, 'cookie', {
         |            ^
      19 |       get: () => {
      20 |         return Object.entries(mockCookies)
      21 |           .map(([name, value]) => `${name}=${value}`)

      at Object.<anonymous> (src/sdk-bridge/__tests__/experiment/override-manager.test.ts:18:12)

  ● OverrideManager › parseCookieOverrides › should handle single experiment

    TypeError: Cannot redefine property: cookie
        at Function.defineProperty (<anonymous>)

      16 |     // Mock document.cookie for JSDOM once
      17 |     mockCookies = {}
    > 18 |     Object.defineProperty(document, 'cookie', {
         |            ^
      19 |       get: () => {
      20 |         return Object.entries(mockCookies)
      21 |           .map(([name, value]) => `${name}=${value}`)

      at Object.<anonymous> (src/sdk-bridge/__tests__/experiment/override-manager.test.ts:18:12)

  ● OverrideManager › parseCookieOverrides › should parse variant numbers correctly

    TypeError: Cannot redefine property: cookie
        at Function.defineProperty (<anonymous>)

      16 |     // Mock document.cookie for JSDOM once
      17 |     mockCookies = {}
    > 18 |     Object.defineProperty(document, 'cookie', {
         |            ^
      19 |       get: () => {
      20 |         return Object.entries(mockCookies)
      21 |           .map(([name, value]) => `${name}=${value}`)

      at Object.<anonymous> (src/sdk-bridge/__tests__/experiment/override-manager.test.ts:18:12)

  ● OverrideManager › checkOverridesCookie › should log when cookie is found

    TypeError: Cannot redefine property: cookie
        at Function.defineProperty (<anonymous>)

      16 |     // Mock document.cookie for JSDOM once
      17 |     mockCookies = {}
    > 18 |     Object.defineProperty(document, 'cookie', {
         |            ^
      19 |       get: () => {
      20 |         return Object.entries(mockCookies)
      21 |           .map(([name, value]) => `${name}=${value}`)

      at Object.<anonymous> (src/sdk-bridge/__tests__/experiment/override-manager.test.ts:18:12)

  ● OverrideManager › checkOverridesCookie › should log when cookie is not found

    TypeError: Cannot redefine property: cookie
        at Function.defineProperty (<anonymous>)

      16 |     // Mock document.cookie for JSDOM once
      17 |     mockCookies = {}
    > 18 |     Object.defineProperty(document, 'cookie', {
         |            ^
      19 |       get: () => {
      20 |         return Object.entries(mockCookies)
      21 |           .map(([name, value]) => `${name}=${value}`)

      at Object.<anonymous> (src/sdk-bridge/__tests__/experiment/override-manager.test.ts:18:12)

  ● OverrideManager › checkOverridesCookie › should log devEnv when present

    TypeError: Cannot redefine property: cookie
        at Function.defineProperty (<anonymous>)

      16 |     // Mock document.cookie for JSDOM once
      17 |     mockCookies = {}
    > 18 |     Object.defineProperty(document, 'cookie', {
         |            ^
      19 |       get: () => {
      20 |         return Object.entries(mockCookies)
      21 |           .map(([name, value]) => `${name}=${value}`)

      at Object.<anonymous> (src/sdk-bridge/__tests__/experiment/override-manager.test.ts:18:12)

  ● OverrideManager › checkOverridesCookie › should decode devEnv URL encoding

    TypeError: Cannot redefine property: cookie
        at Function.defineProperty (<anonymous>)

      16 |     // Mock document.cookie for JSDOM once
      17 |     mockCookies = {}
    > 18 |     Object.defineProperty(document, 'cookie', {
         |            ^
      19 |       get: () => {
      20 |         return Object.entries(mockCookies)
      21 |           .map(([name, value]) => `${name}=${value}`)

      at Object.<anonymous> (src/sdk-bridge/__tests__/experiment/override-manager.test.ts:18:12)

  ● OverrideManager › checkOverridesCookie › should handle errors gracefully

    TypeError: Cannot redefine property: cookie
        at Function.defineProperty (<anonymous>)

      16 |     // Mock document.cookie for JSDOM once
      17 |     mockCookies = {}
    > 18 |     Object.defineProperty(document, 'cookie', {
         |            ^
      19 |       get: () => {
      20 |         return Object.entries(mockCookies)
      21 |           .map(([name, value]) => `${name}=${value}`)

      at Object.<anonymous> (src/sdk-bridge/__tests__/experiment/override-manager.test.ts:18:12)

  ● OverrideManager › getCookieValue › should return cookie value when cookie exists

    TypeError: Cannot redefine property: cookie
        at Function.defineProperty (<anonymous>)

      16 |     // Mock document.cookie for JSDOM once
      17 |     mockCookies = {}
    > 18 |     Object.defineProperty(document, 'cookie', {
         |            ^
      19 |       get: () => {
      20 |         return Object.entries(mockCookies)
      21 |           .map(([name, value]) => `${name}=${value}`)

      at Object.<anonymous> (src/sdk-bridge/__tests__/experiment/override-manager.test.ts:18:12)

  ● OverrideManager › getCookieValue › should return null when cookie does not exist

    TypeError: Cannot redefine property: cookie
        at Function.defineProperty (<anonymous>)

      16 |     // Mock document.cookie for JSDOM once
      17 |     mockCookies = {}
    > 18 |     Object.defineProperty(document, 'cookie', {
         |            ^
      19 |       get: () => {
      20 |         return Object.entries(mockCookies)
      21 |           .map(([name, value]) => `${name}=${value}`)

      at Object.<anonymous> (src/sdk-bridge/__tests__/experiment/override-manager.test.ts:18:12)

  ● OverrideManager › getCookieValue › should handle multiple cookies

    TypeError: Cannot redefine property: cookie
        at Function.defineProperty (<anonymous>)

      16 |     // Mock document.cookie for JSDOM once
      17 |     mockCookies = {}
    > 18 |     Object.defineProperty(document, 'cookie', {
         |            ^
      19 |       get: () => {
      20 |         return Object.entries(mockCookies)
      21 |           .map(([name, value]) => `${name}=${value}`)

      at Object.<anonymous> (src/sdk-bridge/__tests__/experiment/override-manager.test.ts:18:12)

  ● OverrideManager › getCookieValue › should handle errors gracefully

    TypeError: Cannot redefine property: cookie
        at Function.defineProperty (<anonymous>)

      16 |     // Mock document.cookie for JSDOM once
      17 |     mockCookies = {}
    > 18 |     Object.defineProperty(document, 'cookie', {
         |            ^
      19 |       get: () => {
      20 |         return Object.entries(mockCookies)
      21 |           .map(([name, value]) => `${name}=${value}`)

      at Object.<anonymous> (src/sdk-bridge/__tests__/experiment/override-manager.test.ts:18:12)

  ● OverrideManager › getOverrides › should return parsed overrides when cookie exists

    TypeError: Cannot redefine property: cookie
        at Function.defineProperty (<anonymous>)

      16 |     // Mock document.cookie for JSDOM once
      17 |     mockCookies = {}
    > 18 |     Object.defineProperty(document, 'cookie', {
         |            ^
      19 |       get: () => {
      20 |         return Object.entries(mockCookies)
      21 |           .map(([name, value]) => `${name}=${value}`)

      at Object.<anonymous> (src/sdk-bridge/__tests__/experiment/override-manager.test.ts:18:12)

  ● OverrideManager › getOverrides › should return empty overrides when cookie does not exist

    TypeError: Cannot redefine property: cookie
        at Function.defineProperty (<anonymous>)

      16 |     // Mock document.cookie for JSDOM once
      17 |     mockCookies = {}
    > 18 |     Object.defineProperty(document, 'cookie', {
         |            ^
      19 |       get: () => {
      20 |         return Object.entries(mockCookies)
      21 |           .map(([name, value]) => `${name}=${value}`)

      at Object.<anonymous> (src/sdk-bridge/__tests__/experiment/override-manager.test.ts:18:12)

  ● OverrideManager › getOverrides › should return parsed overrides with devEnv

    TypeError: Cannot redefine property: cookie
        at Function.defineProperty (<anonymous>)

      16 |     // Mock document.cookie for JSDOM once
      17 |     mockCookies = {}
    > 18 |     Object.defineProperty(document, 'cookie', {
         |            ^
      19 |       get: () => {
      20 |         return Object.entries(mockCookies)
      21 |           .map(([name, value]) => `${name}=${value}`)

      at Object.<anonymous> (src/sdk-bridge/__tests__/experiment/override-manager.test.ts:18:12)

  ● OverrideManager › custom cookie name › should use custom cookie name

    TypeError: Cannot redefine property: cookie
        at Function.defineProperty (<anonymous>)

      16 |     // Mock document.cookie for JSDOM once
      17 |     mockCookies = {}
    > 18 |     Object.defineProperty(document, 'cookie', {
         |            ^
      19 |       get: () => {
      20 |         return Object.entries(mockCookies)
      21 |           .map(([name, value]) => `${name}=${value}`)

      at Object.<anonymous> (src/sdk-bridge/__tests__/experiment/override-manager.test.ts:18:12)

  ● OverrideManager › custom cookie name › should check custom cookie name

    TypeError: Cannot redefine property: cookie
        at Function.defineProperty (<anonymous>)

      16 |     // Mock document.cookie for JSDOM once
      17 |     mockCookies = {}
    > 18 |     Object.defineProperty(document, 'cookie', {
         |            ^
      19 |       get: () => {
      20 |         return Object.entries(mockCookies)
      21 |           .map(([name, value]) => `${name}=${value}`)

      at Object.<anonymous> (src/sdk-bridge/__tests__/experiment/override-manager.test.ts:18:12)

  ● OverrideManager › edge cases › should handle very long experiment names

    TypeError: Cannot redefine property: cookie
        at Function.defineProperty (<anonymous>)

      16 |     // Mock document.cookie for JSDOM once
      17 |     mockCookies = {}
    > 18 |     Object.defineProperty(document, 'cookie', {
         |            ^
      19 |       get: () => {
      20 |         return Object.entries(mockCookies)
      21 |           .map(([name, value]) => `${name}=${value}`)

      at Object.<anonymous> (src/sdk-bridge/__tests__/experiment/override-manager.test.ts:18:12)

  ● OverrideManager › edge cases › should handle many experiments

    TypeError: Cannot redefine property: cookie
        at Function.defineProperty (<anonymous>)

      16 |     // Mock document.cookie for JSDOM once
      17 |     mockCookies = {}
    > 18 |     Object.defineProperty(document, 'cookie', {
         |            ^
      19 |       get: () => {
      20 |         return Object.entries(mockCookies)
      21 |           .map(([name, value]) => `${name}=${value}`)

      at Object.<anonymous> (src/sdk-bridge/__tests__/experiment/override-manager.test.ts:18:12)

  ● OverrideManager › edge cases › should handle special characters in experiment names

    TypeError: Cannot redefine property: cookie
        at Function.defineProperty (<anonymous>)

      16 |     // Mock document.cookie for JSDOM once
      17 |     mockCookies = {}
    > 18 |     Object.defineProperty(document, 'cookie', {
         |            ^
      19 |       get: () => {
      20 |         return Object.entries(mockCookies)
      21 |           .map(([name, value]) => `${name}=${value}`)

      at Object.<anonymous> (src/sdk-bridge/__tests__/experiment/override-manager.test.ts:18:12)

  ● OverrideManager › edge cases › should handle whitespace in cookie value

    TypeError: Cannot redefine property: cookie
        at Function.defineProperty (<anonymous>)

      16 |     // Mock document.cookie for JSDOM once
      17 |     mockCookies = {}
    > 18 |     Object.defineProperty(document, 'cookie', {
         |            ^
      19 |       get: () => {
      20 |         return Object.entries(mockCookies)
      21 |           .map(([name, value]) => `${name}=${value}`)

      at Object.<anonymous> (src/sdk-bridge/__tests__/experiment/override-manager.test.ts:18:12)

  ● OverrideManager › edge cases › should handle variant value of 0

    TypeError: Cannot redefine property: cookie
        at Function.defineProperty (<anonymous>)

      16 |     // Mock document.cookie for JSDOM once
      17 |     mockCookies = {}
    > 18 |     Object.defineProperty(document, 'cookie', {
         |            ^
      19 |       get: () => {
      20 |         return Object.entries(mockCookies)
      21 |           .map(([name, value]) => `${name}=${value}`)

      at Object.<anonymous> (src/sdk-bridge/__tests__/experiment/override-manager.test.ts:18:12)

  ● OverrideManager › edge cases › should handle large variant numbers

    TypeError: Cannot redefine property: cookie
        at Function.defineProperty (<anonymous>)

      16 |     // Mock document.cookie for JSDOM once
      17 |     mockCookies = {}
    > 18 |     Object.defineProperty(document, 'cookie', {
         |            ^
      19 |       get: () => {
      20 |         return Object.entries(mockCookies)
      21 |           .map(([name, value]) => `${name}=${value}`)

      at Object.<anonymous> (src/sdk-bridge/__tests__/experiment/override-manager.test.ts:18:12)

PASS src/sdk-bridge/__tests__/dom/element-state.test.ts (6.919 s)
  ElementStateManager
    captureElementState
      ✓ should capture text content (9 ms)
      ✓ should capture innerHTML (4 ms)
      ✓ should capture all attributes (2 ms)
      ✓ should capture inline styles (12 ms)
      ✓ should capture class list
      ✓ should handle empty text content
      ✓ should handle elements with no attributes
      ✓ should handle elements with no inline styles (1 ms)
      ✓ should handle elements with no classes (162 ms)
      ✓ should capture complete element state (30 ms)
    restoreElementState
      ✓ should restore text content via innerHTML (10 ms)
      ✓ should restore innerHTML with sanitization (4 ms)
      ✓ should sanitize dangerous HTML during restoration (5 ms)
      ✓ should restore attributes (2 ms)
      ✓ should remove attributes not in original state (2 ms)
      ✓ should restore inline styles (2 ms)
      ✓ should clear all inline styles before restoring (1 ms)
      ✓ should restore class list (2 ms)
      ✓ should remove tracking attributes
      ✓ should log restoration (6 ms)
      ✓ should handle restoration errors gracefully
      ✓ should restore complete element state (20 ms)
      ✓ should handle empty original state (1 ms)
    capture and restore cycle
      ✓ should fully restore element after capture (3 ms)
      ✓ should handle multiple capture/restore cycles (4 ms)

  console.log
    [ABSmartly] Simple selectors not unique. Adding specificity...

      at getSelector (src/utils/selector-generator-visual.ts:389:11)

  console.log
    [ABSmartly] WARNING: Using nth-child selectors (poor performance)...

      at getSelector (src/utils/selector-generator-visual.ts:393:11)

  console.log
    [ABSmartly] Using fallback with nth-child

      at getSelector (src/utils/selector-generator-visual.ts:437:11)

  console.log
    [ABSmartly] Found minimal fallback selector: span

      at getSelector (src/utils/selector-generator-visual.ts:500:15)

  console.error
    Error: Not implemented: navigation (except hash changes)
        at module.exports (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/browser/not-implemented.js:9:17)
        at navigateFetch (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/navigation.js:77:3)
        at exports.navigate (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/navigation.js:55:3)
        at LocationImpl._locationObjectNavigate (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/Location-impl.js:30:5)
        at LocationImpl._locationObjectSetterNavigate (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/Location-impl.js:24:17)
        at LocationImpl.set href [as href] (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/Location-impl.js:46:10)
        at Location.set href [as href] (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/generated/Location.js:125:37)
        at Reflect.set (<anonymous>)
        at Window.set location [as location] (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/browser/Window.js:424:15)
        at Object.<anonymous> (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/src/sdk-bridge/__tests__/experiment/code-injector.test.ts:25:30)
        at Promise.finally.completed (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1557:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1497:10)
        at _callCircusHook (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:976:40)
        at processTicksAndRejections (node:internal/process/task_queues:105:5)
        at _runTest (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:941:5)
        at /Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:849:7
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:862:11)
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:857:11)
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:857:11)
        at run (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:761:3)
        at runAndTransformResultsToJestFormat (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1918:21)
        at jestAdapter (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/runner.js:101:19)
        at runTestInternal (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:275:16)
        at runTest (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:343:7)
        at Object.worker (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:497:12) {
      type: 'not implemented'
    }

      23 |     // Mock window.location
      24 |     delete (window as any).location
    > 25 |     ;(window as any).location = {
         |                              ^
      26 |       href: 'https://example.com/path/to/page?query=value#hash',
      27 |       pathname: '/path/to/page',
      28 |       hostname: 'example.com',

      at VirtualConsole.<anonymous> (node_modules/@jest/environment-jsdom-abstract/build/index.js:87:23)
          at Reflect.set (<anonymous>)
      at Object.<anonymous> (src/sdk-bridge/__tests__/experiment/code-injector.test.ts:25:30)

  console.log
    [ABSmartly] Using unique class selector: .btn-primary

      at getSelector (src/utils/selector-generator-visual.ts:217:19)

  console.log
    [ABSmartly] Single tag selector too brittle, continuing search: span

      at getSelector (src/utils/selector-generator-visual.ts:357:17)

  console.error
    Error: Not implemented: navigation (except hash changes)
        at module.exports (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/browser/not-implemented.js:9:17)
        at navigateFetch (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/navigation.js:77:3)
        at exports.navigate (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/navigation.js:55:3)
        at LocationImpl._locationObjectNavigate (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/Location-impl.js:30:5)
        at LocationImpl._locationObjectSetterNavigate (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/Location-impl.js:24:17)
        at LocationImpl.set href [as href] (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/Location-impl.js:46:10)
        at Location.set href [as href] (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/generated/Location.js:125:37)
        at Reflect.set (<anonymous>)
        at Window.set location [as location] (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/browser/Window.js:424:15)
        at Object.<anonymous> (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/src/sdk-bridge/__tests__/experiment/code-injector.test.ts:25:30)
        at Promise.finally.completed (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1557:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1497:10)
        at _callCircusHook (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:976:40)
        at processTicksAndRejections (node:internal/process/task_queues:105:5)
        at _runTest (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:941:5)
        at /Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:849:7
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:862:11)
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:857:11)
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:857:11)
        at run (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:761:3)
        at runAndTransformResultsToJestFormat (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1918:21)
        at jestAdapter (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/runner.js:101:19)
        at runTestInternal (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:275:16)
        at runTest (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:343:7)
        at Object.worker (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:497:12) {
      type: 'not implemented'
    }

      23 |     // Mock window.location
      24 |     delete (window as any).location
    > 25 |     ;(window as any).location = {
         |                              ^
      26 |       href: 'https://example.com/path/to/page?query=value#hash',
      27 |       pathname: '/path/to/page',
      28 |       hostname: 'example.com',

      at VirtualConsole.<anonymous> (node_modules/@jest/environment-jsdom-abstract/build/index.js:87:23)
          at Reflect.set (<anonymous>)
      at Object.<anonymous> (src/sdk-bridge/__tests__/experiment/code-injector.test.ts:25:30)

  console.log
    [ABSmartly] Simple selectors not unique. Adding specificity...

      at getSelector (src/utils/selector-generator-visual.ts:389:11)

  console.error
    Error: Not implemented: navigation (except hash changes)
        at module.exports (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/browser/not-implemented.js:9:17)
        at navigateFetch (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/navigation.js:77:3)
        at exports.navigate (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/navigation.js:55:3)
        at LocationImpl._locationObjectNavigate (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/Location-impl.js:30:5)
        at LocationImpl._locationObjectSetterNavigate (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/Location-impl.js:24:17)
        at LocationImpl.set href [as href] (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/Location-impl.js:46:10)
        at Location.set href [as href] (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/generated/Location.js:125:37)
        at Reflect.set (<anonymous>)
        at Window.set location [as location] (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/browser/Window.js:424:15)
        at Object.<anonymous> (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/src/sdk-bridge/__tests__/experiment/code-injector.test.ts:25:30)
        at Promise.finally.completed (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1557:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1497:10)
        at _callCircusHook (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:976:40)
        at processTicksAndRejections (node:internal/process/task_queues:105:5)
        at _runTest (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:941:5)
        at /Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:849:7
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:862:11)
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:857:11)
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:857:11)
        at run (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:761:3)
        at runAndTransformResultsToJestFormat (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1918:21)
        at jestAdapter (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/runner.js:101:19)
        at runTestInternal (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:275:16)
        at runTest (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:343:7)
        at Object.worker (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:497:12) {
      type: 'not implemented'
    }

      23 |     // Mock window.location
      24 |     delete (window as any).location
    > 25 |     ;(window as any).location = {
         |                              ^
      26 |       href: 'https://example.com/path/to/page?query=value#hash',
      27 |       pathname: '/path/to/page',
      28 |       hostname: 'example.com',

      at VirtualConsole.<anonymous> (node_modules/@jest/environment-jsdom-abstract/build/index.js:87:23)
          at Reflect.set (<anonymous>)
      at Object.<anonymous> (src/sdk-bridge/__tests__/experiment/code-injector.test.ts:25:30)

  console.log
    [ABSmartly] WARNING: Using nth-child selectors (poor performance)...

      at getSelector (src/utils/selector-generator-visual.ts:393:11)

  console.log
    [ABSmartly] Using fallback with nth-child

      at getSelector (src/utils/selector-generator-visual.ts:437:11)

  console.log
    [ABSmartly] Found minimal fallback selector: span

      at getSelector (src/utils/selector-generator-visual.ts:500:15)

  console.log
    [ABSmartly] Single tag selector too brittle, continuing search: h1

      at getSelector (src/utils/selector-generator-visual.ts:357:17)

  console.log
    [ABSmartly] Added parent context to structural tag: header > h1

      at getSelector (src/utils/selector-generator-visual.ts:377:19)

  console.log
    [ABSmartly] Single tag selector too brittle, continuing search: p

      at getSelector (src/utils/selector-generator-visual.ts:357:17)

  console.error
    Error: Not implemented: navigation (except hash changes)
        at module.exports (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/browser/not-implemented.js:9:17)
        at navigateFetch (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/navigation.js:77:3)
        at exports.navigate (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/navigation.js:55:3)
        at LocationImpl._locationObjectNavigate (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/Location-impl.js:30:5)
        at LocationImpl._locationObjectSetterNavigate (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/Location-impl.js:24:17)
        at LocationImpl.set href [as href] (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/Location-impl.js:46:10)
        at Location.set href [as href] (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/generated/Location.js:125:37)
        at Reflect.set (<anonymous>)
        at Window.set location [as location] (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/browser/Window.js:424:15)
        at Object.<anonymous> (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/src/sdk-bridge/__tests__/experiment/code-injector.test.ts:25:30)
        at Promise.finally.completed (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1557:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1497:10)
        at _callCircusHook (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:976:40)
        at processTicksAndRejections (node:internal/process/task_queues:105:5)
        at _runTest (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:941:5)
        at /Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:849:7
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:862:11)
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:857:11)
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:857:11)
        at run (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:761:3)
        at runAndTransformResultsToJestFormat (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1918:21)
        at jestAdapter (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/runner.js:101:19)
        at runTestInternal (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:275:16)
        at runTest (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:343:7)
        at Object.worker (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:497:12) {
      type: 'not implemented'
    }

      23 |     // Mock window.location
      24 |     delete (window as any).location
    > 25 |     ;(window as any).location = {
         |                              ^
      26 |       href: 'https://example.com/path/to/page?query=value#hash',
      27 |       pathname: '/path/to/page',
      28 |       hostname: 'example.com',

      at VirtualConsole.<anonymous> (node_modules/@jest/environment-jsdom-abstract/build/index.js:87:23)
          at Reflect.set (<anonymous>)
      at Object.<anonymous> (src/sdk-bridge/__tests__/experiment/code-injector.test.ts:25:30)

  console.log
    [ABSmartly] Simple selectors not unique. Adding specificity...

      at getSelector (src/utils/selector-generator-visual.ts:389:11)

  console.log
    [ABSmartly] WARNING: Using nth-child selectors (poor performance)...

      at getSelector (src/utils/selector-generator-visual.ts:393:11)

  console.log
    [ABSmartly] Using fallback with nth-child

      at getSelector (src/utils/selector-generator-visual.ts:437:11)

  console.log
    [ABSmartly] Found minimal fallback selector: p

      at getSelector (src/utils/selector-generator-visual.ts:500:15)

  console.log
    [ABSmartly] Single tag selector too brittle, continuing search: span

      at getSelector (src/utils/selector-generator-visual.ts:357:17)

  console.log
    [ABSmartly] Simple selectors not unique. Adding specificity...

      at getSelector (src/utils/selector-generator-visual.ts:389:11)

  console.log
    [ABSmartly] WARNING: Using nth-child selectors (poor performance)...

      at getSelector (src/utils/selector-generator-visual.ts:393:11)

  console.error
    Failed to change image source: Error: Test error
        at Object.<anonymous> (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/src/visual-editor/core/__tests__/element-actions.test.ts:441:52)
        at Promise.finally.completed (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1557:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1497:10)
        at _callCircusTest (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1007:40)
        at processTicksAndRejections (node:internal/process/task_queues:105:5)
        at _runTest (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:947:3)
        at /Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:849:7
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:862:11)
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:857:11)
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:857:11)
        at run (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:761:3)
        at runAndTransformResultsToJestFormat (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1918:21)
        at jestAdapter (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/runner.js:101:19)
        at runTestInternal (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:275:16)
        at runTest (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:343:7)
        at Object.worker (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:497:12)

      183 |       this.notifications.show('Image source updated', '', 'success')
      184 |     } catch (error) {
    > 185 |       console.error('Failed to change image source:', error)
          |               ^
      186 |       this.notifications.show('Failed to change image source', '', 'error')
      187 |     }
      188 |   }

      at ElementActions.changeImageSource (src/visual-editor/core/element-actions.ts:185:15)
      at Object.<anonymous> (src/visual-editor/core/__tests__/element-actions.test.ts:444:7)

PASS src/sdk-bridge/__tests__/sdk/plugin-detector.test.ts
  PluginDetector
    detectPlugin
      ✓ should return null when no plugin is found (2 ms)
      ✓ should detect plugin via context.__domPlugin registration (1 ms)
      ✓ should return null if __domPlugin exists but not initialized (1 ms)
      ✓ should detect plugin at window.__absmartlyPlugin (1 ms)
      ✓ should detect plugin at window.__absmartlyDOMChangesPlugin (1 ms)
      ✓ should prioritize context.__domPlugin over window properties (24 ms)
      ✓ should prioritize window.__absmartlyPlugin over __absmartlyDOMChangesPlugin (33 ms)
      ✓ should detect plugin via DOM artifacts with data-absmartly-modified (1 ms)
      ✓ should detect plugin via DOM artifacts with data-absmartly-created (1 ms)
      ✓ should detect plugin via DOM artifacts with data-absmartly-injected (1 ms)
      ✓ should detect plugin via multiple DOM artifacts (1 ms)
      ✓ should return null when context is null
      ✓ should return null when context is undefined (1 ms)
      ✓ should handle context without __domPlugin property
    isPluginAccessible
      ✓ should return true for plugin instance (1 ms)
      ✓ should return false for "active-but-inaccessible"
      ✓ should return false for null (1 ms)
      ✓ should return true for any object instance (1 ms)
    isPluginActive
      ✓ should return true for plugin instance
      ✓ should return true for "active-but-inaccessible"
      ✓ should return false for null
      ✓ should return true for any truthy value (1 ms)
    edge cases
      ✓ should handle DOM query selector errors gracefully (15 ms)
      ✓ should work with empty context object (1 ms)
      ✓ should detect multiple detection methods simultaneously (1 ms)
      ✓ should handle context with initialized=false (1 ms)

  console.log
    [ABSmartly] Using fallback with nth-child

      at getSelector (src/utils/selector-generator-visual.ts:437:11)

  console.log
    [ABSmartly] Found minimal fallback selector: span

      at getSelector (src/utils/selector-generator-visual.ts:500:15)

  console.error
    Error: Not implemented: navigation (except hash changes)
        at module.exports (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/browser/not-implemented.js:9:17)
        at navigateFetch (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/navigation.js:77:3)
        at exports.navigate (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/navigation.js:55:3)
        at LocationImpl._locationObjectNavigate (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/Location-impl.js:30:5)
        at LocationImpl._locationObjectSetterNavigate (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/Location-impl.js:24:17)
        at LocationImpl.set href [as href] (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/Location-impl.js:46:10)
        at Location.set href [as href] (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/generated/Location.js:125:37)
        at Reflect.set (<anonymous>)
        at Window.set location [as location] (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/browser/Window.js:424:15)
        at Object.<anonymous> (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/src/sdk-bridge/__tests__/experiment/code-injector.test.ts:25:30)
        at Promise.finally.completed (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1557:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1497:10)
        at _callCircusHook (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:976:40)
        at processTicksAndRejections (node:internal/process/task_queues:105:5)
        at _runTest (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:941:5)
        at /Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:849:7
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:862:11)
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:857:11)
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:857:11)
        at run (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:761:3)
        at runAndTransformResultsToJestFormat (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1918:21)
        at jestAdapter (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/runner.js:101:19)
        at runTestInternal (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:275:16)
        at runTest (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:343:7)
        at Object.worker (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:497:12) {
      type: 'not implemented'
    }

      23 |     // Mock window.location
      24 |     delete (window as any).location
    > 25 |     ;(window as any).location = {
         |                              ^
      26 |       href: 'https://example.com/path/to/page?query=value#hash',
      27 |       pathname: '/path/to/page',
      28 |       hostname: 'example.com',

      at VirtualConsole.<anonymous> (node_modules/@jest/environment-jsdom-abstract/build/index.js:87:23)
          at Reflect.set (<anonymous>)
      at Object.<anonymous> (src/sdk-bridge/__tests__/experiment/code-injector.test.ts:25:30)

  console.log
    [ABSmartly] Using parent ID with tag path (moderately fast): #icon-svg g > path

      at getSelector (src/utils/selector-generator-visual.ts:185:19)

  console.log
    [ABSmartly] Using parent ID with tag path (moderately fast): #icon-svg g > circle

      at getSelector (src/utils/selector-generator-visual.ts:185:19)

  console.log
    [ABSmartly] Using parent ID with tag path (moderately fast): #parent div > div > span

      at getSelector (src/utils/selector-generator-visual.ts:185:19)

  console.log
    [ABSmartly] Using parent ID with tag path (moderately fast): #container div.unique-class > span

      at getSelector (src/utils/selector-generator-visual.ts:185:19)

  console.log
    [ABSmartly] Simple selectors not unique. Adding specificity...

      at getSelector (src/utils/selector-generator-visual.ts:389:11)

  console.log
    [ABSmartly] WARNING: Using nth-child selectors (poor performance)...

      at getSelector (src/utils/selector-generator-visual.ts:393:11)

  console.log
    [ABSmartly] Using nth-of-type selector (slow but unique): #container > div:nth-of-type(2) > span

      at getSelector (src/utils/selector-generator-visual.ts:427:19)

  console.error
    Error: Not implemented: navigation (except hash changes)
        at module.exports (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/browser/not-implemented.js:9:17)
        at navigateFetch (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/navigation.js:77:3)
        at exports.navigate (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/navigation.js:55:3)
        at LocationImpl._locationObjectNavigate (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/Location-impl.js:30:5)
        at LocationImpl._locationObjectSetterNavigate (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/Location-impl.js:24:17)
        at LocationImpl.set href [as href] (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/Location-impl.js:46:10)
        at Location.set href [as href] (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/generated/Location.js:125:37)
        at Reflect.set (<anonymous>)
        at Window.set location [as location] (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/browser/Window.js:424:15)
        at Object.<anonymous> (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/src/sdk-bridge/__tests__/experiment/code-injector.test.ts:25:30)
        at Promise.finally.completed (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1557:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1497:10)
        at _callCircusHook (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:976:40)
        at processTicksAndRejections (node:internal/process/task_queues:105:5)
        at _runTest (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:941:5)
        at /Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:849:7
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:862:11)
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:857:11)
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:857:11)
        at run (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:761:3)
        at runAndTransformResultsToJestFormat (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1918:21)
        at jestAdapter (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/runner.js:101:19)
        at runTestInternal (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:275:16)
        at runTest (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:343:7)
        at Object.worker (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:497:12) {
      type: 'not implemented'
    }

      23 |     // Mock window.location
      24 |     delete (window as any).location
    > 25 |     ;(window as any).location = {
         |                              ^
      26 |       href: 'https://example.com/path/to/page?query=value#hash',
      27 |       pathname: '/path/to/page',
      28 |       hostname: 'example.com',

      at VirtualConsole.<anonymous> (node_modules/@jest/environment-jsdom-abstract/build/index.js:87:23)
          at Reflect.set (<anonymous>)
      at Object.<anonymous> (src/sdk-bridge/__tests__/experiment/code-injector.test.ts:25:30)

  console.error
    Error: Not implemented: navigation (except hash changes)
        at module.exports (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/browser/not-implemented.js:9:17)
        at navigateFetch (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/navigation.js:77:3)
        at exports.navigate (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/navigation.js:55:3)
        at LocationImpl._locationObjectNavigate (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/Location-impl.js:30:5)
        at LocationImpl._locationObjectSetterNavigate (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/Location-impl.js:24:17)
        at LocationImpl.set href [as href] (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/Location-impl.js:46:10)
        at Location.set href [as href] (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/generated/Location.js:125:37)
        at Reflect.set (<anonymous>)
        at Window.set location [as location] (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/browser/Window.js:424:15)
        at Object.<anonymous> (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/src/sdk-bridge/__tests__/experiment/code-injector.test.ts:25:30)
        at Promise.finally.completed (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1557:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1497:10)
        at _callCircusHook (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:976:40)
        at processTicksAndRejections (node:internal/process/task_queues:105:5)
        at _runTest (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:941:5)
        at /Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:849:7
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:862:11)
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:857:11)
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:857:11)
        at run (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:761:3)
        at runAndTransformResultsToJestFormat (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1918:21)
        at jestAdapter (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/runner.js:101:19)
        at runTestInternal (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:275:16)
        at runTest (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:343:7)
        at Object.worker (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:497:12) {
      type: 'not implemented'
    }

      23 |     // Mock window.location
      24 |     delete (window as any).location
    > 25 |     ;(window as any).location = {
         |                              ^
      26 |       href: 'https://example.com/path/to/page?query=value#hash',
      27 |       pathname: '/path/to/page',
      28 |       hostname: 'example.com',

      at VirtualConsole.<anonymous> (node_modules/@jest/environment-jsdom-abstract/build/index.js:87:23)
          at Reflect.set (<anonymous>)
      at Object.<anonymous> (src/sdk-bridge/__tests__/experiment/code-injector.test.ts:25:30)

  console.log
    [ABSmartly] Using parent ID with tag path (moderately fast): #unique-child span

      at getSelector (src/utils/selector-generator-visual.ts:185:19)

  console.error
    Error: Not implemented: navigation (except hash changes)
        at module.exports (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/browser/not-implemented.js:9:17)
        at navigateFetch (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/navigation.js:77:3)
        at exports.navigate (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/navigation.js:55:3)
        at LocationImpl._locationObjectNavigate (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/Location-impl.js:30:5)
        at LocationImpl._locationObjectSetterNavigate (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/Location-impl.js:24:17)
        at LocationImpl.set href [as href] (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/Location-impl.js:46:10)
        at Location.set href [as href] (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/generated/Location.js:125:37)
        at Reflect.set (<anonymous>)
        at Window.set location [as location] (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/browser/Window.js:424:15)
        at Object.<anonymous> (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/src/sdk-bridge/__tests__/experiment/code-injector.test.ts:25:30)
        at Promise.finally.completed (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1557:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1497:10)
        at _callCircusHook (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:976:40)
        at processTicksAndRejections (node:internal/process/task_queues:105:5)
        at _runTest (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:941:5)
        at /Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:849:7
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:862:11)
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:857:11)
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:857:11)
        at run (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:761:3)
        at runAndTransformResultsToJestFormat (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1918:21)
        at jestAdapter (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/runner.js:101:19)
        at runTestInternal (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:275:16)
        at runTest (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:343:7)
        at Object.worker (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:497:12) {
      type: 'not implemented'
    }

      23 |     // Mock window.location
      24 |     delete (window as any).location
    > 25 |     ;(window as any).location = {
         |                              ^
      26 |       href: 'https://example.com/path/to/page?query=value#hash',
      27 |       pathname: '/path/to/page',
      28 |       hostname: 'example.com',

      at VirtualConsole.<anonymous> (node_modules/@jest/environment-jsdom-abstract/build/index.js:87:23)
          at Reflect.set (<anonymous>)
      at Object.<anonymous> (src/sdk-bridge/__tests__/experiment/code-injector.test.ts:25:30)

PASS src/utils/__tests__/selector-generator-visual.test.ts (7.141 s)
  isAutoGenerated
    ✓ should detect ABSmartly-added attributes (5 ms)
    ✓ should detect IDs starting with numbers (1 ms)
    ✓ should detect framework-specific patterns (1 ms)
    ✓ should detect hex strings and random patterns
  getSelector - Performance Priority
    Priority 1: Unique IDs (fastest)
      ✓ should return ID selector for element with unique ID (217 ms)
      ✓ should use unique ID directly when element has one (6 ms)
      ✓ should escape special characters in IDs (7 ms)
    Priority 2: Duplicate IDs with simple parent (1.08x slower)
      ✓ should handle duplicate IDs with parent context (117 ms)
      ✓ should disambiguate duplicate IDs at same level (109 ms)
    Priority 3: Tag paths with parent IDs (2-3x slower)
      ✓ should build tag path from parent ID (4 ms)
      ✓ should prefer descendant over child combinator for performance (6 ms)
    Priority 4: Data attributes (30-40x slower)
      ✓ should use data-testid when no stable ID available (24 ms)
      ✓ should prefer unique ID over data-testid for performance (2 ms)
      ✓ should use data-test when data-testid not available (16 ms)
      ✓ should use data-cy for Cypress tests (5 ms)
      ✓ should ignore data-absmartly attributes (4 ms)
    Priority 5: Avoiding nth-child (100x+ slower)
      ✓ should not add nth-child for single children (3 ms)
      ✓ should use nth-of-type when absolutely necessary (6 ms)
      ✓ should handle multiple identical siblings efficiently (115 ms)
  getSelector - Complex Real-World Cases
    E-commerce layouts (Amazon-like)
      ✓ should handle product cards with duplicate IDs (25 ms)
      ✓ should handle deeply nested product listings (33 ms)
    Auto-generated IDs and classes
      ✓ should ignore all types of auto-generated IDs (94 ms)
      ✓ should handle Tailwind and CSS module classes (4 ms)
    Edge cases
      ✓ should handle empty element gracefully (1 ms)
      ✓ should handle body element (1 ms)
      ✓ should handle elements at max depth (13 ms)
      ✓ should handle special HTML5 semantic elements (80 ms)
      ✓ should handle SVG elements (20 ms)
    Performance considerations
      ✓ should prefer descendant selector over child combinator (6 ms)
      ✓ should minimize use of nth-child selectors (18 ms)
      ✓ should create shortest possible unique selector (11 ms)

  console.error
    Error: Not implemented: navigation (except hash changes)
        at module.exports (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/browser/not-implemented.js:9:17)
        at navigateFetch (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/navigation.js:77:3)
        at exports.navigate (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/navigation.js:55:3)
        at LocationImpl._locationObjectNavigate (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/Location-impl.js:30:5)
        at LocationImpl._locationObjectSetterNavigate (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/Location-impl.js:24:17)
        at LocationImpl.set href [as href] (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/Location-impl.js:46:10)
        at Location.set href [as href] (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/generated/Location.js:125:37)
        at Reflect.set (<anonymous>)
        at Window.set location [as location] (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/browser/Window.js:424:15)
        at Object.<anonymous> (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/src/sdk-bridge/__tests__/experiment/code-injector.test.ts:25:30)
        at Promise.finally.completed (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1557:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1497:10)
        at _callCircusHook (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:976:40)
        at processTicksAndRejections (node:internal/process/task_queues:105:5)
        at _runTest (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:941:5)
        at /Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:849:7
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:862:11)
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:857:11)
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:857:11)
        at run (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:761:3)
        at runAndTransformResultsToJestFormat (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1918:21)
        at jestAdapter (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/runner.js:101:19)
        at runTestInternal (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:275:16)
        at runTest (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:343:7)
        at Object.worker (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:497:12) {
      type: 'not implemented'
    }

      23 |     // Mock window.location
      24 |     delete (window as any).location
    > 25 |     ;(window as any).location = {
         |                              ^
      26 |       href: 'https://example.com/path/to/page?query=value#hash',
      27 |       pathname: '/path/to/page',
      28 |       hostname: 'example.com',

      at VirtualConsole.<anonymous> (node_modules/@jest/environment-jsdom-abstract/build/index.js:87:23)
          at Reflect.set (<anonymous>)
      at Object.<anonymous> (src/sdk-bridge/__tests__/experiment/code-injector.test.ts:25:30)

  console.error
    Error: Not implemented: navigation (except hash changes)
        at module.exports (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/browser/not-implemented.js:9:17)
        at navigateFetch (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/navigation.js:77:3)
        at exports.navigate (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/navigation.js:55:3)
        at LocationImpl._locationObjectNavigate (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/Location-impl.js:30:5)
        at LocationImpl._locationObjectSetterNavigate (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/Location-impl.js:24:17)
        at LocationImpl.set href [as href] (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/Location-impl.js:46:10)
        at Location.set href [as href] (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/generated/Location.js:125:37)
        at Reflect.set (<anonymous>)
        at Window.set location [as location] (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/browser/Window.js:424:15)
        at Object.<anonymous> (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/src/sdk-bridge/__tests__/experiment/code-injector.test.ts:25:30)
        at Promise.finally.completed (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1557:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1497:10)
        at _callCircusHook (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:976:40)
        at processTicksAndRejections (node:internal/process/task_queues:105:5)
        at _runTest (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:941:5)
        at /Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:849:7
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:862:11)
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:857:11)
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:857:11)
        at run (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:761:3)
        at runAndTransformResultsToJestFormat (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1918:21)
        at jestAdapter (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/runner.js:101:19)
        at runTestInternal (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:275:16)
        at runTest (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:343:7)
        at Object.worker (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:497:12) {
      type: 'not implemented'
    }

      23 |     // Mock window.location
      24 |     delete (window as any).location
    > 25 |     ;(window as any).location = {
         |                              ^
      26 |       href: 'https://example.com/path/to/page?query=value#hash',
      27 |       pathname: '/path/to/page',
      28 |       hostname: 'example.com',

      at VirtualConsole.<anonymous> (node_modules/@jest/environment-jsdom-abstract/build/index.js:87:23)
          at Reflect.set (<anonymous>)
      at Object.<anonymous> (src/sdk-bridge/__tests__/experiment/code-injector.test.ts:25:30)

  console.error
    Error: Not implemented: navigation (except hash changes)
        at module.exports (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/browser/not-implemented.js:9:17)
        at navigateFetch (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/navigation.js:77:3)
        at exports.navigate (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/navigation.js:55:3)
        at LocationImpl._locationObjectNavigate (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/Location-impl.js:30:5)
        at LocationImpl._locationObjectSetterNavigate (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/Location-impl.js:24:17)
        at LocationImpl.set href [as href] (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/Location-impl.js:46:10)
        at Location.set href [as href] (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/generated/Location.js:125:37)
        at Reflect.set (<anonymous>)
        at Window.set location [as location] (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/browser/Window.js:424:15)
        at Object.<anonymous> (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/src/sdk-bridge/__tests__/experiment/code-injector.test.ts:25:30)
        at Promise.finally.completed (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1557:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1497:10)
        at _callCircusHook (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:976:40)
        at processTicksAndRejections (node:internal/process/task_queues:105:5)
        at _runTest (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:941:5)
        at /Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:849:7
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:862:11)
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:857:11)
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:857:11)
        at run (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:761:3)
        at runAndTransformResultsToJestFormat (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1918:21)
        at jestAdapter (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/runner.js:101:19)
        at runTestInternal (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:275:16)
        at runTest (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:343:7)
        at Objec  console.error
    Failed to hide element: Error: Selector generation failed
        at /Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/src/visual-editor/core/__tests__/element-actions.test.ts:825:15
        at /Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-mock/build/index.js:305:39
        at /Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-mock/build/index.js:312:13
        at mockConstructor (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-mock/build/index.js:102:19)
        at generateRobustSelector (eval at _createMockFunction (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-mock/build/index.js:460:31), <anonymous>:3:68)
        at ElementActions.getSelector (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/src/visual-editor/core/element-actions.ts:630:34)
        at ElementActions.hideElement (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/src/visual-editor/core/element-actions.ts:118:29)
        at /Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/src/visual-editor/core/__tests__/element-actions.test.ts:835:35
        at Object.<anonymous> (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/expect/build/index.js:1824:9)
        at Object.throwingMatcher [as toThrow] (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/expect/build/index.js:2235:93)
        at Object.<anonymous> (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/src/visual-editor/core/__tests__/element-actions.test.ts:835:54)
        at Promise.finally.completed (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1557:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1497:10)
        at _callCircusTest (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1007:40)
        at processTicksAndRejections (node:internal/process/task_queues:105:5)
        at _runTest (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:947:3)
        at /Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:849:7
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:862:11)
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:857:11)
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:857:11)
        at run (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:761:3)
        at runAndTransformResultsToJestFormat (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1918:21)
        at jestAdapter (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/runner.js:101:19)
        at runTestInternal (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:275:16)
        at runTest (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:343:7)
        at Object.worker (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:497:12)

      130 |       this.deselectElement()
      131 |     } catch (error) {
    > 132 |       console.error('Failed to hide element:', error)
          |               ^
      133 |       this.notifications.show('Failed to hide element', '', 'error')
      134 |     }
      135 |   }

      at ElementActions.hideElement (src/visual-editor/core/element-actions.ts:132:15)
      at src/visual-editor/core/__tests__/element-actions.test.ts:835:35
      at Object.<anonymous> (node_modules/expect/build/index.js:1824:9)
      at Object.throwingMatcher [as toThrow] (node_modules/expect/build/index.js:2235:93)
      at Object.<anonymous> (src/visual-editor/core/__tests__/element-actions.test.ts:835:54)

  console.error
    Failed to copy to clipboard: Error: Clipboard write failed
        at Object.<anonymous> (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/src/visual-editor/core/__tests__/element-actions.test.ts:862:57)
        at Promise.finally.completed (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1557:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1497:10)
        at _callCircusTest (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1007:40)
        at processTicksAndRejections (node:internal/process/task_queues:105:5)
        at _runTest (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:947:3)
        at /Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:849:7
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:862:11)
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:857:11)
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:857:11)
        at run (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:761:3)
        at runAndTransformResultsToJestFormat (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1918:21)
        at jestAdapter (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/runner.js:101:19)
        at runTestInternal (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:275:16)
        at runTest (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:343:7)
        at Object.worker (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:497:12)

      246 |           this.notifications.show('Element HTML copied to clipboard!', '', 'success')
      247 |         }).catch((error) => {
    > 248 |           console.error('Failed to copy to clipboard:', error)
          |                   ^
      249 |           this.notifications.show('Failed to copy to clipboard', '', 'error')
      250 |         })
      251 |       } else {

      at src/visual-editor/core/element-actions.ts:248:19

  console.error
    Failed to copy selector to clipboard: Error: Clipboard write failed
        at Object.<anonymous> (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/src/visual-editor/core/__tests__/element-actions.test.ts:888:57)
        at Promise.finally.completed (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1557:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1497:10)
        at _callCircusTest (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1007:40)
        at _runTest (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:947:3)
        at /Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:849:7
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:862:11)
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:857:11)
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:857:11)
        at run (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:761:3)
        at runAndTransformResultsToJestFormat (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1918:21)
        at jestAdapter (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/runner.js:101:19)
        at runTestInternal (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:275:16)
        at runTest (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:343:7)
        at Object.worker (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:497:12)

      267 |           this.notifications.show(`Selector copied: ${selector}`, '', 'success')
      268 |         }).catch((error) => {
    > 269 |           console.error('Failed to copy selector to clipboard:', error)
          |                   ^
      270 |           this.notifications.show('Failed to copy selector to clipboard', '', 'error')
      271 |         })
      272 |       } else {

      at src/visual-editor/core/element-actions.ts:269:19

  console.log
    [handleMenuAction] START - action: edit

      at EditorCoordinator.handleMenuAction (src/visual-editor/core/editor-coordinator.ts:280:13)

PASS src/visual-editor/ui/__tests__/notifications.test.ts (7.288 s)
  Notifications
    show() method
      ✓ should create and display a notification with title only (42 ms)
      ✓ should create a notification with title and message (3 ms)
      ✓ should display success notification with correct styling (6 ms)
      ✓ should display error notification with correct styling (64 ms)
      ✓ should display info notification with correct styling (80 ms)
      ✓ should default to info type when no type specified (15 ms)
      ✓ should apply correct CSS positioning and styling (14 ms)
      ✓ should append notification to document body (6 ms)
    Auto-dismiss functionality
      ✓ should auto-dismiss notification after 3 seconds (9 ms)
      ✓ should not auto-dismiss if manually removed first (3 ms)
    Multiple notification handling
      ✓ should create new notifications when called multiple times (15 ms)
      ✓ should update currentNotification reference (56 ms)
    remove() method
      ✓ should remove notification with slide-down animation (87 ms)
      ✓ should handle removal when no notification exists (1 ms)
      ✓ should handle multiple remove calls gracefully (5 ms)
    Animation styles management
      ✓ should add animation styles to document head (2 ms)
      ✓ should not duplicate animation styles (7 ms)
      ✓ should include slideUp animation keyframes (14 ms)
      ✓ should include slideDown animation keyframes (3 ms)
    Background color mapping
      ✓ should return correct color for success type (3 ms)
      ✓ should return correct color for error type (3 ms)
      ✓ should return correct color for info type (40 ms)
    Memory management
      ✓ should clear currentNotification reference on removal (16 ms)
      ✓ should clear currentNotification on auto-dismiss (11 ms)
    DOM manipulation safety
      ✓ should handle missing document.body gracefully (28 ms)
      ✓ should handle HTML content safely (4 ms)
    Z-index and positioning
      ✓ should use maximum z-index for overlay (2 ms)
      ✓ should center notification horizontally (2 ms)
      ✓ should position notification at bottom of viewport (1 ms)
    Accessibility considerations
      ✓ should use appropriate semantic markup (1 ms)
      ✓ should be readable with system fonts (1 ms)
      ✓ should have sufficient contrast with white text (3 ms)
    Edge cases
      ✓ should handle empty title (2 ms)
      ✓ should handle empty message with title (2 ms)
      ✓ should handle very long content (13 ms)
      ✓ should handle special characters in content (6 ms)
    Performance considerations
      ✓ should reuse style element across instances (4 ms)
      ✓ should track currentNotification reference correctly with rapid calls (23 ms)

  console.log
    [VisualEditor] Constructor called with options: {
      variantName: 'test-variant',
      experimentName: 'test-experiment',
      logoUrl: 'https://example.com/logo.png',
      onChangesUpdate: [Function: mockConstructor] {
        _isMockFunction: true,
        getMockImplementation: [Function (anonymous)],
        mock: [Getter/Setter],
        mockClear: [Function (anonymous)],
        mockReset: [Function (anonymous)],
        mockRestore: [Function (anonymous)],
        mockReturnValueOnce: [Function (anonymous)],
        mockResolvedValueOnce: [Function (anonymous)],
        mockRejectedValueOnce: [Function (anonymous)],
        mockReturnValue: [Function (anonymous)],
        mockResolvedValue: [Function (anonymous)],
        mockRejectedValue: [Function (anonymous)],
        mockImplementationOnce: [Function (anonymous)],
        withImplementation: [Function: bound withImplementation],
        mockImplementation: [Function (anonymous)],
        mockReturnThis: [Function (anonymous)],
        mockName: [Function (anonymous)],
        getMockName: [Function (anonymous)],
        [Symbol(nodejs.dispose)]: [Function (anonymous)]
      },
      initialChanges: []
    }

      at new VisualEditor (src/visual-editor/core/visual-editor.ts:53:13)

  console.log
    [handleMenuAction] Received element: HTMLSpanElement {}

      at EditorCoordinator.handleMenuAction (src/visual-editor/core/editor-coordinator.ts:281:13)

  console.log
    [VisualEditor] Experiment name from options: test-experiment

      at new VisualEditor (src/visual-editor/core/visual-editor.ts:54:13)

  console.error
    Failed to copy element: Error: Failed to access outerHTML
        at HTMLElement.get (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/src/visual-editor/core/__tests__/element-actions.test.ts:938:17)
        at ElementActions.copyElement (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/src/visual-editor/core/element-actions.ts:243:41)
        at Object.<anonymous> (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/src/visual-editor/core/__tests__/element-actions.test.ts:947:28)
        at Promise.finally.completed (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1557:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1497:10)
        at _callCircusTest (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1007:40)
        at _runTest (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:947:3)
        at /Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:849:7
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:862:11)
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:857:11)
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:857:11)
        at run (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:761:3)
        at runAndTransformResultsToJestFormat (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1918:21)
        at jestAdapter (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/runner.js:101:19)
        at runTestInternal (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:275:16)
        at runTest (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:343:7)
        at Object.worker (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:497:12)

      253 |       }
      254 |     } catch (error) {
    > 255 |       console.error('Failed to copy element:', error)
          |               ^
      256 |       this.notifications.show('Failed to copy element', '', 'error')
      257 |     }
      258 |   }

      at ElementActions.copyElement (src/visual-editor/core/element-actions.ts:255:15)
      at Object.<anonymous> (src/visual-editor/core/__tests__/element-actions.test.ts:947:28)

  console.log
    [handleMenuAction] Element details - tagName: SPAN id: selected-element className:

      at EditorCoordinator.handleMenuAction (src/visual-editor/core/editor-coordinator.ts:282:13)

  console.log
    [handleMenuAction] Coordinator selectedElement: null

      at EditorCoordinator.handleMenuAction (src/visual-editor/core/editor-coordinator.ts:283:13)

  console.log
    [handleMenuAction] State selectedElement: HTMLSpanElement {}

      at EditorCoordinator.handleMenuAction (src/visual-editor/core/editor-coordinator.ts:284:13)

  console.error
    Failed to copy selector: Error: Selector generation error
        at /Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/src/visual-editor/core/__tests__/element-actions.test.ts:957:15
        at /Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-mock/build/index.js:305:39
        at /Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-mock/build/index.js:312:13
        at mockConstructor (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-mock/build/index.js:102:19)
        at generateRobustSelector (eval at _createMockFunction (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-mock/build/index.js:460:31), <anonymous>:3:68)
        at ElementActions.getSelector (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/src/visual-editor/core/element-actions.ts:630:34)
        at ElementActions.copySelectorPath (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/src/visual-editor/core/element-actions.ts:264:29)
        at Object.<anonymous> (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/src/visual-editor/core/__tests__/element-actions.test.ts:966:28)
        at Promise.finally.completed (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1557:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1497:10)
        at _callCircusTest (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1007:40)
        at _runTest (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:947:3)
        at /Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:849:7
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:862:11)
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:857:11)
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:857:11)
        at run (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:761:3)
        at runAndTransformResultsToJestFormat (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1918:21)
        at jestAdapter (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/runner.js:101:19)
        at runTestInternal (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:275:16)
        at runTest (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:343:7)
        at Object.worker (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:497:12)

      274 |       }
      275 |     } catch (error) {
    > 276 |       console.error('Failed to copy selector:', error)
          |               ^
      277 |       this.notifications.show('Failed to copy selector', '', 'error')
      278 |     }
      279 |   }

      at ElementActions.copySelectorPath (src/visual-editor/core/element-actions.ts:276:15)
      at Object.<anonymous> (src/visual-editor/core/__tests__/element-actions.test.ts:966:28)

  console.log
    [handleMenuAction] Handling edit action for: HTMLSpanElement {}

      at EditorCoordinator.handleMenuAction (src/visual-editor/core/editor-coordinator.ts:297:17)

  console.log
    [handleEditAction] START for element: HTMLSpanElement {}

      at EditorCoordinator.handleEditAction (src/visual-editor/core/editor-coordinator.ts:360:13)

  console.log
    [handleEditAction] Element details: SPAN selected-element

      at EditorCoordinator.handleEditAction (src/visual-editor/core/editor-coordinator.ts:361:13)

  console.log
    [VisualEditor] Constructor called with options: {
      variantName: 'test-variant',
      experimentName: 'test-experiment',
      logoUrl: 'https://example.com/logo.png',
      onChangesUpdate: [Function: mockConstructor] {
        _isMockFunction: true,
        getMockImplementation: [Function (anonymous)],
        mock: [Getter/Setter],
        mockClear: [Function (anonymous)],
        mockReset: [Function (anonymous)],
        mockRestore: [Function (anonymous)],
        mockReturnValueOnce: [Function (anonymous)],
        mockResolvedValueOnce: [Function (anonymous)],
        mockRejectedValueOnce: [Function (anonymous)],
        mockReturnValue: [Function (anonymous)],
        mockResolvedValue: [Function (anonymous)],
        mockRejectedValue: [Function (anonymous)],
        mockImplementationOnce: [Function (anonymous)],
        withImplementation: [Function: bound withImplementation],
        mockImplementation: [Function (anonymous)],
        mockReturnThis: [Function (anonymous)],
        mockName: [Function (anonymous)],
        getMockName: [Function (anonymous)],
        [Symbol(nodejs.dispose)]: [Function (anonymous)]
      },
      initialChanges: [ { selector: '.test', type: 'text', value: 'Test content' } ]
    }

      at new VisualEditor (src/visual-editor/core/visual-editor.ts:53:13)

  console.log
    [VisualEditor] Experiment name from options: test-experiment

      at new VisualEditor (src/visual-editor/core/visual-editor.ts:54:13)

PASS src/visual-editor/core/__tests__/element-actions.test.ts (7.204 s)
  ElementActions
    Constructor and Initialization
      ✓ should initialize with correct dependencies (17 ms)
      ✓ should sync with state manager changes (5 ms)
    Element Selection
      ✓ should select an element successfully (4 ms)
      ✓ should deselect previous element when selecting new one (102 ms)
      ✓ should deselect current element (19 ms)
      ✓ should handle deselection when no element is selected (14 ms)
    Hover Tooltip Management
      ✓ should show hover tooltip at correct position (18 ms)
      ✓ should adjust tooltip position to stay within viewport (14 ms)
      ✓ should remove existing tooltip before showing new one (44 ms)
      ✓ should remove hover tooltip (30 ms)
      ✓ should handle removeHoverTooltip when no tooltip exists (1 ms)
    Element Manipulation - Hide
      ✓ should hide selected element (171 ms)
      ✓ should not hide when no element is selected (4 ms)
    Element Manipulation - Change Image Source
      ✓ should change img src attribute (7 ms)
      ✓ should change background-image style (13 ms)
      ✓ should not change when dialog is cancelled (3 ms)
      ✓ should not change when no element is selected (1 ms)
      ✓ should handle errors gracefully (141 ms)
    Element Manipulation - Delete
      ✓ should delete selected element (6 ms)
      ✓ should not delete when no element is selected (1 ms)
    Copy Operations
      ✓ should copy element HTML to clipboard (1 ms)
      ✓ should copy selector path to clipboard (2 ms)
      ✓ should not copy when no element is selected (1 ms)
    Move Element Operations
      ✓ should move element up (3 ms)
      ✓ should move element down (1 ms)
      ✓ should not move element up when it is first child (1 ms)
      ✓ should not move element down when it is last child (1 ms)
      ✓ should not move when no element is selected (134 ms)
      ✓ should not move when element has no parent (3 ms)
    Insert New Block
      ✓ should show placeholder notification for insert new block (3 ms)
    Show Relative Element Selector
      ✓ should show placeholder notification for relative element selector (3 ms)
    Clear All Changes
      ✓ should clear all changes when confirmed (4 ms)
      ✓ should not clear changes when cancelled (3 ms)
    Utility Methods - Selector Generation
      ✓ should generate selector for element (4 ms)
      ✓ should use consistent selector options (5 ms)
    Utility Methods - Extension Element Detection
      ✓ should detect ABSmartly extension elements by ID (6 ms)
      ✓ should detect ABSmartly extension elements by className string (1 ms)
      ✓ should detect ABSmartly extension elements by className object (SVG) (3 ms)
      ✓ should detect ABSmartly extension elements in parent hierarchy (2 ms)
      ✓ should not detect regular elements as extension elements (2 ms)
      ✓ should handle elements with no className (2 ms)
      ✓ should handle elements with null className (43 ms)
    Edge Cases and Error Handling
      ✓ should handle element selection with no existing classes (2 ms)
      ✓ should handle selector generation errors gracefully (73 ms)
      ✓ should handle clipboard API not available (1 ms)
      ✓ should handle clipboard writeText failure for copyElement (11 ms)
      ✓ should handle clipboard writeText failure for copySelectorPath (4 ms)
      ✓ should handle clipboard API not available for copySelectorPath (2 ms)
      ✓ should handle exceptions in copyElement method (4 ms)
      ✓ should handle exceptions in copySelectorPath method (4 ms)
      ✓ should handle DOM manipulation on detached elements (3 ms)
      ✓ should handle empty text content in tooltip (2 ms)
      ✓ should handle multiple consecutive tooltip operations (4 ms)
    Integration with StateManager
      ✓ should properly sync with state changes (2 ms)
      ✓ should handle state updates with null elements (1 ms)
      ✓ should handle state updates with complex changes

  console.log
    [EditorCoordinator] Changes/Undo/Redo updated - total changes: 1

      at src/visual-editor/core/editor-coordinator.ts:143:17

  console.log
    [EditorCoordinator] Session changes (undo count): 1

      at src/visual-editor/core/editor-coordinator.ts:144:17

  console.log
    [EditorCoordinator] Redo count: 0

      at src/visual-editor/core/editor-coordinator.ts:145:17

  console.log
    [VisualEditor] Constructor called with options: {
      variantName: 'test-variant',
      experimentName: 'test-experiment',
      logoUrl: 'https://example.com/logo.png',
      onChangesUpdate: [Function: mockConstructor] {
        _isMockFunction: true,
        getMockImplementation: [Function (anonymous)],
        mock: [Getter/Setter],
        mockClear: [Function (anonymous)],
        mockReset: [Function (anonymous)],
        mockRestore: [Function (anonymous)],
        mockReturnValueOnce: [Function (anonymous)],
        mockResolvedValueOnce: [Function (anonymous)],
        mockRejectedValueOnce: [Function (anonymous)],
        mockReturnValue: [Function (anonymous)],
        mockResolvedValue: [Function (anonymous)],
        mockRejectedValue: [Function (anonymous)],
        mockImplementationOnce: [Function (anonymous)],
        withImplementation: [Function: bound withImplementation],
        mockImplementation: [Function (anonymous)],
        mockReturnThis: [Function (anonymous)],
        mockName: [Function (anonymous)],
        getMockName: [Function (anonymous)],
        [Symbol(nodejs.dispose)]: [Function (anonymous)]
      },
      initialChanges: []
    }

      at new VisualEditor (src/visual-editor/core/visual-editor.ts:53:13)

  console.log
    [VisualEditor] Experiment name from options: test-experiment

      at new VisualEditor (src/visual-editor/core/visual-editor.ts:54:13)

  console.log
    [EditorCoordinator] Changes/Undo/Redo updated - total changes: 1

      at src/visual-editor/core/editor-coordinator.ts:143:17

  console.log
    [EditorCoordinator] Session changes (undo count): 1

      at src/visual-editor/core/editor-coordinator.ts:144:17

  console.log
    [EditorCoordinator] Redo count: 0

      at src/visual-editor/core/editor-coordinator.ts:145:17

  console.log
    [VisualEditor] Constructor called with options: {
      variantName: 'test-variant',
      experimentName: 'test-experiment',
      logoUrl: 'https://example.com/logo.png',
      onChangesUpdate: [Function: mockConstructor] {
        _isMockFunction: true,
        getMockImplementation: [Function (anonymous)],
        mock: [Getter/Setter],
        mockClear: [Function (anonymous)],
        mockReset: [Function (anonymous)],
        mockRestore: [Function (anonymous)],
        mockReturnValueOnce: [Function (anonymous)],
        mockResolvedValueOnce: [Function (anonymous)],
        mockRejectedValueOnce: [Function (anonymous)],
        mockReturnValue: [Function (anonymous)],
        mockResolvedValue: [Function (anonymous)],
        mockRejectedValue: [Function (anonymous)],
        mockImplementationOnce: [Function (anonymous)],
        withImplementation: [Function: bound withImplementation],
        mockImplementation: [Function (anonymous)],
        mockReturnThis: [Function (anonymous)],
        mockName: [Function (anonymous)],
        getMockName: [Function (anonymous)],
        [Symbol(nodejs.dispose)]: [Function (anonymous)]
      },
      initialChanges: []
    }

      at new VisualEditor (src/visual-editor/core/visual-editor.ts:53:13)

  console.log
    [VisualEditor] Experiment name from options: test-experiment

      at new VisualEditor (src/visual-editor/core/visual-editor.ts:54:13)

  console.log
    [VisualEditor] Constructor called with options: {
      variantName: 'test-variant',
      experimentName: 'test-experiment',
      logoUrl: 'https://example.com/logo.png',
      onChangesUpdate: [Function: mockConstructor] {
        _isMockFunction: true,
        getMockImplementation: [Function (anonymous)],
        mock: [Getter/Setter],
        mockClear: [Function (anonymous)],
        mockReset: [Function (anonymous)],
        mockRestore: [Function (anonymous)],
        mockReturnValueOnce: [Function (anonymous)],
        mockResolvedValueOnce: [Function (anonymous)],
        mockRejectedValueOnce: [Function (anonymous)],
        mockReturnValue: [Function (anonymous)],
        mockResolvedValue: [Function (anonymous)],
        mockRejectedValue: [Function (anonymous)],
        mockImplementationOnce: [Function (anonymous)],
        withImplementation: [Function: bound withImplementation],
        mockImplementation: [Function (anonymous)],
        mockReturnThis: [Function (anonymous)],
        mockName: [Function (anonymous)],
        getMockName: [Function (anonymous)],
        [Symbol(nodejs.dispose)]: [Function (anonymous)]
      },
      initialChanges: []
    }

      at new VisualEditor (src/visual-editor/core/visual-editor.ts:53:13)

  console.log
    [VisualEditor] Experiment name from options: test-experiment

      at new VisualEditor (src/visual-editor/core/visual-editor.ts:54:13)

  console.log
    [VisualEditor] Constructor called with options: {
      variantName: 'test-variant',
      experimentName: 'test-experiment',
      logoUrl: 'https://example.com/logo.png',
      onChangesUpdate: [Function: mockConstructor] {
        _isMockFunction: true,
        getMockImplementation: [Function (anonymous)],
        mock: [Getter/Setter],
        mockClear: [Function (anonymous)],
        mockReset: [Function (anonymous)],
        mockRestore: [Function (anonymous)],
        mockReturnValueOnce: [Function (anonymous)],
        mockResolvedValueOnce: [Function (anonymous)],
        mockRejectedValueOnce: [Function (anonymous)],
        mockReturnValue: [Function (anonymous)],
        mockResolvedValue: [Function (anonymous)],
        mockRejectedValue: [Function (anonymous)],
        mockImplementationOnce: [Function (anonymous)],
        withImplementation: [Function: bound withImplementation],
        mockImplementation: [Function (anonymous)],
        mockReturnThis: [Function (anonymous)],
        mockName: [Function (anonymous)],
        getMockName: [Function (anonymous)],
        [Symbol(nodejs.dispose)]: [Function (anonymous)]
      },
      initialChanges: []
    }

      at new VisualEditor (src/visual-editor/core/visual-editor.ts:53:13)

  console.log
    [VisualEditor] Experiment name from options: test-experiment

      at new VisualEditor (src/visual-editor/core/visual-editor.ts:54:13)

  console.log
    [ABSmartly] Starting unified visual editor - Version: 3.0-UNIFIED

      at VisualEditor.start (src/visual-editor/core/visual-editor.ts:144:13)

  console.log
    [ABSmartly] Build timestamp: 2025-10-17T15:42:21.425Z

      at VisualEditor.start (src/visual-editor/core/visual-editor.ts:145:13)

  console.log
    [ABSmartly] Starting visual editor

      at VisualEditor.start (src/visual-editor/core/visual-editor.ts:158:13)

  console.log
    [ABSmartly] Visual editor banner created

      at VisualEditor.start (src/visual-editor/core/visual-editor.ts:180:13)

  console.log
    [ABSmartly] Visual editor is now active!

      at VisualEditor.start (src/visual-editor/core/visual-editor.ts:184:13)

  console.log
    [VisualEditor] Constructor called with options: {
      variantName: 'test-variant',
      experimentName: 'test-experiment',
      logoUrl: 'https://example.com/logo.png',
      onChangesUpdate: [Function: mockConstructor] {
        _isMockFunction: true,
        getMockImplementation: [Function (anonymous)],
        mock: [Getter/Setter],
        mockClear: [Function (anonymous)],
        mockReset: [Function (anonymous)],
        mockRestore: [Function (anonymous)],
        mockReturnValueOnce: [Function (anonymous)],
        mockResolvedValueOnce: [Function (anonymous)],
        mockRejectedValueOnce: [Function (anonymous)],
        mockReturnValue: [Function (anonymous)],
        mockResolvedValue: [Function (anonymous)],
        mockRejectedValue: [Function (anonymous)],
        mockImplementationOnce: [Function (anonymous)],
        withImplementation: [Function: bound withImplementation],
        mockImplementation: [Function (anonymous)],
        mockReturnThis: [Function (anonymous)],
        mockName: [Function (anonymous)],
        getMockName: [Function (anonymous)],
        [Symbol(nodejs.dispose)]: [Function (anonymous)]
      },
      initialChanges: []
    }

      at new VisualEditor (src/visual-editor/core/visual-editor.ts:53:13)

  console.log
    [VisualEditor] Experiment name from options: test-experiment

      at new VisualEditor (src/visual-editor/core/visual-editor.ts:54:13)

  console.log
    [ABSmartly] Starting unified visual editor - Version: 3.0-UNIFIED

      at VisualEditor.start (src/visual-editor/core/visual-editor.ts:144:13)

  console.log
    [ABSmartly] Build timestamp: 2025-10-17T15:42:21.459Z

      at VisualEditor.start (src/visual-editor/core/visual-editor.ts:145:13)

  console.log
    [ABSmartly] Visual editor already active

      at VisualEditor.start (src/visual-editor/core/visual-editor.ts:149:15)

  console.log
    [VisualEditor] Constructor called with options: {
      variantName: 'test-variant',
      experimentName: 'test-experiment',
      logoUrl: 'https://example.com/logo.png',
      onChangesUpdate: [Function: mockConstructor] {
        _isMockFunction: true,
        getMockImplementation: [Function (anonymous)],
        mock: [Getter/Setter],
        mockClear: [Function (anonymous)],
        mockReset: [Function (anonymous)],
        mockRestore: [Function (anonymous)],
        mockReturnValueOnce: [Function (anonymous)],
        mockResolvedValueOnce: [Function (anonymous)],
        mockRejectedValueOnce: [Function (anonymous)],
        mockReturnValue: [Function (anonymous)],
        mockResolvedValue: [Function (anonymous)],
        mockRejectedValue: [Function (anonymous)],
        mockImplementationOnce: [Function (anonymous)],
        withImplementation: [Function: bound withImplementation],
        mockImplementation: [Function (anonymous)],
        mockReturnThis: [Function (anonymous)],
        mockName: [Function (anonymous)],
        getMockName: [Function (anonymous)],
        [Symbol(nodejs.dispose)]: [Function (anonymous)]
      },
      initialChanges: []
    }

      at new VisualEditor (src/visual-editor/core/visual-editor.ts:53:13)

  console.log
    [VisualEditor] Experiment name from options: test-experiment

      at new VisualEditor (src/visual-editor/core/visual-editor.ts:54:13)

  console.log
    [ABSmartly] Starting unified visual editor - Version: 3.0-UNIFIED

      at VisualEditor.start (src/visual-editor/core/visual-editor.ts:144:13)

  console.log
    [ABSmartly] Build timestamp: 2025-10-17T15:42:21.475Z

      at VisualEditor.start (src/visual-editor/core/visual-editor.ts:145:13)

  console.log
    [ABSmartly] Starting visual editor

      at VisualEditor.start (src/visual-editor/core/visual-editor.ts:158:13)

  console.log
    [ABSmartly] Visual editor banner created

      at VisualEditor.start (src/visual-editor/core/visual-editor.ts:180:13)

  console.log
    [ABSmartly] Visual editor is now active!

      at VisualEditor.start (src/visual-editor/core/visual-editor.ts:184:13)

  console.log
    [ABSmartly] Starting unified visual editor - Version: 3.0-UNIFIED

      at VisualEditor.start (src/visual-editor/core/visual-editor.ts:144:13)

  console.log
    [ABSmartly] Build timestamp: 2025-10-17T15:42:21.478Z

      at VisualEditor.start (src/visual-editor/core/visual-editor.ts:145:13)

  console.log
    [ABSmartly] Visual editor already active

      at VisualEditor.start (src/visual-editor/core/visual-editor.ts:149:15)

  console.log
    [handleMenuAction] START - action: edit

      at EditorCoordinator.handleMenuAction (src/visual-editor/core/editor-coordinator.ts:280:13)

  console.log
    [handleMenuAction] Received element: HTMLDivElement {}

      at EditorCoordinator.handleMenuAction (src/visual-editor/core/editor-coordinator.ts:281:13)

  console.log
    [handleMenuAction] Element details - tagName: DIV id: test-element className: test-class

      at EditorCoordinator.handleMenuAction (src/visual-editor/core/editor-coordinator.ts:282:13)

  console.log
    [handleMenuAction] Coordinator selectedElement: null

      at EditorCoordinator.handleMenuAction (src/visual-editor/core/editor-coordinator.ts:283:13)

  console.log
    [handleMenuAction] State selectedElement: HTMLSpanElement {}

      at EditorCoordinator.handleMenuAction (src/visual-editor/core/editor-coordinator.ts:284:13)

  console.log
    [handleMenuAction] Handling edit action for: HTMLDivElement {}

      at EditorCoordinator.handleMenuAction (src/visual-editor/core/editor-coordinator.ts:297:17)

t.worker (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:497:12) {
      type: 'not implemented'
    }

      23 |     // Mock window.location
      24 |     delete (window as any).location
    > 25 |     ;(window as any).location = {
         |                              ^
      26 |       href: 'https://example.com/path/to/page?query=value#hash',
      27 |       pathname: '/path/to/page',
      28 |       hostname: 'example.com',

      at VirtualConsole.<anonymous> (node_modules/@jest/environment-jsdom-abstract/build/index.js:87:23)
          at Reflect.set (<anonymous>)
      at Object.<anonymous> (src/sdk-bridge/__tests__/experiment/code-injector.test.ts:25:30)

  console.error
    Error: Not implemented: navigation (except hash changes)
        at module.exports (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/browser/not-implemented.js:9:17)
        at navigateFetch (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/navigation.js:77:3)
        at exports.navigate (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/navigation.js:55:3)
        at LocationImpl._locationObjectNavigate (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/Location-impl.js:30:5)
        at LocationImpl._locationObjectSetterNavigate (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/Location-impl.js:24:17)
        at LocationImpl.set href [as href] (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/Location-impl.js:46:10)
        at Location.set href [as href] (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/generated/Location.js:125:37)
        at Reflect.set (<anonymous>)
        at Window.set location [as location] (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/browser/Window.js:424:15)
        at Object.<anonymous> (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/src/sdk-bridge/__tests__/experiment/code-injector.test.ts:25:30)
        at Promise.finally.completed (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1557:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1497:10)
        at _callCircusHook (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:976:40)
        at processTicksAndRejections (node:internal/process/task_queues:105:5)
        at _runTest (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:941:5)
        at /Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:849:7
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:862:11)
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:857:11)
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:857:11)
        at run (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:761:3)
        at runAndTransformResultsToJestFormat (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1918:21)
        at jestAdapter (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/runner.js:101:19)
        at runTestInternal (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:275:16)
        at runTest (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:343:7)
        at Object.worker (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:497:12) {
      type: 'not implemented'
    }

      23 |     // Mock window.location
      24 |     delete (window as any).location
    > 25 |     ;(window as any).location = {
         |                              ^
      26 |       href: 'https://example.com/path/to/page?query=value#hash',
      27 |       pathname: '/path/to/page',
      28 |       hostname: 'example.com',

      at VirtualConsole.<anonymous> (node_modules/@jest/environment-jsdom-abstract/build/index.js:87:23)
          at Reflect.set (<anonymous>)
      at Object.<anonymous> (src/sdk-bridge/__tests__/experiment/code-injector.test.ts:25:30)

  console.error
    Error: Not implemented: navigation (except hash changes)
        at module.exports (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/browser/not-implemented.js:9:17)
        at navigateFetch (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/navigation.js:77:3)
        at exports.navigate (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/navigation.js:55:3)
        at LocationImpl._locationObjectNavigate (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/Location-impl.js:30:5)
        at LocationImpl._locationObjectSetterNavigate (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/Location-impl.js:24:17)
        at LocationImpl.set href [as href] (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/Location-impl.js:46:10)
        at Location.set href [as href] (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/generated/Location.js:125:37)
        at Reflect.set (<anonymous>)
        at Window.set location [as location] (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/browser/Window.js:424:15)
        at Object.<anonymous> (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/src/sdk-bridge/__tests__/experiment/code-injector.test.ts:25:30)
        at Promise.finally.completed (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1557:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1497:10)
        at _callCircusHook (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:976:40)
        at processTicksAndRejections (node:internal/process/task_queues:105:5)
        at _runTest (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:941:5)
        at /Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:849:7
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:862:11)
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:857:11)
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:857:11)
        at run (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:761:3)
        at runAndTransformResultsToJestFormat (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1918:21)
        at jestAdapter (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/runner.js:101:19)
        at runTestInternal (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:275:16)
        at runTest (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:343:7)
        at Object.worker (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:497:12) {
      type: 'not implemented'
    }

      23 |     // Mock window.location
      24 |     delete (window as any).location
    > 25 |     ;(window as any).location = {
         |                              ^
      26 |       href: 'https://example.com/path/to/page?query=value#hash',
      27 |       pathname: '/path/to/page',
      28 |       hostname: 'example.com',

      at VirtualConsole.<anonymous> (node_modules/@jest/environment-jsdom-abstract/build/index.js:87:23)
          at Reflect.set (<anonymous>)
      at Object.<anonymous> (src/sdk-bridge/__tests__/experiment/code-injector.test.ts:25:30)

  console.error
    Error: Not implemented: navigation (except hash changes)
        at module.exports (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/browser/not-implemented.js:9:17)
        at navigateFetch (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/navigation.js:77:3)
        at exports.navigate (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/navigation.js:55:3)
        at LocationImpl._locationObjectNavigate (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/Location-impl.js:30:5)
        at LocationImpl._locationObjectSetterNavigate (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/Location-impl.js:24:17)
        at LocationImpl.set href [as href] (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/Location-impl.js:46:10)
        at Location.set href [as href] (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/generated/Location.js:125:37)
        at Reflect.set (<anonymous>)
        at Window.set location [as location] (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/browser/Window.js:424:15)
        at Object.<anonymous> (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/src/sdk-bridge/__tests__/experiment/code-injector.test.ts:25:30)
        at Promise.finally.completed (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1557:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1497:10)
        at _callCircusHook (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:976:40)
        at processTicksAndRejections (node:internal/process/task_queues:105:5)
        at _runTest (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:941:5)
        at /Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:849:7
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:862:11)
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:857:11)
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:857:11)
        at run (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:761:3)
        at runAndTransformResultsToJestFormat (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1918:21)
        at jestAdapter (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/runner.js:101:19)
        at runTestInternal (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:275:16)
        at runTest (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:343:7)
        at Object.worker (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:497:12) {
      type: 'not implemented'
    }

      23 |     // Mock window.location
      24 |     delete (window as any).location
    > 25 |     ;(window as any).location = {
         |                              ^
      26 |       href: 'https://example.com/path/to/page?query=value#hash',
      27 |       pathname: '/path/to/page',
      28 |       hostname: 'example.com',

      at VirtualConsole.<anonymous> (node_modules/@jest/environment-jsdom-abstract/build/index.js:87:23)
          at Reflect.set (<anonymous>)
      at Object.<anonymous> (src/sdk-bridge/__tests__/experiment/code-injector.test.ts:25:30)

  console.error
    Error: Not implemented: navigation (except hash changes)
        at module.exports (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/browser/not-implemented.js:9:17)
        at navigateFetch (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/navigation.js:77:3)
        at exports.navigate (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/navigation.js:55:3)
        at LocationImpl._locationObjectNavigate (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/Location-impl.js:30:5)
        at LocationImpl._locationObjectSetterNavigate (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/Location-impl.js:24:17)
        at LocationImpl.set href [as href] (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/Location-impl.js:46:10)
        at Location.set href [as href] (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/generated/Location.js:125:37)
        at Reflect.set (<anonymous>)
        at Window.set location [as location] (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/browser/Window.js:424:15)
        at Object.<anonymous> (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/src/sdk-bridge/__tests__/experiment/code-injector.test.ts:25:30)
        at Promise.finally.completed (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1557:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1497:10)
        at _callCircusHook (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:976:40)
        at processTicksAndRejections (node:internal/process/task_queues:105:5)
        at _runTest (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:941:5)
        at /Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:849:7
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:862:11)
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:857:11)
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/j  console.log
    [VisualEditor] Constructor called with options: {
      variantName: 'test-variant',
      experimentName: 'test-experiment',
      logoUrl: 'https://example.com/logo.png',
      onChangesUpdate: [Function: mockConstructor] {
        _isMockFunction: true,
        getMockImplementation: [Function (anonymous)],
        mock: [Getter/Setter],
        mockClear: [Function (anonymous)],
        mockReset: [Function (anonymous)],
        mockRestore: [Function (anonymous)],
        mockReturnValueOnce: [Function (anonymous)],
        mockResolvedValueOnce: [Function (anonymous)],
        mockRejectedValueOnce: [Function (anonymous)],
        mockReturnValue: [Function (anonymous)],
        mockResolvedValue: [Function (anonymous)],
        mockRejectedValue: [Function (anonymous)],
        mockImplementationOnce: [Function (anonymous)],
        withImplementation: [Function: bound withImplementation],
        mockImplementation: [Function (anonymous)],
        mockReturnThis: [Function (anonymous)],
        mockName: [Function (anonymous)],
        getMockName: [Function (anonymous)],
        [Symbol(nodejs.dispose)]: [Function (anonymous)]
      },
      initialChanges: []
    }

      at new VisualEditor (src/visual-editor/core/visual-editor.ts:53:13)

  console.log
    [VisualEditor] Experiment name from options: test-experiment

      at new VisualEditor (src/visual-editor/core/visual-editor.ts:54:13)

est-circus/build/jestAdapterInit.js:857:11)
        at run (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:761:3)
        at runAndTransformResultsToJestFormat (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1918:21)
        at jestAdapter (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/runner.js:101:19)
        at runTestInternal (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:275:16)
        at runTest (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:343:7)
        at Object.worker (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:497:12) {
      type: 'not implemented'
    }

      23 |     // Mock window.location
      24 |     delete (window as any).location
    > 25 |     ;(window as any).location = {
         |                              ^
      26 |       href: 'https://example.com/path/to/page?query=value#hash',
      27 |       pathname: '/path/to/page',
      28 |       hostname: 'example.com',

      at VirtualConsole.<anonymous> (node_modules/@jest/environment-jsdom-abstract/build/index.js:87:23)
          at Reflect.set (<anonymous>)
      at Object.<anonymous> (src/sdk-bridge/__tests__/experiment/code-injector.test.ts:25:30)

  console.error
    Error: Not implemented: navigation (except hash changes)
        at module.exports (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/browser/not-implemented.js:9:17)
        at navigateFetch (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/navigation.js:77:3)
        at exports.navigate (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/navigation.js:55:3)
        at LocationImpl._locationObjectNavigate (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/Location-impl.js:30:5)
        at LocationImpl._locationObjectSetterNavigate (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/Location-impl.js:24:17)
        at LocationImpl.set href [as href] (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/Location-impl.js:46:10)
        at Location.set href [as href] (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/generated/Location.js:125:37)
        at Reflect.set (<anonymous>)
        at Window.set location [as location] (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/browser/Window.js:424:15)
        at Object.<anonymous> (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/src/sdk-bridge/__tests__/experiment/code-injector.test.ts:25:30)
        at Promise.finally.completed (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1557:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1497:10)
        at _callCircusHook (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:976:40)
        at processTicksAndRejections (node:internal/process/task_queues:105:5)
        at _runTest (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:941:5)
        at /Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:849:7
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:862:11)
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:857:11)
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:857:11)
        at run (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:761:3)
        at runAndTransformResultsToJestFormat (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1918:21)
        at jestAdapter (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/runner.js:101:19)
        at runTestInternal (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:275:16)
        at runTest (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:343:7)
        at Object.worker (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:497:12) {
      type: 'not implemented'
    }

      23 |     // Mock window.location
      24 |     delete (window as any).location
    > 25 |     ;(window as any).location = {
         |                              ^
      26 |       href: 'https://example.com/path/to/page?query=value#hash',
      27 |       pathname: '/path/to/page',
      28 |       hostname: 'example.com',

      at VirtualConsole.<anonymous> (node_modules/@jest/environment-jsdom-abstract/build/index.js:87:23)
          at Reflect.set (<anonymous>)
      at Object.<anonymous> (src/sdk-bridge/__tests__/experiment/code-injector.test.ts:25:30)

  console.error
    Error: Not implemented: navigation (except hash changes)
        at module.exports (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/browser/not-implemented.js:9:17)
        at navigateFetch (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/navigation.js:77:3)
        at exports.navigate (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/navigation.js:55:3)
        at LocationImpl._locationObjectNavigate (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/Location-impl.js:30:5)
        at LocationImpl._locationObjectSetterNavigate (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/Location-impl.js:24:17)
        at LocationImpl.set href [as href] (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/Location-impl.js:46:10)
        at Location.set href [as href] (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/generated/Location.js:125:37)
        at Reflect.set (<anonymous>)
        at Window.set location [as location] (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/browser/Window.js:424:15)
        at Object.<anonymous> (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/src/sdk-bridge/__tests__/experiment/code-injector.test.ts:25:30)
        at Promise.finally.completed (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1557:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1497:10)
        at _callCircusHook (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:976:40)
        at processTicksAndRejections (node:internal/process/task_queues:105:5)
        at _runTest (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:941:5)
        at /Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:849:7
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:862:11)
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:857:11)
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:857:11)
        at run (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:761:3)
        at runAndTransformResultsToJestFormat (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1918:21)
        at jestAdapter (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/runner.js:101:19)
        at runTestInternal (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:275:16)
        at runTest (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:343:7)
        at Object.worker (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:497:12) {
      type: 'not implemented'
    }

      23 |     // Mock window.location
      24 |     delete (window as any).location
    > 25 |     ;(window as any).location = {
         |                              ^
      26 |       href: 'https://example.com/path/to/page?query=value#hash',
      27 |       pathname: '/path/to/page',
      28 |       hostname: 'example.com',

      at VirtualConsole.<anonymous> (node_modules/@jest/environment-jsdom-abstract/build/index.js:87:23)
          at Reflect.set (<anonymous>)
      at Object.<anonymous> (src/sdk-bridge/__tests__/experiment/code-injector.test.ts:25:30)

  console.error
    Error: Not implemented: navigation (except hash changes)
        at module.exports (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/browser/not-implemented.js:9:17)
        at navigateFetch (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/navigation.js:77:3)
        at exports.navigate (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/navigation.js:55:3)
        at LocationImpl._locationObjectNavigate (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/Location-impl.js:30:5)
        at LocationImpl._locationObjectSetterNavigate (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/Location-impl.js:24:17)
        at LocationImpl.set href [as href] (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/Location-impl.js:46:10)
        at Location.set href [as href] (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/generated/Location.js:125:37)
        at Reflect.set (<anonymous>)
        at Window.set location [as location] (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/browser/Window.js:424:15)
        at Object.<anonymous> (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/src/sdk-bridge/__tests__/experiment/code-injector.test.ts:25:30)
        at Promise.finally.completed (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1557:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1497:10)
        at _callCircusHook (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:976:40)
        at processTicksAndRejections (node:internal/process/task_queues:105:5)
        at _runTest (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:941:5)
        at /Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:849:7
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:862:11)
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:857:11)
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:857:11)
        at run (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:761:3)
        at runAndTransformResultsToJestFormat (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1918:21)
        at jestAdapter (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/runner.js:101:19)
        at runTestInternal (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:275:16)
        at runTest (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:343:7)
        at Object.worker (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:497:12) {
      type: 'not implemented'
    }

      23 |     // Mock window.location
      24 |     delete (window as any).location
    > 25 |     ;(window as any).location = {
         |                              ^
      26 |       href: 'https://example.com/path/to/page?query=value#hash',
      27 |       pathname: '/path/to/page',
      28 |       hostname: 'example.com',

      at VirtualConsole.<anonymous> (node_modules/@jest/environment-jsdom-abstract/build/index.js:87:23)
          at Reflect.set (<anonymous>)
      at Object.<anonymous> (src/sdk-bridge/__tests__/experiment/code-injector.test.ts:25:30)

  console.error
    Error: Not implemented: navigation (except hash changes)
        at module.exports (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/browser/not-implemented.js:9:17)
        at navigateFetch (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/navigation.js:77:3)
        at exports.navigate (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/navigation.js:55:3)
        at LocationImpl._locationObjectNavigate (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/Location-impl.js:30:5)
        at LocationImpl._locationObjectSetterNavigate (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/Location-impl.js:24:17)
        at LocationImpl.set href [as href] (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/Location-impl.js:46:10)
        at Location.set href [as href] (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/generated/Location.js:125:37)
        at Reflect.set (<anonymous>)
        at Window.set location [as location] (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/browser/Window.js:424:15)
        at Object.<anonymous> (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/src/sdk-bridge/__tests__/experiment/code-injector.test.ts:25:30)
        at Promise.finally.completed (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1557:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1497:10)
        at _callCircusHook (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:976:40)
        at processTicksAndRejections (node:internal/process/task_queues:105:5)
        at _runTest (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:941:5)
        at /Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:849:7
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:862:11)
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:857:11)
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:857:11)
        at run (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:761:3)
        at runAndTransformResultsToJestFormat (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1918:21)
        at jestAdapter (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/runner.js:101:19)
        at runTestInternal (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:275:16)
        at runTest (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:343:7)
        at Object.worker (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:497:12) {
      type: 'not implemented'
    }

      23 |     // Mock window.location
      24 |     delete (window as any).location
    > 25 |     ;(window as any).location = {
         |                              ^
      26 |       href: 'https://example.com/path/to/page?query=value#hash',
      27 |       pathname: '/path/to/page',
      28 |       hostname: 'example.com',

      at VirtualConsole.<anonymous> (node_modules/@jest/environment-jsdom-abstract/build/index.js:87:23)
          at Reflect.set (<anonymous>)
      at Object.<anonymous> (src/sdk-bridge/__tests__/experiment/code-injector.test.ts:25:30)

  console.error
    Error: Not implemented: navigation (except hash changes)
        at module.exports (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/browser/not-implemented.js:9:17)
        at navigateFetch (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/navigation.js:77:3)
        at exports.navigate (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/navigation.js:55:3)
        at LocationImpl._locationObjectNavigate (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/Location-impl.js:30:5)
        at LocationImpl._locationObjectSetterNavigate (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/Location-impl.js:24:17)
        at LocationImpl.set href [as href] (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/Location-impl.js:46:10)
        at Location.set href [as href] (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/generated/Location.js:125:37)
        at Reflect.set (<anonymous>)
        at Window.set location [as location] (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/browser/Window.js:424:15)
        at Object.<anonymous> (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/src/sdk-bridge/__tests__/experiment/code-injector.test.ts:25:30)
        at Promise.finally.completed (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1557:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1497:10)
        at _callCircusHook (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:976:40)
        at processTicksAndRejections (node:internal/process/task_queues:105:5)
        at _runTest (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:941:5)
        at /Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:849:7
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:862:11)
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:857:11)
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:857:11)
        at run (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:761:3)
        at runAndTransformResultsToJestFormat (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1918:21)
        at jestAdapter (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/runner.js:101:19)
        at runTestInternal (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:275:16)
        at runTest (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:343:7)
        at Object.worker (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:497:12) {
      type: 'not implemented'
    }

      23 |     // Mock window.location
      24 |     delete (window as any).location
    > 25 |     ;(window as any).location = {
         |                              ^
      26 |       href: 'https://example.com/path/to/page?query=value#hash',
      27 |       pathname: '/path/to/page',
      28 |       hostname: 'example.com',

      at VirtualConsole.<anonymous> (node_modules/@jest/environment-jsdom-abstract/build/index.js:87:23)
          at Reflect.set (<anonymous>)
      at Object.<anonymous> (src/sdk-bridge/__tests__/experiment/code-injector.test.ts:25:30)

  console.error
    Error: Not implemented: navigation (except hash changes)
        at module.exports (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/browser/not-implemented.js:9:17)
        at navigateFetch (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/navigation.js:77:3)
        at exports.navigate (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/navigation.js:55:3)
        at LocationImpl._locationObjectNavigate (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/Location-impl.js:30:5)
        at LocationImpl._locationObjectSetterNavigate (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/Location-impl.js:24:17)
        at LocationImpl.set href [as href] (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/Location-impl.js:46:10)
        at Location.set href [as href] (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/generated/Location.js:125:37)
        at Reflect.set (<anonymous>)
        at Window.set location [as location] (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/browser/Window.js:424:15)
        at Object.<anonymous> (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/src/sdk-bridge/__tests__/experiment/code-injector.test.ts:25:30)
        at Promise.finally.completed (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1557:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1497:10)
        at _callCircusHook (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:976:40)
        at processTicksAndRejections (node:internal/process/task_queues:105:5)
        at _runTest (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:941:5)
        at /Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:849:7
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:862:11)
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:857:11)
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:857:11)
        at run (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:761:3)
        at runAndTransformResultsToJestFormat (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1918:21)
        at jestAdapter (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/runner.js:101:19)
        at runTestInternal (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:275:16)
        at runTest (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:343:7)
        at Object.worker (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:497:12) {
      type: 'not implemented'
    }

      23 |     // Mock window.location
      24 |     delete (window as any).location
    > 25 |     ;(window as any).location = {
         |                              ^
      26 |       href: 'https://example.com/path/to/page?query=value#hash',
      27 |       pathname: '/path/to/page',
      28 |       hostname: 'example.com',

      at VirtualConsole.<anonymous> (node_modules/@jest/environment-jsdom-abstract/build/index.js:87:23)
          at Reflect.set (<anonymous>)
      at Object.<anonymous> (src/sdk-bridge/__tests__/experiment/code-injector.test.ts:25:30)

  console.error
    Error: Not implemented: navigation (except hash changes)
        at module.exports (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/browser/not-implemented.js:9:17)
        at navigateFetch (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/navigation.js:77:3)
        at exports.navigate (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/navigation.js:55:3)
        at LocationImpl._locationObjectNavigate (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/Location-impl.js:30:5)
        at LocationImpl._locationObjectSetterNavigate (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/Location-impl.js:24:17)
        at LocationImpl.set href [as href] (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/Location-impl.js:46:10)
        at Location.set href [as href] (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/generated/Location.js:125:37)
        at Reflect.set (<anonymous>)
        at Window.set location [as location] (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/browser/Window.js:424:15)
        at Object.<anonymous> (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/src/sdk-bridge/__tests__/experiment/code-injector.test.ts:25:30)
        at Promise.finally.completed (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1557:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1497:10)
        at _callCircusHook (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:976:40)
        at processTicksAndRejections (node:internal/process/task_queues:105:5)
        at _runTest (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:941:5)
        at /Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:849:7
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:862:11)
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:857:11)
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:857:11)
        at run (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:761:3)
        at runAndTransformResultsToJestFormat (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1918:21)
        at jestAdapter (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/runner.js:101:19)
        at runTestInternal (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:275:16)
        at runTest (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:343:7)
        at Object.worker (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:497:12) {
      type: 'not implemented'
    }

      23 |     // Mock window.location
      24 |     delete (window as any).location
    > 25 |     ;(window as any).location = {
         |                              ^
      26 |       href: 'https://example.com/path/to/page?query=value#hash',
      27 |       pathname: '/path/to/page',
      28 |       hostname: 'example.com',

      at VirtualConsole.<anonymous> (node_modules/@jest/environment-jsdom-abstract/build/index.js:87:23)
          at Reflect.set (<anonymous>)
      at Object.<anonymous> (src/sdk-bridge/__tests__/experiment/code-injector.test.ts:25:30)

  console.error
    Error: Not implemented: navigation (except hash changes)
      console.log
    [handleMenuAction] START - action: edit-element

      at EditorCoordinator.handleMenuAction (src/visual-editor/core/editor-coordinator.ts:280:13)

  console.log
    [handleMenuAction] Received element: HTMLDivElement {}

      at EditorCoordinator.handleMenuAction (src/visual-editor/core/editor-coordinator.ts:281:13)

  console.log
    [ABSmartly] Starting unified visual editor - Version: 3.0-UNIFIED

      at VisualEditor.start (src/visual-editor/core/visual-editor.ts:144:13)

    at module.exports (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/browser/not-implemented.js:9:17)
        at navigateFetch (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/navigation.js:77:3)
        at exports.navigate (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/navigation.js:55:3)
        at LocationImpl._locationObjectNavigate (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/Location-impl.js:30:5)
        at LocationImpl._locationObjectSetterNavigate (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/Location-impl.js:24:17)
        at LocationImpl.set href [as href] (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/Location-impl.js:46:10)
        at Location.set href [as href] (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/generated/Location.js:125:37)
        at Reflect.set (<anonymous>)
        at Window.set location [as location] (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/browser/Window.js:424:15)
        at Object.<anonymous> (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/src/sdk-bridge/__tests__/experiment/code-injector.test.ts:25:30)
        at Promise.finally.completed (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1557:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1497:10)
        at _callCircusHook (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:976:40)
        at processTicksAndRejections (node:internal/process/task_queues:105:5)
        at _runTest (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:941:5)
        at /Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:849:7
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:862:11)
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:857:11)
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:857:11)
        at run (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:761:3)
        at runAndTransformResultsToJestFormat (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1918:21)
        at jestAdapter (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/runner.js:101:19)
        at runTestInternal (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:275:16)
        at runTest (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:343:7)
        at Object.worker (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:497:12) {
      type: 'not implemented'
    }

      23 |     // Mock window.location
      24 |     delete (window as any).location
    > 25 |     ;(window as any).location = {
         |                              ^
      26 |       href: 'https://example.com/path/to/page?query=value#hash',
      27 |       pathname: '/path/to/page',
      28 |       hostname: 'example.com',

      at VirtualConsole.<anonymous> (node_modules/@jest/environment-jsdom-abstract/build/index.js:87:23)
          at Reflect.set (<anonymous>)
      at Object.<anonymous> (src/sdk-bridge/__tests__/experiment/code-injector.test.ts:25:30)

  console.error
    Error: Not implemented: navigation (except hash changes)
        at module.exports (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/browser/not-implemented.js:9:17)
        at navigateFetch (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/navigation.js:77:3)
        at exports.navigate (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/navigation.js:55:3)
        at LocationImpl._locationObjectNavigate (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/Location-impl.js:30:5)
        at LocationImpl._locationObjectSetterNavigate (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/Location-impl.js:24:17)
        at LocationImpl.set href [as href] (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/Location-impl.js:46:10)
        at Location.set href [as href] (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/generated/Location.js:125:37)
        at Reflect.set (<anonymous>)
        at Window.set location [as location] (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/browser/Window.js:424:15)
        at Object.<anonymous> (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/src/sdk-bridge/__tests__/experiment/code-injector.test.ts:25:30)
        at Promise.finally.completed (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1557:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1497:10)
        at _callCircusHook (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:976:40)
        at processTicksAndRejections (node:internal/process/task_queues:105:5)
        at _runTest (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:941:5)
        at /Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:849:7
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:862:11)
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:857:11)
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:857:11)
        at run (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:761:3)
        at runAndTransformResultsToJestFormat (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1918:21)
        at jestAdapter (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/runner.js:101:19)
        at runTestInternal (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:275:16)
        at runTest (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:343:7)
        at Object.worker (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:497:12) {
      type: 'not implemented'
    }

      23 |     // Mock window.location
      24 |     delete (window as any).location
    > 25 |     ;(window as any).location = {
         |                              ^
      26 |       href: 'https://example.com/path/to/page?query=value#hash',
      27 |       pathname: '/path/to/page',
      28 |       hostname: 'example.com',

      at VirtualConsole.<anonymous> (node_modules/@jest/environment-jsdom-abstract/build/index.js:87:23)
          at Reflect.set (<anonymous>)
      at Object.<anonymous> (src/sdk-bridge/__tests__/experiment/code-injector.test.ts:25:30)

  console.error
    Error: Not implemented: navigation (except hash changes)
        at module.exports (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/browser/not-implemented.js:9:17)
        at navigateFetch (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/navigation.js:77:3)
        at exports.navigate (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/navigation.js:55:3)
        at LocationImpl._locationObjectNavigate (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/Location-impl.js:30:5)
        at LocationImpl._locationObjectSetterNavigate (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/Location-impl.js:24:17)
        at LocationImpl.set href [as href] (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/Location-impl.js:46:10)
        at Location.set href [as href] (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/generated/Location.js:125:37)
        at Reflect.set (<anonymous>)
        at Window.set location [as location] (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/browser/Window.js:424:15)
        at Object.<anonymous> (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/src/sdk-bridge/__tests__/experiment/code-injector.test.ts:25:30)
        at Promise.finally.completed (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1557:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1497:10)
        at _callCircusHook (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:976:40)
        at processTicksAndRejections (node:internal/process/task_queues:105:5)
        at _runTest (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:941:5)
        at /Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:849:7
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:862:11)
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:857:11)
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:857:11)
        at run (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:761:3)
        at runAndTransformResultsToJestFormat (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1918:21)
        at jestAdapter (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/runner.js:101:19)
        at runTestInternal (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:275:16)
        at runTest (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:343:7)
        at Object.worker (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:497:12) {
      type: 'not implemented'
    }

      23 |     // Mock window.location
      24 |     delete (window as any).location
    > 25 |     ;(window as any).location = {
         |                              ^
      26 |       href: 'https://example.com/path/to/page?query=value#hash',
      27 |       pathname: '/path/to/page',
      28 |       hostname: 'example.com',

      at VirtualConsole.<anonymous> (node_modules/@jest/environment-jsdom-abstract/build/index.js:87:23)
          at Reflect.set (<anonymous>)
      at Object.<anonymous> (src/sdk-bridge/__tests__/experiment/code-injector.test.ts:25:30)

  console.error
    Error: Not implemented: navigation (except hash changes)
        at module.exports (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/browser/not-implemented.js:9:17)
        at navigateFetch (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/navigation.js:77:3)
        at exports.navigate (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/navigation.js:55:3)
        at LocationImpl._locationObjectNavigate (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/Location-impl.js:30:5)
        at LocationImpl._locationObjectSetterNavigate (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/Location-impl.js:24:17)
        at LocationImpl.set href [as href] (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/Location-impl.js:46:10)
        at Location.set href [as href] (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/generated/Location.js:125:37)
        at Reflect.set (<anonymous>)
        at Window.set location [as location] (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/browser/Window.js:424:15)
        at Object.<anonymous> (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/src/sdk-bridge/__tests__/experiment/code-injector.test.ts:25:30)
        at Promise.finally.completed (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1557:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1497:10)
        at _callCircusHook (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:976:40)
        at processTicksAndRejections (node:internal/process/task_queues:105:5)
        at _runTest (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:941:5)
        at /Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:849:7
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:862:11)
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:857:11)
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:857:11)
        at run (/Users/joalves/git_tr  console.log
    [ABSmartly] Build timestamp: 2025-10-17T15:42:21.498Z

      at VisualEditor.start (src/visual-editor/core/visual-editor.ts:145:13)

ee/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:761:3)
        at runAndTransformResultsToJestFormat (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1918:21)
        at jestAdapter (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/runner.js:101:19)
        at runTestInternal (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:275:16)
        at runTest (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:343:7)
        at Object.worker (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:497:12) {
      type: 'not implemented'
    }

      23 |     // Mock window.location
      24 |     delete (window as any).location
    > 25 |     ;(window as any).location = {
         |                              ^
      26 |       href: 'https://example.com/path/to/page?query=value#hash',
      27 |       pathname: '/path/to/page',
      28 |       hostname: 'example.com',

      at VirtualConsole.<anonymous> (node_modules/@jest/environment-jsdom-abstract/build/index.js:87:23)
          at Reflect.set (<anonymous>)
      at Object.<anonymous> (src/sdk-bridge/__tests__/experiment/code-injector.test.ts:25:30)

  console.error
    Error: Not implemented: navigation (except hash changes)
        at module.exports (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/browser/not-implemented.js:9:17)
        at navigateFetch (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/navigation.js:77:3)
        at exports.navigate (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/navigation.js:55:3)
        at LocationImpl._locationObjectNavigate (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/Location-impl.js:30:5)
        at LocationImpl._locationObjectSetterNavigate (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/Location-impl.js:24:17)
        at LocationImpl.set href [as href] (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/Location-impl.js:46:10)
        at Location.set href [as href] (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/generated/Location.js:125:37)
        at Reflect.set (<anonymous>)
        at Window.set location [as location] (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/browser/Window.js:424:15)
        at Object.<anonymous> (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/src/sdk-bridge/__tests__/experiment/code-injector.test.ts:25:30)
        at Promise.finally.completed (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1557:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1497:10)
        at _callCircusHook (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:976:40)
        at processTicksAndRejections (node:internal/process/task_queues:105:5)
        at _runTest (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:941:5)
        at /Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:849:7
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:862:11)
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:857:11)
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:857:11)
        at run (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:761:3)
        at runAndTransformResultsToJestFormat (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1918:21)
        at jestAdapter (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/runner.js:101:19)
        at runTestInternal (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:275:16)
        at runTest (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:343:7)
        at Object.worker (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:497:12) {
      type: 'not implemented'
    }

      23 |     // Mock window.location
      24 |     delete (window as any).location
    > 25 |     ;(window as any).location = {
         |                              ^
      26 |       href: 'https://example.com/path/to/page?query=value#hash',
      27 |       pathname: '/path/to/page',
      28 |       hostname: 'example.com',

      at VirtualConsole.<anonymous> (node_modules/@jest/environment-jsdom-abstract/build/index.js:87:23)
          at Reflect.set (<anonymous>)
      at Object.<anonymous> (src/sdk-bridge/__tests__/experiment/code-injector.test.ts:25:30)

  console.error
    Error: Not implemented: navigation (except hash changes)
        at module.exports (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/browser/not-implemented.js:9:17)
        at navigateFetch (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/navigation.js:77:3)
        at exports.navigate (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/navigation.js:55:3)
        at LocationImpl._locationObjectNavigate (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/Location-impl.js:30:5)
        at LocationImpl._locationObjectSetterNavigate (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/Location-impl.js:24:17)
        at LocationImpl.set href [as href] (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/Location-impl.js:46:10)
        at Location.set href [as href] (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/generated/Location.js:125:37)
        at Reflect.set (<anonymous>)
        at Window.set location [as location] (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/browser/Window.js:424:15)
        at Object.<anonymous> (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/src/sdk-bridge/__tests__/experiment/code-injector.test.ts:25:30)
        at Promise.finally.completed (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1557:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1497:10)
        at _callCircusHook (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:976:40)
        at processTicksAndRejections (node:internal/process/task_queues:105:5)
       console.log
    [ABSmartly] Starting visual editor

      at VisualEditor.start (src/visual-editor/core/visual-editor.ts:158:13)

  console.log
    [ABSmartly] Visual editor banner created

      at VisualEditor.start (src/visual-editor/core/visual-editor.ts:180:13)

   at _runTest (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:941:5)
        at /Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:849:7
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:862:11)
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:857:11)
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:857:11)
        at run (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:761:3)
        at runAndTransformResultsToJestFormat (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1918:21)
        at jestAdapter (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/runner.js:101:19)
        at runTestInternal (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:275:16)
        at runTest (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:343:7)
        at Object.worker (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:497:12) {
      type: 'not implemented'
    }

      23 |     // Mock window.location
      24 |     delete (window as any).location
    > 25 |     ;(window as any).location = {
         |                              ^
      26 |       href: 'https://example.com/path/to/page?query=value#hash',
      27 |       pathname: '/path/to/page',
      28 |       hostname: 'example.com',

      at VirtualConsole.<anonymous> (node_modules/@jest/environment-jsdom-abstract/build/index.js:87:23)
          at Reflect.set (<anonymous>)
      at Object.<anonymous> (src/sdk-bridge/__tests__/experiment/code-injector.test.ts:25:30)

  console.error
    Error: Not implemented: navigation (except hash changes)
        at module.exports (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/browser/not-implemented.js:9:17)
        at navigateFetch (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/navigation.js:77:3)
        at exports.navigate (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/navigation.js:55:3)
        at LocationImpl._locationObjectNavigate (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/Location-impl.js:30:5)
        at LocationImpl._locationObjectSetterNavigate (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/Location-impl.js:24:17)
        at LocationImpl.set href [as href] (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/Location-impl.js:46:10)
        at Location.set href [as href] (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/generated/Location.js:125:37)
        at Reflect.set (<anonymous>)
        at Window.set location [as location] (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/browser/Window.js:424:15)
        at Object.<anonymous> (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/src/sdk-bridge/__tests__/experiment/code-injector.test.ts:25:30)
        at Promise.finally.completed (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1557:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1497:10)
        at _callCircusHook (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:976:40)
        at processTicksAndRejections (node:internal/process/task_queues:105:5)
        at _runTest (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:941:5)
        at /Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:849:7
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:862:11)
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:857:11)
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:857:11)
        at run (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:761:3)
        at runAndTransformResultsToJestFormat (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1918:21)
        at jestAdapter (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/runner.js:101:19)
        at runTestInternal (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:275:16)
        at runTest (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:343:7)
        at Object.worker (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:497:12) {
      type: 'not implemented'
    }

      23 |     // Mock window.location
      24 |     delete (window as any).location
    > 25 |     ;(window as any).location = {
         |                              ^
      26 |       href: 'https://example.com/path/to/page?query=value#hash',
      27 |       pathname: '/path/to/page',
      28 |       hostname: 'example.com',

      at VirtualConsole.<anonymous> (node_modules/@jest/environment-jsdom-abstract/build/index.js:87:23)
          at Reflect.set (<anonymous>)
      at Object.<anonymous> (src/sdk-bridge/__tests__/experiment/code-injector.test.ts:25:30)

  console.error
    Error: Not implemented: navigation (except hash changes)
        at module.exports (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/browser/not-implemented.js:9:17)
        at navigateFetch (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/navigation.js:77:3)
        at exports.navigate (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/navigation.js:55:3)
        at LocationImpl._locationObjectNavigate (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/Location-impl.js:30:5)
        at LocationImpl._locationObjectSetterNavigate (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/Location-impl.js:24:17)
        at LocationImpl.set href [as href] (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/Location-impl.js:46:10)
        at Location.set href [as href] (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/generated/Location.js:125:37)
        at Reflect.set (<anonymous>)
        at Window.set location [as location] (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsd  console.log
    [handleMenuAction] Element details - tagName: DIV id: test-element className: test-class

      at EditorCoordinator.handleMenuAction (src/visual-editor/core/editor-coordinator.ts:282:13)

om/browser/Window.js:424:15)
        at Object.<anonymous> (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/src/sdk-bridge/__tests__/experiment/code-injector.test.ts:25:30)
        at Promise.finally.completed (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1557:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1497:10)
        at _callCircusHook (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:976:40)
        at processTicksAndRejections (node:internal/process/task_queues:105:5)
        at _runTest (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:941:5)
        at /Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:849:7
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:862:11)
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:857:11)
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:857:11)
        at run (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:761:3)
        at runAndTransformResultsToJestFormat (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1918:21)
        at jestAdapter (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/runner.js:101:19)
        at runTestInternal (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:275:16)
        at runTest (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:343:7)
        at Object.worker (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:497:12) {
      type: 'not implemented'
    }

      23 |     // Mock window.location
      24 |     delete (window as any).location
    > 25 |     ;(window as any).location = {
         |                              ^
      26 |       href: 'https://example.com/path/to/page?query=value#hash',
      27 |       pathname: '/path/to/page',
      28 |       hostname: 'example.com',

      at VirtualConsole.<anonymous> (node_modules/@jest/environment-jsdom-abstract/build/index.js:87:23)
          at Reflect.set (<anonymous>)
      at Object.<anonymous> (src/sdk-bridge/__tests__/experiment/code-injector.test.ts:25:30)

  console.error
    Error: Not implemented: navigation (except hash changes)
        at module.exports (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/browser/not-implemented.js:9:17)
        at navigateFetch (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/navigation.js:77:3)
        at exports.navigate (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/navigation.js:55:3)
        at LocationImpl._locationObjectNavigate (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/Location-impl.js:30:5)
        at LocationImpl._locationObjectSetterNavigate (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/Location-impl.js:24:17)
        at LocationImpl.set href [as href] (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/Location-impl.js:46:10)
        at Location.set href [as href] (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/generated/Location.js:125:37)
        at Reflect.set (<anonymous>)
        at Window.set location [as location] (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/browser/Window.js:424:15)
        at Object.<anonymous> (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/src/sdk-bridge/__tests__/experiment/code-injector.test.ts:25:30)
        at Promise.finally.completed (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1557:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1497:10)
        at _callCircusHook (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:976:40)
        at processTicksAndRejections (node:internal/process/task_queues:105:5)
        at _runTest (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:941:5)
        at /Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:849:7
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:862:11)
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:857:11)
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:857:11)
        at run (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:761:3)
        at runAndTransformResultsToJestFormat (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1918:21)
        at jestAdapter (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/runner.js:101:19)
        at runTestInternal (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:275:16)
        at runTest (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:343:7)
        at Object.worker (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:497:12) {
      type: 'not implemented'
    }

      23 |     // Mock window.location
      24 |     delete (window as any).location
    > 25 |     ;(window as any).location = {
         |                              ^
      26 |       href: 'https://example.com/path/to/page?query=value#hash',
      27 |       pathname: '/path/to/page',
      28 |       hostname: 'example.com',

      at VirtualConsole.<anonymous> (node_modules/@jest/environment-jsdom-abstract/build/index.js:87:23)
          at Reflect.set (<anonymous>)
      at Object.<anonymous> (src/sdk-bridge/__tests__/experiment/code-injector.test.ts:25:30)

  console.error
    Error: Not implemented: navigation (except hash changes)
        at module.exports (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/browser/not-implemented.js:9:17)
        at navigateFetch (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/navigation.js:77:3)
        at exports.navigate (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/navigation.js:55:3)
        at LocationImpl._locationObjectNavigate (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/Location-impl.js:30:5)
        at LocationImpl._locationObjectSetterNavigate (/Users/joalves/git_FAIL src/sdk-bridge/__tests__/experiment/code-injector.test.ts (7.455 s)
  CodeInjector
    injectExperimentCode
      ✓ should do nothing when context is null (187 ms)
      ✓ should do nothing when context has no data_ (5 ms)
      ✓ should do nothing when context has no experiments (4 ms)
      ✓ should skip experiments without assignment (15 ms)
      ✓ should skip experiments without variant config (4 ms)
      ✓ should skip experiments without __inject_html (2 ms)
      ✓ should parse string variant config (5 ms)
      ✓ should handle object variant config (50 ms)
      ✓ should skip injection when URL filter does not match (9 ms)
      ✓ should inject code at all locations when URL matches (84 ms)
      ✓ should handle invalid JSON in variant config (4 ms)
      ✓ should handle invalid JSON in __inject_html (23 ms)
      ✕ should handle errors during injection (7 ms)
      ✓ should process multiple experiments (5 ms)
    executeScriptsInHTML
      ✕ should extract and execute external scripts (139 ms)
      ✕ should preserve script async attribute (10 ms)
      ✓ should preserve script defer attribute (4 ms)
      ✓ should block inline scripts for security (4 ms)
      ✕ should process multiple external scripts (7 ms)
      ✓ should call sanitizeHTML before processing (4 ms)
      ✓ should handle script execution errors (3 ms)
      ✕ should handle mixed inline and external scripts (47 ms)
    insertAtLocation
      ✓ should insert at headStart when head is empty (3 ms)
      ✓ should insert at headStart before existing children (4 ms)
      ✓ should insert at headEnd (4 ms)
      ✓ should insert at bodyStart when body is empty (2 ms)
      ✓ should insert at bodyStart before existing children (3 ms)
      ✓ should insert at bodyEnd (5 ms)
      ✓ should warn for unknown location (12 ms)
    matchesUrlFilter
      ✓ should return true when no filter is specified (7 ms)
      ✕ should match simple string pattern (3 ms)
      ✓ should not match different string pattern (4 ms)
      ✕ should match wildcard pattern * (3 ms)
      ✕ should match wildcard pattern ? (11 ms)
      ✕ should match array of patterns (1 ms)
      ✓ should not match when none in array match (4 ms)
      ✕ should match include patterns (4 ms)
      ✓ should exclude before include (5 ms)
      ✕ should match regex pattern (2 ms)
      ✓ should handle invalid regex gracefully (3 ms)
      ✕ should match full URL when matchType is full-url (4 ms)
      ✕ should match domain when matchType is domain (7 ms)
      ✕ should match query when matchType is query (17 ms)
      ✕ should match hash when matchType is hash (2 ms)
      ✕ should match path by default (2 ms)
      ✓ should return true when no include patterns (2 ms)
      ✓ should handle exclude with wildcard (4 ms)
      ✓ should handle exclude with regex (11 ms)
    edge cases
      ✓ should handle context with undefined assignments_ (2 ms)
      ✓ should handle empty experiments array (3 ms)
      ✓ should handle variant without variants array (5 ms)
      ✓ should handle assignment to non-existent variant (4 ms)
      ✓ should sanitize HTML before processing scripts (6 ms)

  ● CodeInjector › injectExperimentCode › should handle errors during injection

    expect(jest.fn()).toHaveBeenCalledWith(...expected)

    Expected: "[ABsmartly Extension] Error processing experiment 0:", Any<Error>
    Received: "[ABsmartly Extension] Failed to execute script from headStart:", [Error: Insert error]

    Number of calls: 1

      314 |       injector.injectExperimentCode(context)
      315 |
    > 316 |       expect(mockLogger.error).toHaveBeenCalledWith(
          |                                ^
      317 |         '[ABsmartly Extension] Error processing experiment 0:',
      318 |         expect.any(Error)
      319 |       )

      at Object.<anonymous> (src/sdk-bridge/__tests__/experiment/code-injector.test.ts:316:32)

  ● CodeInjector › executeScriptsInHTML › should extract and execute external scripts

    expect(received).toBe(expected) // Object.is equality

    Expected: "test.js"
    Received: "http://localhost/test.js"

      374 |       const scripts = document.head.querySelectorAll('script[data-absmartly-injected]')
      375 |       expect(scripts.length).toBe(1)
    > 376 |       expect(scripts[0].getAttribute('src')).toBe('test.js')
          |                                              ^
      377 |       expect(scripts[0].getAttribute('data-absmartly-injected')).toBe('headEnd')
      378 |     })
      379 |

      at Object.<anonymous> (src/sdk-bridge/__tests__/experiment/code-injector.test.ts:376:46)

  ● CodeInjector › executeScriptsInHTML › should preserve script async attribute

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: undefined

      384 |
      385 |       const scripts = document.head.querySelectorAll('script')
    > 386 |       expect(scripts[0].async).toBe(true)
          |                                ^
      387 |     })
      388 |
      389 |     it('should preserve script defer attribute', () => {

      at Object.<anonymous> (src/sdk-bridge/__tests__/experiment/code-injector.test.ts:386:32)

  ● CodeInjector › executeScriptsInHTML › should process multiple external scripts

    expect(received).toBe(expected) // Object.is equality

    Expected: "test1.js"
    Received: "http://localhost/test1.js"

      415 |       const scripts = document.body.querySelectorAll('script[data-absmartly-injected]')
      416 |       expect(scripts.length).toBe(2)
    > 417 |       expect(scripts[0].getAttribute('src')).toBe('test1.js')
          |                                              ^
      418 |       expect(scripts[1].getAttribute('src')).toBe('test2.js')
      419 |     })
      420 |

      at Object.<anonymous> (src/sdk-bridge/__tests__/experiment/code-injector.test.ts:417:46)

  ● CodeInjector › executeScriptsInHTML › should handle mixed inline and external scripts

    expect(received).toBe(expected) // Object.is equality

    Expected: "external.js"
    Received: "http://localhost/external.js"

      450 |       const scripts = document.head.querySelectorAll('script')
      451 |       expect(scripts.length).toBe(1) // Only external script
    > 452 |       expect(scripts[0].getAttribute('src')).toBe('external.js')
          |                                              ^
      453 |       expect(mockLogger.warn).toHaveBeenCalledWith(
      454 |         '[ABsmartly Extension] Inline script execution disabled for security from headEnd'
      455 |       )

      at Object.<anonymous> (src/sdk-bridge/__tests__/experiment/code-injector.test.ts:452:46)

  ● CodeInjector › matchesUrlFilter › should match simple string pattern

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      540 |
      541 |     it('should match simple string pattern', () => {
    > 542 |       expect(injector.matchesUrlFilter('/path/to/page')).toBe(true)
          |                                                          ^
      543 |     })
      544 |
      545 |     it('should not match different string pattern', () => {

      at Object.<anonymous> (src/sdk-bridge/__tests__/experiment/code-injector.test.ts:542:58)

  ● CodeInjector › matchesUrlFilter › should match wildcard pattern *

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      548 |
      549 |     it('should match wildcard pattern *', () => {
    > 550 |       expect(injector.matchesUrlFilter('/path/*')).toBe(true)
          |                                                    ^
      551 |     })
      552 |
      553 |     it('should match wildcard pattern ?', () => {

      at Object.<anonymous> (src/sdk-bridge/__tests__/experiment/code-injector.test.ts:550:52)

  ● CodeInjector › matchesUrlFilter › should match wildcard pattern ?

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      552 |
      553 |     it('should match wildcard pattern ?', () => {
    > 554 |       expect(injector.matchesUrlFilter('/path/to/pag?')).toBe(true)
          |                                                          ^
      555 |     })
      556 |
      557 |     it('should match array of patterns', () => {

      at Object.<anonymous> (src/sdk-bridge/__tests__/experiment/code-injector.test.ts:554:58)

  ● CodeInjector › matchesUrlFilter › should match array of patterns

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      556 |
      557 |     it('should match array of patterns', () => {
    > 558 |       expect(injector.matchesUrlFilter(['/wrong', '/path/to/page', '/also-wrong'])).toBe(true)
          |                                                                                     ^
      559 |     })
      560 |
      561 |     it('should not match when none in array match', () => {

      at Object.<anonymous> (src/sdk-bridge/__tests__/experiment/code-injector.test.ts:558:85)

  ● CodeInjector › matchesUrlFilter › should match include patterns

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      568 |           include: ['/path/*']
      569 |         })
    > 570 |       ).toBe(true)
          |         ^
      571 |     })
      572 |
      573 |     it('should exclude before include', () => {

      at Object.<anonymous> (src/sdk-bridge/__tests__/experiment/code-injector.test.ts:570:9)

  ● CodeInjector › matchesUrlFilter › should match regex pattern

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      586 |           mode: 'regex'
      587 |         })
    > 588 |       ).toBe(true)
          |         ^
      589 |     })
      590 |
      591 |     it('should handle invalid regex gracefully', () => {

      at Object.<anonymous> (src/sdk-bridge/__tests__/experiment/code-injector.test.ts:588:9)

  ● CodeInjector › matchesUrlFilter › should match full URL when matchType is full-url

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      609 |           matchType: 'full-url'
      610 |         })
    > 611 |       ).toBe(true)
          |         ^
      612 |     })
      613 |
      614 |     it('should match domain when matchType is domain', () => {

      at Object.<anonymous> (src/sdk-bridge/__tests__/experiment/code-injector.test.ts:611:9)

  ● CodeInjector › matchesUrlFilter › should match domain when matchType is domain

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      618 |           matchType: 'domain'
      619 |         })
    > 620 |       ).toBe(true)
          |         ^
      621 |     })
      622 |
      623 |     it('should match query when matchType is query', () => {

      at Object.<anonymous> (src/sdk-bridge/__tests__/experiment/code-injector.test.ts:620:9)

  ● CodeInjector › matchesUrlFilter › should match query when matchType is query

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      627 |           matchType: 'query'
      628 |         })
    > 629 |       ).toBe(true)
          |         ^
      630 |     })
      631 |
      632 |     it('should match hash when matchType is hash', () => {

      at Object.<anonymous> (src/sdk-bridge/__tests__/experiment/code-injector.test.ts:629:9)

  ● CodeInjector › matchesUrlFilter › should match hash when matchType is hash

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      636 |           matchType: 'hash'
      637 |         })
    > 638 |       ).toBe(true)
          |         ^
      639 |     })
      640 |
      641 |     it('should match path by default', () => {

      at Object.<anonymous> (src/sdk-bridge/__tests__/experiment/code-injector.test.ts:638:9)

  ● CodeInjector › matchesUrlFilter › should match path by default

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      644 |           include: ['/path/to/page']
      645 |         })
    > 646 |       ).toBe(true)
          |         ^
      647 |     })
      648 |
      649 |     it('should return true when no include patterns', () => {

      at Object.<anonymous> (src/sdk-bridge/__tests__/experiment/code-injector.test.ts:646:9)

tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/Location-impl.js:24:17)
        at LocationImpl.set href [as href] (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/Location-impl.js:46:10)
        at Location.set href [as href] (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/generated/Location.js:125:37)
        at Reflect.set (<anonymous>)
        at Window.set location [as location] (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/browser/Window.js:424:15)
        at Object.<anonymous> (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/src/sdk-bridge/__tests__/experiment/code-injector.test.ts:25:30)
        at Promise.finally.completed (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1557:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1497:10)
        at _callCircusHook (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:976:40)
        at processTicksAndRejections (node:internal/process/task_queues:105:5)
        at _runTest (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:941:5)
        at /Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:849:7
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:862:11)
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:857:11)
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:857:11)
        at run (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:761:3)
        at runAndTransformResultsToJestFormat (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1918:21)
        at jestAdapter (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/runner.js:101:19)
        at runTestInternal (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:275:16)
        at runTest (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:343:7)
        at Object.worker (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:497:12) {
      type: 'not implemented'
    }

      23 |     // Mock window.location
      24 |     delete (window as any).location
    > 25 |     ;(window as any).location = {
         |                              ^
      26 |       href: 'https://example.com/path/to/page?query=value#hash',
      27 |       pathname: '/path/to/page',
      28 |       hostname: 'example.com',

      at VirtualConsole.<anonymous> (node_modules/@jest/environment-jsdom-abstract/build/index.js:87:23)
          at Reflect.set (<anonymous>)
      at Object.<anonymous> (src/sdk-bridge/__tests__/experiment/code-injector.test.ts:25:30)

  console.error
    Error: Not implemented: navigation (except hash changes)
        at module.exports (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/browser/not-implemented.js:9:17)
        at navigateFetch (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/navigation.js:77:3)
        at exports.navigate (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/navigation.js:55:3)
        at LocationImpl._locationObjectNavigate (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/Location-impl.js:30:5)
        at LocationImpl._locationObjectSetterNavigate (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/Location-impl.js:24:17)
        at LocationImpl.set href [as href] (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/Location-impl.js:46:10)
        at Location.set href [as href] (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/generated/Location.js:125:37)
        at Reflect.set (<anonymous>)
        at Window.set location [as location] (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/browser/Window.js:424:15)
        at Object.<anonymous> (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/src/sdk-bridge/__tests__/experiment/code-injector.test.ts:25:30)
        at Promise.finally.completed (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1557:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1497:10)
        at _callCircusHook (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:976:40)
        at processTicksAndRejections (node:internal/process/task_queues:105:5)
        at _runTest (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:941:5)
        at /Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:849:7
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:862:11)
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:857:11)
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:857:11)
        at run (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:761:3)
        at runAndTransformResultsToJestFormat (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1918:21)
        at jestAdapter (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/runner.js:101:19)
        at runTestInternal (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:275:16)
        at runTest (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:343:7)
        at Object.worker (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:497:12) {
      type: 'not implemented'
    }

      23 |     // Mock window.location
      24 |     delete (window as any).location
    > 25 |     ;(window as any).location = {
         |                              ^
      26 |       href: 'https://example.com/path/to/page?query=value#hash',
      27 |       pathname: '/path/to/page',
      28 |       hostname: 'example.com',

      at VirtualConsole.<anonymous> (node_modules/@jest/environment-jsdom-abstract/build/index.js:87:23)
          at Reflect.set (<anonymous>)
      at Object.<anonymous> (src/sdk-bridge/__tests__/experiment/code-injector.test.ts:25:30)

  console.error
    Error: Not implemented: navigation (except hash changes)
        at module.exports (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_  console.log
    [handleMenuAction] Coordinator selectedElement: null

      at EditorCoordinator.handleMenuAction (src/visual-editor/core/editor-coordinator.ts:283:13)

  console.log
    [handleMenuAction] State selectedElement: HTMLSpanElement {}

      at EditorCoordinator.handleMenuAction (src/visual-editor/core/editor-coordinator.ts:284:13)

  console.log
    [handleMenuAction] Handling edit action for: HTMLDivElement {}

      at EditorCoordinator.handleMenuAction (src/visual-editor/core/editor-coordinator.ts:297:17)

  console.log
    [ABSmartly] Visual editor is now active!

      at VisualEditor.start (src/visual-editor/core/visual-editor.ts:184:13)

  console.log
    [EventsDebugPage] 🔵 Component mounted, fetching buffered events...

      at src/components/EventsDebugPage.tsx:33:13

  console.log
    [handleMenuAction] START - action: editHtml

      at EditorCoordinator.handleMenuAction (src/visual-editor/core/editor-coordinator.ts:280:13)

  console.log
    [EventsDebugPage] GET_BUFFERED_EVENTS response: { success: true, events: [] }

      at src/components/EventsDebugPage.tsx:39:15

  console.log
    [handleMenuAction] Received element: HTMLDivElement {}

      at EditorCoordinator.handleMenuAction (src/visual-editor/core/editor-coordinator.ts:281:13)

  console.log
    [EventsDebugPage] ✅ Loaded 0 buffered events

      at src/components/EventsDebugPage.tsx:41:17

  console.log
    [EventsDebugPage] ✅ Registered message listeners

      at src/components/EventsDebugPage.tsx:83:13

  console.log
    [handleMenuAction] Element details - tagName: DIV id: test-element className: test-class

      at EditorCoordinator.handleMenuAction (src/visual-editor/core/editor-coordinator.ts:282:13)

  console.log
    [handleMenuAction] Coordinator selectedElement: null

      at EditorCoordinator.handleMenuAction (src/visual-editor/core/editor-coordinator.ts:283:13)

  console.log
    [handleMenuAction] State selectedElement: HTMLSpanElement {}

      at EditorCoordinator.handleMenuAction (src/visual-editor/core/editor-coordinator.ts:284:13)

  console.log
    [handleMenuAction] START - action: edit-html

      at EditorCoordinator.handleMenuAction (src/visual-editor/core/editor-coordinator.ts:280:13)

  console.log
    [handleMenuAction] Received element: HTMLDivElement {}

      at EditorCoordinator.handleMenuAction (src/visual-editor/core/editor-coordinator.ts:281:13)

  console.log
    [handleMenuAction] Element details - tagName: DIV id: test-element className: test-class

      at EditorCoordinator.handleMenuAction (src/visual-editor/core/editor-coordinator.ts:282:13)

  console.log
    [handleMenuAction] Coordinator selectedElement: null

      at EditorCoordinator.handleMenuAction (src/visual-editor/core/editor-coordinator.ts:283:13)

  console.log
    [handleMenuAction] State selectedElement: HTMLSpanElement {}

      at EditorCoordinator.handleMenuAction (src/visual-editor/core/editor-coordinator.ts:284:13)

  console.log
    [EventsDebugPage] ❌ Removing message listeners

      at src/components/EventsDebugPage.tsx:88:15
          at Array.forEach (<anonymous>)

  console.log
    [handleMenuAction] START - action: rearrange

      at EditorCoordinator.handleMenuAction (src/visual-editor/core/editor-coordinator.ts:280:13)

  console.log
    [handleMenuAction] Received element: HTMLDivElement {}

      at EditorCoordinator.handleMenuAction (src/visual-editor/core/editor-coordinator.ts:281:13)

  console.log
    [handleMenuAction] Element details - tagName: DIV id: test-element className: test-class

      at EditorCoordinator.handleMenuAction (src/visual-editor/core/editor-coordinator.ts:282:13)

  console.log
    [handleMenuAction] Coordinator selectedElement: null

      at EditorCoordinator.handleMenuAction (src/visual-editor/core/editor-coordinator.ts:283:13)

  console.log
    [handleMenuAction] State selectedElement: HTMLSpanElement {}

      at EditorCoordinator.handleMenuAction (src/visual-editor/core/editor-coordinator.ts:284:13)

  console.log
    [VisualEditor] Constructor called with options: {
      variantName: 'test-variant',
      experimentName: 'test-experiment',
      logoUrl: 'https://example.com/logo.png',
      onChangesUpdate: [Function: mockConstructor] {
        _isMockFunction: true,
        getMockImplementation: [Function (anonymous)],
        mock: [Getter/Setter],
        mockClear: [Function (anonymous)],
        mockReset: [Function (anonymous)],
        mockRestore: [Function (anonymous)],
        mockReturnValueOnce: [Function (anonymous)],
        mockResolvedValueOnce: [Function (anonymous)],
        mockRejectedValueOnce: [Function (anonymous)],
        mockReturnValue: [Function (anonymous)],
        mockResolvedValue: [Function (anonymous)],
        mockRejectedValue: [Function (anonymous)],
        mockImplementationOnce: [Function (anonymous)],
        withImplementation: [Function: bound withImplementation],
        mockImplementation: [Function (anonymous)],
        mockReturnThis: [Function (anonymous)],
        mockName: [Function (anonymous)],
        getMockName: [Function (anonymous)],
        [Symbol(nodejs.dispose)]: [Function (anonymous)]
      },
      initialChanges: []
    }

      at new VisualEditor (src/visual-editor/core/visual-editor.ts:53:13)

  console.log
    [handleMenuAction] START - action: resize

      at EditorCoordinator.handleMenuAction (src/visual-editor/core/editor-coordinator.ts:280:13)

  console.log
    [handleMenuAction] Received element: HTMLDivElement {}

      at EditorCoordinator.handleMenuAction (src/visual-editor/core/editor-coordinator.ts:281:13)

  console.log
    [handleMenuAction] Element details - tagName: DIV id: test-element className: test-class

      at EditorCoordinator.handleMenuAction (src/visual-editor/core/editor-coordinator.ts:282:13)

  console.log
    [handleMenuAction] Coordinator selectedElement: null

      at EditorCoordinator.handleMenuAction (src/visual-editor/core/editor-coordinator.ts:283:13)

  console.log
    [handleMenuAction] State selectedElement: HTMLSpanElement {}

      at EditorCoordinator.handleMenuAction (src/visual-editor/core/editor-coordinator.ts:284:13)

  console.log
    [VisualEditor] Experiment name from options: test-experiment

      at new VisualEditor (src/visual-editor/core/visual-editor.ts:54:13)

  console.log
    [handleMenuAction] START - action: select-relative

      at EditorCoordinator.handleMenuAction (src/visual-editor/core/editor-coordinator.ts:280:13)

  console.log
    [ABSmartly] Starting unified visual editor - Version: 3.0-UNIFIED

      at VisualEditor.start (src/visual-editor/core/visual-editor.ts:144:13)

  console.log
    [ABSmartly] Build timestamp: 2025-10-17T15:42:21.604Z

      at VisualEditor.start (src/visual-editor/core/visual-editor.ts:145:13)

  console.log
    [ABSmartly] Starting visual editor

      at VisualEditor.start (src/visual-editor/core/visual-editor.ts:158:13)

  console.log
    [handleMenuAction] Received element: HTMLDivElement {}

      at EditorCoordinator.handleMenuAction (src/visual-editor/core/editor-coordinator.ts:281:13)

  console.log
    [ABSmartly] Preview header found, keeping it visible

      at VisualEditor.start (src/visual-editor/core/visual-editor.ts:168:15)

  console.log
    [handleMenuAction] Element details - tagName: DIV id: test-element className: test-class

      at EditorCoordinator.handleMenuAction (src/visual-editor/core/editor-coordinator.ts:282:13)

  console.log
    [ABSmartly] Visual editor banner created

      at VisualEditor.start (src/visual-editor/core/visual-editor.ts:180:13)

  console.log
    [handleMenuAction] Coordinator selectedElement: null

      at EditorCoordinator.handleMenuAction (src/visual-editor/core/editor-coordinator.ts:283:13)

  console.log
    [ABSmartly] Visual editor is now active!

      at VisualEditor.start (src/visual-editor/core/visual-editor.ts:184:13)

  console.log
    [handleMenuAction] State selectedElement: HTMLSpanElement {}

      at EditorCoordinator.handleMenuAction (src/visual-editor/core/editor-coordinator.ts:284:13)

  console.log
    [VisualEditor] Constructor called with options: {
      variantName: 'test-variant',
      experimentName: 'test-experiment',
      logoUrl: 'https://example.com/logo.png',
      onChangesUpdate: [Function: mockConstructor] {
        _isMockFunction: true,
        getMockImplementation: [Function (anonymous)],
        mock: [Getter/Setter],
        mockClear: [Function (anonymous)],
        mockReset: [Function (anonymous)],
        mockRestore: [Function (anonymous)],
        mockReturnValueOnce: [Function (anonymous)],
        mockResolvedValueOnce: [Function (anonymous)],
        mockRejectedValueOnce: [Function (anonymous)],
        mockReturnValue: [Function (anonymous)],
        mockResolvedValue: [Function (anonymous)],
        mockRejectedValue: [Function (anonymous)],
        mockImplementationOnce: [Function (anonymous)],
        withImplementation: [Function: bound withImplementation],
        mockImplementation: [Function (anonymous)],
        mockReturnThis: [Function (anonymous)],
        mockName: [Function (anonymous)],
        getMockName: [Function (anonymous)],
        [Symbol(nodejs.dispose)]: [Function (anonymous)]
      },
      initialChanges: []
    }

      at new VisualEditor (src/visual-editor/core/visual-editor.ts:53:13)

  console.log
    [handleMenuAction] Handling select-relative for element: HTMLDivElement {}

      at EditorCoordinator.handleMenuAction (src/visual-editor/core/editor-coordinator.ts:345:17)

  console.log
    [VisualEditor] Experiment name from options: test-experiment

      at new VisualEditor (src/visual-editor/core/visual-editor.ts:54:13)

  console.log
    [EventsDebugPage] 🔵 Component mounted, fetching buffered events...

      at src/components/EventsDebugPage.tsx:33:13

  console.log
    [ABSmartly] Starting unified visual editor - Version: 3.0-UNIFIED

      at VisualEditor.start (src/visual-editor/core/visual-editor.ts:144:13)

  console.log
    [handleMenuAction] START - action: selectRelative

      at EditorCoordinator.handleMenuAction (src/visual-editor/core/editor-coordinator.ts:280:13)

  console.log
    [ABSmartly] Build timestamp: 2025-10-17T15:42:21.641Z

      at VisualEditor.start (src/visual-editor/core/visual-editor.ts:145:13)

  console.log
    [ABSmartly] Starting visual editor

      at VisualEditor.start (src/visual-editor/core/visual-editor.ts:158:13)

  console.log
    [handleMenuAction] Received element: HTMLDivElement {}

      at EditorCoordinator.handleMenuAction (src/visual-editor/core/editor-coordinator.ts:281:13)

  console.log
    [handleMenuAction] Element details - tagName: DIV id: test-element className: test-class

      at EditorCoordinator.handleMenuAction (src/visual-editor/core/editor-coordinator.ts:282:13)

  console.log
    [EventsDebugPage] GET_BUFFERED_EVENTS response: { success: true, events: [] }

      at src/components/EventsDebugPage.tsx:39:15

  console.log
    [ABSmartly] Visual editor banner created

      at VisualEditor.start (src/visual-editor/core/visual-editor.ts:180:13)

  console.log
    [ABSmartly] Visual editor is now active!

      at VisualEditor.start (src/visual-editor/core/visual-editor.ts:184:13)

  console.log
    [EventsDebugPage] ✅ Loaded 0 buffered events

      at src/components/EventsDebugPage.tsx:41:17

  console.log
    [handleMenuAction] Coordinator selectedElement: null

      at EditorCoordinator.handleMenuAction (src/visual-editor/core/editor-coordinator.ts:283:13)

  console.log
    [EventsDebugPage] ✅ Registered message listeners

      at src/components/EventsDebugPage.tsx:83:13

  console.log
    [VisualEditor] Constructor called with options: {
      variantName: 'test-variant',
      experimentName: 'test-experiment',
      logoUrl: 'https://example.com/logo.png',
      onChangesUpdate: [Function: mockConstructor] {
        _isMockFunction: true,
        getMockImplementation: [Function (anonymous)],
        mock: [Getter/Setter],
        mockClear: [Function (anonymous)],
        mockReset: [Function (anonymous)],
        mockRestore: [Function (anonymous)],
        mockReturnValueOnce: [Function (anonymous)],
        mockResolvedValueOnce: [Function (anonymous)],
        mockRejectedValueOnce: [Function (anonymous)],
        mockReturnValue: [Function (anonymous)],
        mockResolvedValue: [Function (anonymous)],
        mockRejectedValue: [Function (anonymous)],
        mockImplementationOnce: [Function (anonymous)],
        withImplementation: [Function: bound withImplementation],
        mockImplementation: [Function (anonymous)],
        mockReturnThis: [Function (anonymous)],
        mockName: [Function (anonymous)],
        getMockName: [Function (anonymous)],
        [Symbol(nodejs.dispose)]: [Function (anonymous)]
      },
      initialChanges: []
    }

      at new VisualEditor (src/visual-editor/core/visual-editor.ts:53:13)

  console.log
    [VisualEditor] Experiment name from options: test-experiment

      at new VisualEditor (src/visual-editor/core/visual-editor.ts:54:13)

  console.log
    [handleMenuAction] State selectedElement: HTMLSpanElement {}

      at EditorCoordinator.handleMenuAction (src/visual-editor/core/editor-coordinator.ts:284:13)

  console.log
    [VisualEditor] Constructor called with options: {
      variantName: 'test-variant',
      experimentName: 'test-experiment',
      logoUrl: 'https://example.com/logo.png',
      onChangesUpdate: [Function: mockConstructor] {
        _isMockFunction: true,
        getMockImplementation: [Function (anonymous)],
        mock: [Getter/Setter],
        mockClear: [Function (anonymous)],
        mockReset: [Function (anonymous)],
        mockRestore: [Function (anonymous)],
        mockReturnValueOnce: [Function (anonymous)],
        mockResolvedValueOnce: [Function (anonymous)],
        mockRejectedValueOnce: [Function (anonymous)],
        mockReturnValue: [Function (anonymous)],
        mockResolvedValue: [Function (anonymous)],
        mockRejectedValue: [Function (anonymous)],
        mockImplementationOnce: [Function (anonymous)],
        withImplementation: [Function: bound withImplementation],
        mockImplementation: [Function (anonymous)],
        mockReturnThis: [Function (anonymous)],
        mockName: [Function (anonymous)],
        getMockName: [Function (anonymous)],
        [Symbol(nodejs.dispose)]: [Function (anonymous)]
      },
      initialChanges: []
    }

      at new VisualEditor (src/visual-editor/core/visual-editor.ts:53:13)

  console.log
    [VisualEditor] Experiment name from options: test-experiment

      at new VisualEditor (src/visual-editor/core/visual-editor.ts:54:13)

PASS src/visual-editor/ui/__tests__/image-source-dialog.test.ts
  ImageSourceDialog
    getCurrentImageSource
      ✓ should return src for img elements (3 ms)
      ✓ should extract URL from background-image (31 ms)
      ✓ should extract URL from background-image with double quotes (2 ms)
      ✓ should extract URL from background-image without quotes (8 ms)
      ✓ should return empty string for elements without images (3 ms)
      ✓ should return background-image string if URL cannot be extracted (31 ms)
    validateImageUrl
      ✓ should validate https URLs (1 ms)
      ✓ should validate http URLs
      ✓ should validate data URLs
      ✓ should validate absolute paths (1 ms)
      ✓ should reject empty strings (1 ms)
      ✓ should reject whitespace-only strings (1 ms)
      ✓ should reject invalid URLs (1 ms)
      ✓ should reject relative paths (1 ms)
    show
      ✓ should create dialog in DOM (23 ms)
      ✓ should pre-fill input with current source (36 ms)
      ✓ should return null when cancelled via backdrop (24 ms)
      ✓ should return null when cancelled via button (14 ms)
      ✓ should return new URL when applied with valid URL (16 ms)
      ✓ should show error for invalid URL (14 ms)
      ✓ should handle Enter key to apply (14 ms)
      ✓ should handle Escape key to cancel (16 ms)
      ✓ should hide error when user types (27 ms)
    remove
      ✓ should remove dialog from DOM (21 ms)
      ✓ should be safe to call multiple times

  console.log
    [handleMenuAction] Handling select-relative for element: HTMLDivElement {}

      at EditorCoordinator.handleMenuAction (src/visual-editor/core/editor-coordinator.ts:345:17)

  console.log
    [ABSmartly] Starting unified visual editor - Version: 3.0-UNIFIED

      at VisualEditor.start (src/visual-editor/core/visual-editor.ts:144:13)

  console.log
    [ABSmartly] Build timestamp: 2025-10-17T15:42:21.674Z

      at VisualEditor.start (src/visual-editor/core/visual-editor.ts:145:13)

  console.log
    [ABSmartly] Starting visual editor

      at VisualEditor.start (src/visual-editor/core/visual-editor.ts:158:13)

  console.log
    [ABSmartly] Visual editor banner created

      at VisualEditor.start (src/visual-editor/core/visual-editor.ts:180:13)

  console.log
    [ABSmartly] Visual editor is now active!

      at VisualEditor.start (src/visual-editor/core/visual-editor.ts:184:13)

  console.log
    [handleMenuAction] START - action: hide

      at EditorCoordinator.handleMenuAction (src/visual-editor/core/editor-coordinator.ts:280:13)

  console.log
    [handleMenuAction] Received element: HTMLDivElement {}

      at EditorCoordinator.handleMenuAction (src/visual-editor/core/editor-coordinator.ts:281:13)

  console.log
    [handleMenuAction] Element details - tagName: DIV id: test-element className: test-class

      at EditorCoordinator.handleMenuAction (src/visual-editor/core/editor-coordinator.ts:282:13)

  console.log
    [handleMenuAction] Coordinator selectedElement: null

      at EditorCoordinator.handleMenuAction (src/visual-editor/core/editor-coordinator.ts:283:13)

  console.log
    [handleMenuAction] State selectedElement: HTMLSpanElement {}

      at EditorCoordinator.handleMenuAction (src/visual-editor/core/editor-coordinator.ts:284:13)

  console.log
    
    🔧 SDK Configuration:

      at Object.<anonymous> (src/__tests__/sdk-api.test.ts:16:13)

  console.log
    [handleMenuAction] START - action: delete

      at EditorCoordinator.handleMenuAction (src/visual-editor/core/editor-coordinator.ts:280:13)

  console.log
    [handleMenuAction] Received element: HTMLDivElement {}

      at EditorCoordinator.handleMenuAction (src/visual-editor/core/editor-coordinator.ts:281:13)

  console.log
    [handleMenuAction] Element details - tagName: DIV id: test-element className: test-class

      at EditorCoordinator.handleMenuAction (src/visual-editor/core/editor-coordinator.ts:282:13)

  console.log
    API Endpoint: https://demo.absmartly.io

      at Object.<anonymous> (src/__tests__/sdk-api.test.ts:17:13)

  console.log
    API Key: test-dev-k...

      at Object.<anonymous> (src/__tests__/sdk-api.test.ts:18:13)

  console.log
    [handleMenuAction] Coordinator selectedElement: null

      at EditorCoordinator.handleMenuAction (src/visual-editor/core/editor-coordinator.ts:283:13)

  console.log
    [handleMenuAction] State selectedElement: HTMLSpanElement {}

      at EditorCoordinator.handleMenuAction (src/visual-editor/core/editor-coordinator.ts:284:13)

  console.log
    ✅ SDK instance created

      at Object.<anonymous> (src/__tests__/sdk-api.test.ts:42:13)

  console.log
    [handleMenuAction] START - action: copy

      at EditorCoordinator.handleMenuAction (src/visual-editor/core/editor-coordinator.ts:280:13)

  console.log
    [handleMenuAction] Received element: HTMLDivElement {}

      at EditorCoordinator.handleMenuAction (src/visual-editor/core/editor-coordinator.ts:281:13)

  console.log
    [handleMenuAction] Element details - tagName: DIV id: test-element className: test-class

      at EditorCoordinator.handleMenuAction (src/visual-editor/core/editor-coordinator.ts:282:13)

  console.log
    [ABSmartly] Stopping unified visual editor

      at VisualEditor.stop (src/visual-editor/core/visual-editor.ts:204:13)

  console.log
    [handleMenuAction] Coordinator selectedElement: null

      at EditorCoordinator.handleMenuAction (src/visual-editor/core/editor-coordinator.ts:283:13)

  console.log
    [handleMenuAction] State selectedElement: HTMLSpanElement {}

      at EditorCoordinator.handleMenuAction (src/visual-editor/core/editor-coordinator.ts:284:13)

  console.log
    [handleMenuAction] START - action: copy-selector

      at EditorCoordinator.handleMenuAction (src/visual-editor/core/editor-coordinator.ts:280:13)

  console.log
    [handleMenuAction] Received element: HTMLDivElement {}

      at EditorCoordinator.handleMenuAction (src/visual-editor/core/editor-coordinator.ts:281:13)

  console.log
    [handleMenuAction] Element details - tagName: DIV id: test-element className: test-class

      at EditorCoordinator.handleMenuAction (src/visual-editor/core/editor-coordinator.ts:282:13)

  console.error
    Trace: [ABSmartly] Stop called from:
        at VisualEditor.stop (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/src/visual-editor/core/visual-editor.ts:205:13)
        at Object.<anonymous> (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/src/visual-editor/core/__tests__/visual-editor.test.ts:350:14)
        at Promise.finally.completed (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1557:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1497:10)
        at _callCircusTest (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1007:40)
        at processTicksAndRejections (node:internal/process/task_queues:105:5)
        at _runTest (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:947:3)
        at /Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:849:7
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:862:11)
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:857:11)
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:857:11)
        at run (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:761:3)
        at runAndTransformResultsToJestFormat (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1918:21)
        at jestAdapter (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/runner.js:101:19)
        at runTestInternal (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:275:16)
        at runTest (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:343:7)
        at Object.worker (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:497:12)

      203 |
      204 |     console.log('[ABSmartly] Stopping unified visual editor')
    > 205 |     console.trace('[ABSmartly] Stop called from:')
          |             ^
      206 |
      207 |     this.isActive = false
      208 |     ;(window as any).__absmartlyVisualEditorActive = false

      at VisualEditor.stop (src/visual-editor/core/visual-editor.ts:205:13)
      at Object.<anonymous> (src/visual-editor/core/__tests__/visual-editor.test.ts:350:14)

  console.log
    [ABSmartly] Final changes on exit: 0

      at VisualEditor.stop (src/visual-editor/core/visual-editor.ts:212:13)

  console.log
    [ABSmartly] Changes were already saved

      at VisualEditor.stop (src/visual-editor/core/visual-editor.ts:221:15)

  console.log
    [ABSmartly] Teardown with restoreOriginalValues: false

      at VisualEditor.stop (src/visual-editor/core/visual-editor.ts:228:13)

  console.log
    [handleMenuAction] Coordinator selectedElement: null

      at EditorCoordinator.handleMenuAction (src/visual-editor/core/editor-coordinator.ts:283:13)

  console.log
    [VisualEditor] Constructor called with options: {
      variantName: 'test-variant',
      experimentName: 'test-experiment',
      logoUrl: 'https://example.com/logo.png',
      onChangesUpdate: [Function: mockConstructor] {
        _isMockFunction: true,
        getMockImplementation: [Function (anonymous)],
        mock: [Getter/Setter],
        mockClear: [Function (anonymous)],
        mockReset: [Function (anonymous)],
        mockRestore: [Function (anonymous)],
        mockReturnValueOnce: [Function (anonymous)],
        mockResolvedValueOnce: [Function (anonymous)],
        mockRejectedValueOnce: [Function (anonymous)],
        mockReturnValue: [Function (anonymous)],
        mockResolvedValue: [Function (anonymous)],
        mockRejectedValue: [Function (anonymous)],
        mockImplementationOnce: [Function (anonymous)],
        withImplementation: [Function: bound withImplementation],
        mockImplementation: [Function (anonymous)],
        mockReturnThis: [Function (anonymous)],
        mockName: [Function (anonymous)],
        getMockName: [Function (anonymous)],
        [Symbol(nodejs.dispose)]: [Function (anonymous)]
      },
      initialChanges: []
    }

      at new VisualEditor (src/visual-editor/core/visual-editor.ts:53:13)

  console.log
    [VisualEditor] Experiment name from options: test-experiment

      at new VisualEditor (src/visual-editor/core/visual-editor.ts:54:13)

  console.log
    [handleMenuAction] State selectedElement: HTMLSpanElement {}

      at EditorCoordinator.handleMenuAction (src/visual-editor/core/editor-coordinator.ts:284:13)

  console.log
    [ABSmartly] Starting unified visual editor - Version: 3.0-UNIFIED

      at VisualEditor.start (src/visual-editor/core/visual-editor.ts:144:13)

  console.log
    [ABSmartly] Build timestamp: 2025-10-17T15:42:21.717Z

      at VisualEditor.start (src/visual-editor/core/visual-editor.ts:145:13)

  console.log
    [ABSmartly] Starting visual editor

      at VisualEditor.start (src/visual-editor/core/visual-editor.ts:158:13)

  console.log
    [handleMenuAction] START - action: copySelector

      at EditorCoordinator.handleMenuAction (src/visual-editor/core/editor-coordinator.ts:280:13)

  console.log
    [handleMenuAction] Received element: HTMLDivElement {}

      at EditorCoordinator.handleMenuAction (src/visual-editor/core/editor-coordinator.ts:281:13)

  console.log
    [ABSmartly] Visual editor banner created

      at VisualEditor.start (src/visual-editor/core/visual-editor.ts:180:13)

  console.log
    [ABSmartly] Visual editor is now active!

      at VisualEditor.start (src/visual-editor/core/visual-editor.ts:184:13)

  console.log
    [handleMenuAction] Element details - tagName: DIV id: test-element className: test-class

      at EditorCoordinator.handleMenuAction (src/visual-editor/core/editor-coordinator.ts:282:13)

  console.log
    [ABSmartly] Stopping unified visual editor

      at VisualEditor.stop (src/visual-editor/core/visual-editor.ts:204:13)

  console.error
    Trace: [ABSmartly] Stop called from:
        at VisualEditor.stop (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/src/visual-editor/core/visual-editor.ts:205:13)
        at Object.<anonymous> (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/src/visual-editor/core/__tests__/visual-editor.test.ts:358:14)
        at Promise.finally.completed (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1557:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1497:10)
        at _callCircusTest (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1007:40)
        at processTicksAndRejections (node:internal/process/task_queues:105:5)
        at _runTest (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:947:3)
        at /Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:849:7
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:862:11)
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:857:11)
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:857:11)
        at run (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:761:3)
        at runAndTransformResultsToJestFormat (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1918:21)
        at jestAdapter (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/runner.js:101:19)
        at runTestInternal (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:275:16)
        at runTest (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:343:7)
        at Object.worker (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:497:12)

      203 |
      204 |     console.log('[ABSmartly] Stopping unified visual editor')
    > 205 |     console.trace('[ABSmartly] Stop called from:')
          |             ^
      206 |
      207 |     this.isActive = false
      208 |     ;(window as any).__absmartlyVisualEditorActive = false

      at VisualEditor.stop (src/visual-editor/core/visual-editor.ts:205:13)
      at Object.<anonymous> (src/visual-editor/core/__tests__/visual-editor.test.ts:358:14)

  console.log
    [EventsDebugPage] ❌ Removing message listeners

      at src/components/EventsDebugPage.tsx:88:15
          at Array.forEach (<anonymous>)

  console.log
    [ABSmartly] Final changes on exit: 0

      at VisualEditor.stop (src/visual-editor/core/visual-editor.ts:212:13)

  console.log
    [handleMenuAction] Coordinator selectedElement: null

      at EditorCoordinator.handleMenuAction (src/visual-editor/core/editor-coordinator.ts:283:13)

  console.log
    [ABSmartly] Changes were already saved

      at VisualEditor.stop (src/visual-editor/core/visual-editor.ts:221:15)

  console.log
    [ABSmartly] Teardown with restoreOriginalValues: false

      at VisualEditor.stop (src/visual-editor/core/visual-editor.ts:228:13)

  console.log
    [EventsDebugPage] 🔵 Component mounted, fetching buffered events...

      at src/components/EventsDebugPage.tsx:33:13

  console.log
    [handleMenuAction] START - action: editHtml

      at EditorCoordinator.handleMenuAction (src/visual-editor/core/editor-coordinator.ts:280:13)

  console.log
    [handleMenuAction] Received element: HTMLDivElement {}

      at EditorCoordinator.handleMenuAction (src/visual-editor/core/editor-coordinator.ts:281:13)

  console.log
    [EventsDebugPage] GET_BUFFERED_EVENTS response: { success: true, events: [] }

      at src/components/EventsDebugPage.tsx:39:15

  console.log
    [handleMenuAction] Element details - tagName: DIV id: test-element className:

      at EditorCoordinator.handleMenuAction (src/visual-editor/core/editor-coordinator.ts:282:13)

  console.log
    [handleMenuAction] Coordinator selectedElement: null

      at EditorCoordinator.handleMenuAction (src/visual-editor/core/editor-coordinator.ts:283:13)

  console.log
    [EventsDebugPage] ✅ Loaded 0 buffered events

      at src/components/EventsDebugPage.tsx:41:17

  console.log
    [handleMenuAction] State selectedElement: null

      at EditorCoordinator.handleMenuAction (src/visual-editor/core/editor-coordinator.ts:284:13)

  console.log
    [VisualEditor] Constructor called with options: {
      variantName: 'test-variant',
      experimentName: 'test-experiment',
      logoUrl: 'https://example.com/logo.png',
      onChangesUpdate: [Function: mockConstructor] {
        _isMockFunction: true,
        getMockImplementation: [Function (anonymous)],
        mock: [Getter/Setter],
        mockClear: [Function (anonymous)],
        mockReset: [Function (anonymous)],
        mockRestore: [Function (anonymous)],
        mockReturnValueOnce: [Function (anonymous)],
        mockResolvedValueOnce: [Function (anonymous)],
        mockRejectedValueOnce: [Function (anonymous)],
        mockReturnValue: [Function (anonymous)],
        mockResolvedValue: [Function (anonymous)],
        mockRejectedValue: [Function (anonymous)],
        mockImplementationOnce: [Function (anonymous)],
        withImplementation: [Function: bound withImplementation],
        mockImplementation: [Function (anonymous)],
        mockReturnThis: [Function (anonymous)],
        mockName: [Function (anonymous)],
        getMockName: [Function (anonymous)],
        [Symbol(nodejs.dispose)]: [Function (anonymous)]
      },
      initialChanges: []
    }

      at new VisualEditor (src/visual-editor/core/visual-editor.ts:53:13)

  console.log
    [VisualEditor] Experiment name from options: test-experiment

      at new VisualEditor (src/visual-editor/core/visual-editor.ts:54:13)

  console.log
    [ABSmartly] Starting unified visual editor - Version: 3.0-UNIFIED

      at VisualEditor.start (src/visual-editor/core/visual-editor.ts:144:13)

  console.log
    [ABSmartly] Build timestamp: 2025-10-17T15:42:21.744Z

      at VisualEditor.start (src/visual-editor/core/visual-editor.ts:145:13)

  console.log
    [ABSmartly] Starting visual editor

      at VisualEditor.start (src/visual-editor/core/visual-editor.ts:158:13)

  console.log
    [EventsDebugPage] ✅ Registered message listeners

      at src/components/EventsDebugPage.tsx:83:13

  console.log
    [ABSmartly] Visual editor banner created

      at VisualEditor.start (src/visual-editor/core/visual-editor.ts:180:13)

  console.log
    [ABSmartly] Visual editor is now active!

      at VisualEditor.start (src/visual-editor/core/visual-editor.ts:184:13)

  console.log
    [ABSmartly] Stopping unified visual editor

      at VisualEditor.stop (src/visual-editor/core/visual-editor.ts:204:13)

  console.error
    Trace: [ABSmartly] Stop called from:
        at VisualEditor.stop (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/src/visual-editor/core/visual-editor.ts:205:13)
        at Object.<anonymous> (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/src/visual-editor/core/__tests__/visual-editor.test.ts:372:14)
        at Promise.finally.completed (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1557:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1497:10)
        at _callCircusTest (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1007:40)
        at processTicksAndRejections (node:internal/process/task_queues:105:5)
        at _runTest (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:947:3)
        at /Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:849:7
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:862:11)
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:857:11)
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:857:11)
        at run (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:761:3)
        at runAndTransformResultsToJestFormat (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1918:21)
        at jestAdapter (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/runner.js:101:19)
        at runTestInternal (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:275:16)
        at runTest (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:343:7)
        at Object.worker (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:497:12)

      203 |
      204 |     console.log('[ABSmartly] Stopping unified visual editor')
    > 205 |     console.trace('[ABSmartly] Stop called from:')
          |             ^
      206 |
      207 |     this.isActive = false
      208 |     ;(window as any).__absmartlyVisualEditorActive = false

      at VisualEditor.stop (src/visual-editor/core/visual-editor.ts:205:13)
      at Object.<anonymous> (src/visual-editor/core/__tests__/visual-editor.test.ts:372:14)

  console.log
    [EventsDebugPage] 🔵 Received runtime message: SDK_EVENT_BROADCAST {
      type: 'SDK_EVENT_BROADCAST',
      payload: {
        eventName: 'ready',
        data: { experiments: [Array] },
        timestamp: '2025-10-17T15:42:21.755Z'
      }
    }

      at handleRuntimeMessage (src/components/EventsDebugPage.tsx:54:15)
          at Array.forEach (<anonymous>)

  console.log
    [handleMenuAction] State selectedElement: HTMLSpanElement {}

      at EditorCoordinator.handleMenuAction (src/visual-editor/core/editor-coordinator.ts:284:13)

  console.log
    [EventsDebugPage] ✅ SDK_EVENT_BROADCAST received, adding event: {
      eventName: 'ready',
      data: { experiments: [ 'exp1', 'exp2' ] },
      timestamp: '2025-10-17T15:42:21.755Z'
    }

      at handleRuntimeMessage (src/components/EventsDebugPage.tsx:57:19)
          at Array.forEach (<anonymous>)

  console.log
    [EventsDebugPage] Adding event to list. Current count: 0 New count: 1

      at src/components/EventsDebugPage.tsx:66:21

PASS src/__tests__/inject-sdk-plugin.test.ts
  inject-sdk-plugin.js - parseCookieOverrides
    basic functionality
      ✓ should return empty result for null/empty input (1 ms)
      ✓ should parse simple running experiments
      ✓ should parse development experiments with env flag
      ✓ should parse API fetch experiments with full format
    dev environment handling
      ✓ should parse dev environment prefix (1 ms)
      ✓ should handle URL encoded dev environment names
      ✓ should handle special characters in dev environment
      ✓ should handle empty dev environment
      ✓ should handle dev environment without experiments
    mixed formats
      ✓ should handle mixed experiment formats in same cookie
      ✓ should handle mixed formats with dev environment
    URL encoding and special characters
      ✓ should handle URL encoded experiment names (1 ms)
      ✓ should handle experiment names with special characters
      ✓ should handle Unicode characters in experiment names
    error handling and edge cases
      ✓ should skip malformed experiment entries
      ✓ should handle invalid numeric values (1 ms)
      ✓ should handle empty experiment segments
      ✓ should handle malformed dev environment segment (1 ms)
      ✓ should gracefully handle complete parsing failure
      ✓ should handle very long cookie values (3 ms)
      ✓ should handle zero values correctly
      ✓ should handle negative numbers (1 ms)
      ✓ should handle extra commas in values
    backward compatibility
      ✓ should maintain compatibility with old simple format
      ✓ should maintain compatibility with variant,env format
      ✓ should handle legacy format mixed with new format
    real-world scenarios
      ✓ should handle realistic production cookie
      ✓ should handle realistic development cookie with environment
      ✓ should handle cookie size near browser limits (1 ms)

  console.log
    [handleMenuAction] START - action: move-up

      at EditorCoordinator.handleMenuAction (src/visual-editor/core/editor-coordinator.ts:280:13)

  console.log
    [handleMenuAction] Received element: HTMLDivElement {}

      at EditorCoordinator.handleMenuAction (src/visual-editor/core/editor-coordinator.ts:281:13)

  console.log
    [handleMenuAction] Element details - tagName: DIV id: test-element className: test-class

      at EditorCoordinator.handleMenuAction (src/visual-editor/core/editor-coordinator.ts:282:13)

  console.log
    [handleMenuAction] Coordinator selectedElement: null

      at EditorCoordinator.handleMenuAction (src/visual-editor/core/editor-coordinator.ts:283:13)

  console.log
    [handleMenuAction] State selectedElement: HTMLSpanElement {}

      at EditorCoordinator.handleMenuAction (src/visual-editor/core/editor-coordinator.ts:284:13)

  console.log
    [handleMenuAction] START - action: move-down

      at EditorCoordinator.handleMenuAction (src/visual-editor/core/editor-coordinator.ts:280:13)

  console.log
    [handleMenuAction] Received element: HTMLDivElement {}

      at EditorCoordinator.handleMenuAction (src/visual-editor/core/editor-coordinator.ts:281:13)

PASS src/sdk-bridge/__tests__/dom/preview-manager.test.ts
  PreviewManager
    applyPreviewChange
      ✓ should return false for invalid change without selector (2 ms)
      ✓ should return false for invalid change without type (1 ms)
      ✓ should skip disabled changes (1 ms)
      ✓ should return false when no elements match selector (2 ms)
      ✓ should apply text change (2 ms)
      ✓ should apply HTML change (1 ms)
      ✓ should sanitize HTML during change (2 ms)
      ✓ should apply style change with object (1 ms)
      ✓ should apply style change with string (2 ms)
      ✓ should apply class change (2 ms)
      ✓ should apply attribute change (1 ms)
      ✓ should apply delete change by hiding (1 ms)
      ✓ should store original state before applying change (2 ms)
      ✓ should apply changes to multiple elements (6 ms)
      ✓ should not reapply changes to already tracked elements (1 ms)
    removePreviewChanges
      ✓ should restore element to original state (4 ms)
      ✓ should remove tracking attributes (3 ms)
      ✓ should not affect elements from other experiments (1 ms)
      ✓ should return false when no elements were restored (1 ms)
      ✓ should restore elements with __preview__ marker (1 ms)
      ✓ should restore elements from data-absmartly-original attribute (2 ms)
      ✓ should handle invalid JSON in data-absmartly-original gracefully (4 ms)
      ✓ should restore complete element state (3 ms)
    clearAll
      ✓ should remove all preview changes (98 ms)
    getPreviewCount
      ✓ should return 0 initially (1 ms)
      ✓ should return correct count after applying changes (1 ms)
      ✓ should return correct count after removing changes (8 ms)
    integration scenarios
      ✓ should handle complete preview lifecycle (4 ms)
      ✓ should handle multiple changes to same element (2 ms)
      ✓ should handle overlapping experiments (1 ms)

  console.log
    [handleMenuAction] Element details - tagName: DIV id: test-element className: test-class

      at EditorCoordinator.handleMenuAction (src/visual-editor/core/editor-coordinator.ts:282:13)

  console.log
    [EventsDebugPage] ❌ Removing message listeners

      at src/components/EventsDebugPage.tsx:88:15
          at Array.forEach (<anonymous>)

  console.log
    [handleMenuAction] Coordinator selectedElement: null

      at EditorCoordinator.handleMenuAction (src/visual-editor/core/editor-coordinator.ts:283:13)

  console.log
    [handleMenuAction] State selectedElement: HTMLSpanElement {}

      at EditorCoordinator.handleMenuAction (src/visual-editor/core/editor-coordinator.ts:284:13)

  console.log
    [handleMenuAction] START - action: insert-block

      at EditorCoordinator.handleMenuAction (src/visual-editor/core/editor-coordinator.ts:280:13)

  console.log
    [handleMenuAction] Received element: HTMLDivElement {}

      at EditorCoordinator.handleMenuAction (src/visual-editor/core/editor-coordinator.ts:281:13)

  console.log
    [handleMenuAction] Element details - tagName: DIV id: test-element className: test-class

      at EditorCoordinator.handleMenuAction (src/visual-editor/core/editor-coordinator.ts:282:13)

  console.log
    [ABSmartly] Final changes on exit: 0

      at VisualEditor.stop (src/visual-editor/core/visual-editor.ts:212:13)

  console.log
    [handleEditAction] START for element: HTMLDivElement {}

      at EditorCoordinator.handleEditAction (src/visual-editor/core/editor-coordinator.ts:360:13)

  console.log
    [handleMenuAction] Coordinator selectedElement: null

      at EditorCoordinator.handleMenuAction (src/visual-editor/core/editor-coordinator.ts:283:13)

  console.log
    [handleMenuAction] State selectedElement: HTMLSpanElement {}

      at EditorCoordinator.handleMenuAction (src/visual-editor/core/editor-coordinator.ts:284:13)

  console.log
    [handleEditAction] Element details: DIV test-element

      at EditorCoordinator.handleEditAction (src/visual-editor/core/editor-coordinator.ts:361:13)

PASS src/visual-editor/core/__tests__/state-manager.test.ts
  StateManager
    Constructor and Initial State
      ✓ should initialize with correct default state (2 ms)
      ✓ should initialize with initial changes from config
      ✓ should store config correctly (1 ms)
    State Getters
      ✓ should return immutable state copy
      ✓ should return immutable config copy
    State Updates
      ✓ should update state with partial updates (1 ms)
      ✓ should replace entire state with setState
      ✓ should maintain immutability during updates (1 ms)
    State Change Listeners
      ✓ should notify listeners on state changes (1 ms)
      ✓ should return unsubscribe function (1 ms)
      ✓ should handle multiple unsubscribes safely (2 ms)
      ✓ should not notify on setState calls
    Element Selection and Hover
      ✓ should set selected element
      ✓ should clear selected element (1 ms)
      ✓ should set hovered element
      ✓ should clear hovered element
      ✓ should handle same element for selected and hovered
    Changes Management
      ✓ should add change to empty changes array
      ✓ should add multiple changes (1 ms)
      ✓ should maintain immutability when adding changes (1 ms)
      ✓ should set changes array
      ✓ should replace existing changes when setting (1 ms)
    Undo/Redo Stack Management
      Undo Stack
        ✓ should push action to undo stack (1 ms)
        ✓ should push multiple actions to undo stack
        ✓ should clear redo stack when pushing to undo stack (1 ms)
        ✓ should pop action from undo stack
        ✓ should return null when popping from empty undo stack (1 ms)
        ✓ should maintain immutability of undo stack (1 ms)
      Redo Stack
        ✓ should push action to redo stack (2 ms)
        ✓ should push multiple actions to redo stack (1 ms)
        ✓ should pop action from redo stack (1 ms)
        ✓ should return null when popping from empty redo stack (3 ms)
        ✓ should maintain immutability of redo stack (1 ms)
    Original Values Management
      ✓ should set original value
      ✓ should get original value (1 ms)
      ✓ should return undefined for non-existent key (1 ms)
      ✓ should overwrite existing original value (1 ms)
      ✓ should handle different data types as values
    Mode State Management
      ✓ should allow both rearranging and resizing to be true simultaneously
      Rearranging Mode
        ✓ should set rearranging mode to true (1 ms)
        ✓ should set rearranging mode to false
        ✓ should notify listeners when rearranging mode changes
      Resizing Mode
        ✓ should set resizing mode to true (1 ms)
        ✓ should set resizing mode to false (1 ms)
        ✓ should notify listeners when resizing mode changes
    Dragged Element Management
      ✓ should set dragged element (1 ms)
      ✓ should clear dragged element (1 ms)
      ✓ should notify listeners when dragged element changes
      ✓ should handle setting same element multiple times (1 ms)
    Deactivation
      ✓ should deactivate the state manager
      ✓ should notify listeners when deactivated (2 ms)
      ✓ should allow multiple deactivation calls (1 ms)
    Complex State Transitions
      ✓ should handle editing workflow: select element, start resizing, make changes (3 ms)
      ✓ should handle drag and drop workflow (2 ms)
      ✓ should handle undo/redo workflow (1 ms)
    Concurrent State Updates
      ✓ should handle rapid sequential updates (42 ms)
      ✓ should maintain state consistency with batch updates (7 ms)
    Edge Cases
      ✓ should handle null and undefined values gracefully (3 ms)
      ✓ should handle empty changes array operations (25 ms)
      ✓ should handle setting original values with special keys (1 ms)
      ✓ should handle large undo/redo stacks (109 ms)
      ✓ should handle many state change listeners (28 ms)
      ✓ should handle state reset to initial values (3 ms)
    Memory and Performance
      ✓ should not leak memory with listeners (2 ms)
      ✓ should handle complex objects in state (shallow immutability) (1 ms)

  console.log
    [handleMenuAction] START - action: edit

      at EditorCoordinator.handleMenuAction (src/visual-editor/core/editor-coordinator.ts:280:13)

  console.log
    [handleMenuAction] Received element: HTMLDivElement {}

      at EditorCoordinator.handleMenuAction (src/visual-editor/core/editor-coordinator.ts:281:13)

  console.log
    [ABSmartly] Changes were already saved

      at VisualEditor.stop (src/visual-editor/core/visual-editor.ts:221:15)

  console.log
    [handleMenuAction] Element details - tagName: DIV id: test-element className: test-class

      at EditorCoordinator.handleMenuAction (src/visual-editor/core/editor-coordinator.ts:282:13)

  console.log
    [handleMenuAction] Coordinator selectedElement: null

      at EditorCoordinator.handleMenuAction (src/visual-editor/core/editor-coordinator.ts:283:13)

  console.log
    [handleMenuAction] State selectedElement: HTMLSpanElement {}

      at EditorCoordinator.handleMenuAction (src/visual-editor/core/editor-coordinator.ts:284:13)

  console.log
    [handleMenuAction] Handling edit action for: HTMLDivElement {}

      at EditorCoordinator.handleMenuAction (src/visual-editor/core/editor-coordinator.ts:297:17)

  console.log
    [ABSmartly] Teardown with restoreOriginalValues: false

      at VisualEditor.stop (src/visual-editor/core/visual-editor.ts:228:13)

  console.log
    [ABsmartly] saveOverrides called with: { experiment1: 1, experiment2: { variant: 2, env: 1 } }

      at saveOverrides (src/utils/overrides.ts:215:13)

  console.log
    [handleEditAction] START for element: HTMLDivElement {}

      at EditorCoordinator.handleEditAction (src/visual-editor/core/editor-coordinator.ts:360:13)

  console.log
    [ABsmartly] Cleaned overrides: { experiment1: 1, experiment2: { variant: 2, env: 1 } }

      at saveOverrides (src/utils/overrides.ts:225:13)

  console.log
    ✅ Context created successfully

      at Object.<anonymous> (src/__tests__/sdk-api.test.ts:64:15)

  console.log
    Has data: true

      at Object.<anonymous> (src/__tests__/sdk-api.test.ts:68:15)

  console.log
    Experiments available: 0

      at Object.<anonymous> (src/__tests__/sdk-api.test.ts:72:17)

  console.log
    [handleEditAction] Element details: DIV test-element test-class

      at EditorCoordinator.handleEditAction (src/visual-editor/core/editor-coordinator.ts:361:13)

  console.log
    [handleEditAction] START for element: HTMLDivElement {}

      at EditorCoordinator.handleEditAction (src/visual-editor/core/editor-coordinator.ts:360:13)

  console.log
    [VisualEditor] Constructor called with options: {
      variantName: 'test-variant',
      experimentName: 'test-experiment',
      logoUrl: 'https://example.com/logo.png',
      onChangesUpdate: [Function: mockConstructor] {
        _isMockFunction: true,
        getMockImplementation: [Function (anonymous)],
        mock: [Getter/Setter],
        mockClear: [Function (anonymous)],
        mockReset: [Function (anonymous)],
        mockRestore: [Function (anonymous)],
        mockReturnValueOnce: [Function (anonymous)],
        mockResolvedValueOnce: [Function (anonymous)],
        mockRejectedValueOnce: [Function (anonymous)],
        mockReturnValue: [Function (anonymous)],
        mockResolvedValue: [Function (anonymous)],
        mockRejectedValue: [Function (anonymous)],
        mockImplementationOnce: [Function (anonymous)],
        withImplementation: [Function: bound withImplementation],
        mockImplementation: [Function (anonymous)],
        mockReturnThis: [Function (anonymous)],
        mockName: [Function (anonymous)],
        getMockName: [Function (anonymous)],
        [Symbol(nodejs.dispose)]: [Function (anonymous)]
      },
      initialChanges: []
    }

      at new VisualEditor (src/visual-editor/core/visual-editor.ts:53:13)

  console.log
    [handleEditAction] Element details: DIV test-element test-class

      at EditorCoordinator.handleEditAction (src/visual-editor/core/editor-coordinator.ts:361:13)

  console.log
    [VisualEditor] Experiment name from options: test-experiment

      at new VisualEditor (src/visual-editor/core/visual-editor.ts:54:13)

  console.log
    [ABSmartly] Starting unified visual editor - Version: 3.0-UNIFIED

      at VisualEditor.start (src/visual-editor/core/visual-editor.ts:144:13)

  console.log
    [ABSmartly] Build timestamp: 2025-10-17T15:42:21.860Z

      at VisualEditor.start (src/visual-editor/core/visual-editor.ts:145:13)

  console.log
    [ABSmartly] Starting visual editor

      at VisualEditor.start (src/visual-editor/core/visual-editor.ts:158:13)

  console.log
    [ABSmartly] Visual editor banner created

      at VisualEditor.start (src/visual-editor/core/visual-editor.ts:180:13)

  console.log
    [ABSmartly] Visual editor is now active!

      at VisualEditor.start (src/visual-editor/core/visual-editor.ts:184:13)

  console.log
    [ABSmartly] Stopping unified visual editor

      at VisualEditor.stop (src/visual-editor/core/visual-editor.ts:204:13)

  console.error
    Trace: [ABSmartly] Stop called from:
        at VisualEditor.stop (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/src/visual-editor/core/visual-editor.ts:205:13)
        at Object.<anonymous> (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/src/visual-editor/core/__tests__/visual-editor.test.ts:382:14)
        at Promise.finally.completed (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1557:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1497:10)
        at _callCircusTest (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1007:40)
        at processTicksAndRejections (node:internal/process/task_queues:105:5)
        at _runTest (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:947:3)
        at /Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:849:7
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:862:11)
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:857:11)
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:857:11)
        at run (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:761:3)
        at runAndTransformResultsToJestFormat (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1918:21)
        at jestAdapter (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/runner.js:101:19)
        at runTestInternal (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:275:16)
        at runTest (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:343:7)
        at Object.worker (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:497:12)

      203 |
      204 |     console.log('[ABSmartly] Stopping unified visual editor')
    > 205 |     console.trace('[ABSmartly] Stop called from:')
          |             ^
      206 |
      207 |     this.isActive = false
      208 |     ;(window as any).__absmartlyVisualEditorActive = false

      at VisualEditor.stop (src/visual-editor/core/visual-editor.ts:205:13)
      at Object.<anonymous> (src/visual-editor/core/__tests__/visual-editor.test.ts:382:14)

  console.log
    [ABSmartly] Final changes on exit: 0

      at VisualEditor.stop (src/visual-editor/core/visual-editor.ts:212:13)

  console.log
    [ABSmartly] Changes were already saved

      at VisualEditor.stop (src/visual-editor/core/visual-editor.ts:221:15)

  console.log
    [ABSmartly] Teardown with restoreOriginalValues: false

      at VisualEditor.stop (src/visual-editor/core/visual-editor.ts:228:13)

  console.log
    [VisualEditor] Constructor called with options: {
      variantName: 'test-variant',
      experimentName: 'test-experiment',
      logoUrl: 'https://example.com/logo.png',
      onChangesUpdate: [Function: mockConstructor] {
        _isMockFunction: true,
        getMockImplementation: [Function (anonymous)],
        mock: [Getter/Setter],
        mockClear: [Function (anonymous)],
        mockReset: [Function (anonymous)],
        mockRestore: [Function (anonymous)],
        mockReturnValueOnce: [Function (anonymous)],
        mockResolvedValueOnce: [Function (anonymous)],
        mockRejectedValueOnce: [Function (anonymous)],
        mockReturnValue: [Function (anonymous)],
        mockResolvedValue: [Function (anonymous)],
        mockRejectedValue: [Function (anonymous)],
        mockImplementationOnce: [Function (anonymous)],
        withImplementation: [Function: bound withImplementation],
        mockImplementation: [Function (anonymous)],
        mockReturnThis: [Function (anonymous)],
        mockName: [Function (anonymous)],
        getMockName: [Function (anonymous)],
        [Symbol(nodejs.dispose)]: [Function (anonymous)]
      },
      initialChanges: []
    }

      at new VisualEditor (src/visual-editor/core/visual-editor.ts:53:13)

  console.log
    [VisualEditor] Experiment name from options: test-experiment

      at new VisualEditor (src/visual-editor/core/visual-editor.ts:54:13)

  console.log
    [EventsDebugPage] 🔵 Component mounted, fetching buffered events...

      at src/components/EventsDebugPage.tsx:33:13

  console.log
    [ABSmartly] Starting unified visual editor - Version: 3.0-UNIFIED

      at VisualEditor.start (src/visual-editor/core/visual-editor.ts:144:13)

PASS src/visual-editor/core/__tests__/editor-coordinator-html.test.ts
  EditorCoordinator HTML Editor Integration
    handleEditHtmlAction
      ✓ should initialize HTML editor when Edit HTML action is triggered (31 ms)
      ✓ should update element HTML when changes are saved (7 ms)
      ✓ should not update element when editor is cancelled (3 ms)
      ✓ should track HTML changes in state (5 ms)
      ✓ should show success notification after HTML update (1 ms)
      ✓ should remove context menu before opening editor (3 ms)
      ✓ should handle complex HTML structures (31 ms)
      ✓ should update element HTML content (4 ms)
      ✓ should not update if new HTML is same as current (61 ms)
      ✓ should handle editor errors gracefully (31 ms)
    Context Menu Integration
      ✓ should handle Edit HTML menu action (153 ms)
      ✓ should pass correct original state to HTML editor (27 ms)
    Multiple Edit Actions
      ✓ should handle sequential HTML edits (36 ms)
      ✓ should handle switching between text and HTML editing (24 ms)
    State Management
      ✓ should track HTML changes in visual editor state (7 ms)
      ✓ should use correct selector for HTML changes (17 ms)

  console.log
    [ABSmartly] Build timestamp: 2025-10-17T15:42:21.868Z

      at VisualEditor.start (src/visual-editor/core/visual-editor.ts:145:13)

  console.log
    [ABSmartly] Starting visual editor

      at VisualEditor.start (src/visual-editor/core/visual-editor.ts:158:13)

  console.log
    [ABSmartly] Visual editor banner created

      at VisualEditor.start (src/visual-editor/core/visual-editor.ts:180:13)

  console.log
    [ABSmartly] Visual editor is now active!

      at VisualEditor.start (src/visual-editor/core/visual-editor.ts:184:13)

  console.log
    [ABSmartly] Stopping unified visual editor

      at VisualEditor.stop (src/visual-editor/core/visual-editor.ts:204:13)

  console.error
    Trace: [ABSmartly] Stop called from:
        at VisualEditor.stop (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/src/visual-editor/core/visual-editor.ts:205:13)
        at Object.<anonymous> (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/src/visual-editor/core/__tests__/visual-editor.test.ts:401:14)
        at Promise.finally.completed (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1557:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1497:10)
        at _callCircusTest (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1007:40)
        at processTicksAndRejections (node:internal/process/task_queues:105:5)
        at _runTest (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:947:3)
        at /Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:849:7
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:862:11)
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:857:11)
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:857:11)
        at run (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:761:3)
        at runAndTransformResultsToJestFormat (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1918:21)
        at jestAdapter (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/runner.js:101:19)
        at runTestInternal (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:275:16)
        at runTest (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:343:7)
        at Object.worker (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:497:12)

      203 |
      204 |     console.log('[ABSmartly] Stopping unified visual editor')
    > 205 |     console.trace('[ABSmartly] Stop called from:')
          |             ^
      206 |
      207 |     this.isActive = false
      208 |     ;(window as any).__absmartlyVisualEditorActive = false

      at VisualEditor.stop (src/visual-editor/core/visual-editor.ts:205:13)
      at Object.<anonymous> (src/visual-editor/core/__tests__/visual-editor.test.ts:401:14)

  console.log
    [ABSmartly] Final changes on exit: 0

      at VisualEditor.stop (src/visual-editor/core/visual-editor.ts:212:13)

  console.log
    [EventsDebugPage] GET_BUFFERED_EVENTS response: { success: true, events: [] }

      at src/components/EventsDebugPage.tsx:39:15

  console.log
    [ABSmartly] Discarding unsaved changes on exit

      at VisualEditor.stop (src/visual-editor/core/visual-editor.ts:217:15)

  console.log
    [ABSmartly] Teardown with restoreOriginalValues: true

      at VisualEditor.stop (src/visual-editor/core/visual-editor.ts:228:13)

  console.log
    [EventsDebugPage] ✅ Loaded 0 buffered events

      at src/components/EventsDebugPage.tsx:41:17

  console.log
    [EventsDebugPage] ✅ Registered message listeners

      at src/components/EventsDebugPage.tsx:83:13

  console.log
    [VisualEditor] Constructor called with options: {
      variantName: 'test-variant',
      experimentName: 'test-experiment',
      logoUrl: 'https://example.com/logo.png',
      onChangesUpdate: [Function: mockConstructor] {
        _isMockFunction: true,
        getMockImplementation: [Function (anonymous)],
        mock: [Getter/Setter],
        mockClear: [Function (anonymous)],
        mockReset: [Function (anonymous)],
        mockRestore: [Function (anonymous)],
        mockReturnValueOnce: [Function (anonymous)],
        mockResolvedValueOnce: [Function (anonymous)],
        mockRejectedValueOnce: [Function (anonymous)],
        mockReturnValue: [Function (anonymous)],
        mockResolvedValue: [Function (anonymous)],
        mockRejectedValue: [Function (anonymous)],
        mockImplementationOnce: [Function (anonymous)],
        withImplementation: [Function: bound withImplementation],
        mockImplementation: [Function (anonymous)],
        mockReturnThis: [Function (anonymous)],
        mockName: [Function (anonymous)],
        getMockName: [Function (anonymous)],
        [Symbol(nodejs.dispose)]: [Function (anonymous)]
      },
      initialChanges: []
    }

      at new VisualEditor (src/visual-editor/core/visual-editor.ts:53:13)

  console.log
    [VisualEditor] Experiment name from options: test-experiment

      at new VisualEditor (src/visual-editor/core/visual-editor.ts:54:13)

  console.log
    [ABSmartly] Starting unified visual editor - Version: 3.0-UNIFIED

      at VisualEditor.start (src/visual-editor/core/visual-editor.ts:144:13)

  console.log
    [ABSmartly] Build timestamp: 2025-10-17T15:42:21.879Z

      at VisualEditor.start (src/visual-editor/core/visual-editor.ts:145:13)

  console.log
    [EventsDebugPage] 🔵 Received window message: SDK_EVENT_BROADCAST {
      source: 'absmartly-extension-incoming',
      type: 'SDK_EVENT_BROADCAST',
      payload: {
        eventName: 'ready',
        data: { experiments: [Array] },
        timestamp: '2025-10-17T15:42:21.878Z'
      }
    }

      at handleWindowMessage (src/components/EventsDebugPage.tsx:78:17)

  console.log
    [ABSmartly] Starting visual editor

      at VisualEditor.start (src/visual-editor/core/visual-editor.ts:158:13)

  console.log
    [EventsDebugPage] 🔵 Received runtime message: SDK_EVENT_BROADCAST {
      source: 'absmartly-extension-incoming',
      type: 'SDK_EVENT_BROADCAST',
      payload: {
        eventName: 'ready',
        data: { experiments: [Array] },
        timestamp: '2025-10-17T15:42:21.878Z'
      }
    }

      at handleRuntimeMessage (src/components/EventsDebugPage.tsx:54:15)

  console.log
    [ABSmartly] Visual editor banner created

      at VisualEditor.start (src/visual-editor/core/visual-editor.ts:180:13)

  console.log
    [EventsDebugPage] ✅ SDK_EVENT_BROADCAST received, adding event: {
      eventName: 'ready',
      data: { experiments: [ 'exp1', 'exp2' ] },
      timestamp: '2025-10-17T15:42:21.878Z'
    }

      at handleRuntimeMessage (src/components/EventsDebugPage.tsx:57:19)

  console.log
    [ABSmartly] Visual editor is now active!

      at VisualEditor.start (src/visual-editor/core/visual-editor.ts:184:13)

  console.log
    [EventsDebugPage] Adding event to list. Current count: 0 New count: 1

      at src/components/EventsDebugPage.tsx:66:21

  console.log
    [ABSmartly] Stopping unified visual editor

      at VisualEditor.stop (src/visual-editor/core/visual-editor.ts:204:13)

  console.log
    [handleEditAction] START for element: HTMLDivElement {}

      at EditorCoordinator.handleEditAction (src/visual-editor/core/editor-coordinator.ts:360:13)

  console.log
    [EventsDebugPage] ❌ Removing message listeners

      at src/components/EventsDebugPage.tsx:88:15
          at Array.forEach (<anonymous>)

  console.log
    [EventsDebugPage] 🔵 Component mounted, fetching buffered events...

      at src/components/EventsDebugPage.tsx:33:13

  console.log
    [handleEditAction] Element details: DIV test-element test-class

      at EditorCoordinator.handleEditAction (src/visual-editor/core/editor-coordinator.ts:361:13)

  console.log
    [EventsDebugPage] GET_BUFFERED_EVENTS response: { success: true, events: [] }

      at src/components/EventsDebugPage.tsx:39:15

  console.log
    [EventsDebugPage] ✅ Loaded 0 buffered events

      at src/components/EventsDebugPage.tsx:41:17

  console.error
    Trace: [ABSmartly] Stop called from:
        at VisualEditor.stop (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/src/visual-editor/core/visual-editor.ts:205:13)
        at VisualEditor.<anonymous> (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-mock/build/index.js:631:25)
        at /Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-mock/build/index.js:305:39
        at VisualEditor.<anonymous> (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-mock/build/index.js:312:13)
        at VisualEditor.mockConstructor [as stop] (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-mock/build/index.js:102:19)
        at VisualEditor.destroy (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/src/visual-editor/core/visual-editor.ts:242:10)
        at Object.<anonymous> (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/src/visual-editor/core/__tests__/visual-editor.test.ts:418:14)
        at Promise.finally.completed (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1557:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1497:10)
        at _callCircusTest (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1007:40)
        at processTicksAndRejections (node:internal/process/task_queues:105:5)
        at _runTest (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:947:3)
        at /Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:849:7
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:862:11)
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:857:11)
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:857:11)
        at run (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:761:3)
        at runAndTransformResultsToJestFormat (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1918:21)
        at jestAdapter (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/runner.js:101:19)
        at runTestInternal (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:275:16)
        at runTest (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:343:7)
        at Object.worker (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:497:12)

      203 |
      204 |     console.log('[ABSmartly] Stopping unified visual editor')
    > 205 |     console.trace('[ABSmartly] Stop called from:')
          |             ^
      206 |
      207 |     this.isActive = false
      208 |     ;(window as any).__absmartlyVisualEditorActive = false

      at VisualEditor.stop (src/visual-editor/core/visual-editor.ts:205:13)
      at VisualEditor.destroy (src/visual-editor/core/visual-editor.ts:242:10)
      at Object.<anonymous> (src/visual-editor/core/__tests__/visual-editor.test.ts:418:14)

  console.log
    [ABSmartly] Final changes on exit: 0

      at VisualEditor.stop (src/visual-editor/core/visual-editor.ts:212:13)

  console.log
    [EventsDebugPage] ✅ Registered message listeners

      at src/components/EventsDebugPage.tsx:83:13

  console.log
    [ABSmartly] Changes were already saved

      at VisualEditor.stop (src/visual-editor/core/visual-editor.ts:221:15)

  console.log
    [EventsDebugPage] 🔵 Received runtime message: SDK_EVENT_BROADCAST {
      type: 'SDK_EVENT_BROADCAST',
      payload: {
        eventName: 'ready',
        data: null,
        timestamp: '2025-01-01T10:00:00.000Z'
      }
    }

      at handleRuntimeMessage (src/components/EventsDebugPage.tsx:54:15)
          at Array.forEach (<anonymous>)

  console.log
    [ABSmartly] Teardown with restoreOriginalValues: false

      at VisualEditor.stop (src/visual-editor/core/visual-editor.ts:228:13)

  console.log
    [handleEditAction] START for element: HTMLDivElement {}

      at EditorCoordinator.handleEditAction (src/visual-editor/core/editor-coordinator.ts:360:13)

  console.log
    [handleEditAction] Element details: DIV test-element test-class

      at EditorCoordinator.handleEditAction (src/visual-editor/core/editor-coordinator.ts:361:13)

modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/browser/not-implemented.js:9:17)
        at navigateFetch (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/navigation.js:77:3)
        at exports.navigate (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/navigation.js:55:3)
        at LocationImpl._locationObjectNavigate (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/Location-impl.js:30:5)
        at LocationImpl._locationObjectSetterNavigate (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/Location-impl.js:24:17)
        at LocationImpl.set href [as href] (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/Location-impl.js:46:10)
        at Location.set href [as href] (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/generated/Location.js:125:37)
        at Reflect.set (<anonymous>)
        at Window.set location [as location] (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/browser/Window.js:424:15)
        at Object.<anonymous> (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/src/sdk-bridge/__tests__/experiment/code-injector.test.ts:25:30)
        at Promise.finally.completed (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1557:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1497:10)
        at _callCircusHook (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:976:40)
        at processTicksAndRejections (node:internal/process/task_queues:105:5)
        at _runTest (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:941:5)
        at /Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:849:7
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:862:11)
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:857:11)
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:857:11)
        at run (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:761:3)
        at runAndTransformResultsToJestFormat (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1918:21)
        at jestAdapter (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/runner.js:101:19)
        at runTestInternal (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:275:16)
        at runTest (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:343:7)
        at Object.worker (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:497:12) {
      type: 'not implemented'
    }

      23 |     // Mock window.location
      24 |     delete (window as any).location
    > 25 |     ;(window as any).location = {
         |                              ^
      26 |       href: 'https://example.com/path/to/page?query=value#hash',
      27 |       pathname: '/path/to/page',
      28 |       hostname: 'example.com',

      at VirtualConsole.<anonymous> (node_modules/@jest/environment-jsdom-abstract/build/index.js:87:23)
          at Reflect.set (<anonymous>)
      at Object.<anonymous> (src/sdk-bridge/__tests__/experiment/code-injector.test.ts:25:30)

  console.error
    Error: Not implemented: navigation (except hash changes)
        at module.exports (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/browser/not-implemented.js:9:17)
        at navigateFetch (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/navigation.js:77:3)
        at exports.navigate (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/navigation.js:55:3)
        at LocationImpl._locationObjectNavigate (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/Location-impl.js:30:5)
        at LocationImpl._locationObjectSetterNavigate (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/Location-impl.js:24:17)
        at LocationImpl.set href [as href] (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/Location-impl.js:46:10)
        at Location.set href [as href] (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/generated/Location.js:125:37)
        at Reflect.set (<anonymous>)
        at Window.set location [as location] (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/browser/Window.js:424:15)
        at Object.<anonymous> (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/src/sdk-bridge/__tests__/experiment/code-injector.test.ts:25:30)
        at Promise.finally.completed (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1557:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1497:10)
        at _callCircusHook (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:976:40)
        at processTicksAndRejections (node:internal/process/task_queues:105:5)
        at _runTest (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:941:5)
        at /Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:849:7
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:862:11)
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:857:11)
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:857:11)
        at run (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:761:3)
        at runAndTransformResultsToJestFormat (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1918:21)
        at jestAdapter (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/runner.js:101:19)
        at runTestInternal (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:275:16)
        at runTest (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:343:7)
        at Object.worker (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:497:12) {
      type: 'not implemented'
    }

      23 |     // Mock window.location
      24 |     delete (window as any).location
    > 25 |     ;(window as any).location = {
         |                              ^
      26 |       href: 'https://example.com/path/to/page?query=value#hash',
      27 |       pathname: '/path/to/page',
      28 |       hostname: 'example.com',

      at VirtualConsole.<anonymous> (node_modules/@jest/environment-jsdom-abstract/build/index.js:87:23)
          at Reflect.set (<anonymous>)
      at Object.<anonymous> (src/sdk-bridge/__tests__/experiment/code-injector.test.ts:25:30)

  console.error
    Error: Not implemented: navigation (except hash changes)
        at module.exports (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/browser/not-implemented.js:9:17)
        at navigateFetch (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/navigation.js:77:3)
        at exports.navigate (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/navigation.js:55:3)
        at LocationImpl._locationObjectNavigate (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/Location-impl.js:30:5)
        at LocationImpl._locationObjectSetterNavigate (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/Location-impl.js:24:17)
        at LocationImpl.set href [as href] (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/Location-impl.js:46:10)
        at Location.set href [as href] (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/generated/Location.js:125:37)
        at Reflect.set (<anonymous>)
        at Window.set location [as location] (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/browser/Window.js:424:15)
        at Object.<anonymous> (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/src/sdk-bridge/__tests__/experiment/code-injector.test.ts:25:30)
        at Promise.finally.completed (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1557:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1497:10)
        at _callCircusHook (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:976:40)
        at processTicksAndRejections (node:internal/process/task_queues:105:5)
        at _runTest (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:941:5)
        at /Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:849:7
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:862:11)
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:857:11)
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:857:11)
        at run (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:761:3)
        at runAndTransformResultsToJestFormat (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1918:21)
        at jestAdapter (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/runner.js:101:19)
        at runTestInternal (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:275:16)
        at runTest (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:343:7)
        at Object.worker (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:497:12) {
      type: 'not implemented'
    }

      23 |     // Mock window.location
      24 |     delete (window as any).location
    > 25 |     ;(window as any).location = {
         |                              ^
      26 |       href: 'https://example.com/path/to/page?query=value#hash',
      27 |       pathname: '/path/to/page',
      28 |       hostname: 'example.com',

      at VirtualConsole.<anonymous> (node_modules/@jest/environment-jsdom-abstract/build/index.js:87:23)
          at Reflect.set (<anonymous>)
      at Object.<anonymous> (src/sdk-bridge/__tests__/experiment/code-injector.test.ts:25:30)

  console.error
    Error: Not implemented: navigation (except hash changes)
        at module.exports (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/browser/not-implemented.js:9:17)
        at navigateFetch (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/navigation.js:77:3)
        at exports.navigate (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/navigation.js:55:3)
        at LocationImpl._locationObjectNavigate (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/Location-impl.js:30:5)
        at LocationImpl._locationObjectSetterNavigate (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/Location-impl.js:24:17)
        at LocationImpl.set href [as href] (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/Location-impl.js:46:10)
        at Location.set href [as href] (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/generated/Location.js:125:37)
        at Reflect.set (<anonymous>)
        at Window.set location [as location] (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/browser/Window.js:424:15)
        at Object.<anonymous> (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/src/sdk-bridge/__tests__/experiment/code-injector.test.ts:25:30)
        at Promise.finally.completed (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1557:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1497:10)
        at _callCircusHook (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:976:40)
        at processTicksAndRejections (node:internal/process/task_queues:105:5)
        at _runTest (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:941:5)
        at /Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:849:7
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:862:11)
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:857:11)
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:857:11)
        at run (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.jsPASS src/__tests__/security-fixes.test.ts
  Security Fixes
    Fix #1: innerHTML XSS Protection
      ✓ should have DOMPurify available (5 ms)
      ✓ should sanitize malicious HTML (6 ms)
      ✓ should sanitize script tags (2 ms)
      ✓ should preserve safe HTML (3 ms)
    Fix #2: Code Injection Prevention
      ✓ should not execute code from new Function() (1 ms)
    Fix #3: Message Origin Validation
      ✓ should validate sender ID matches extension ID (1 ms)
      ✓ should reject messages without sender ID
    Fix #4: SSRF Protection
      ✓ should block localhost URLs (1 ms)
      ✓ should block private network URLs (95 ms)
      ✓ should allow public URLs (6 ms)
    Fix #5: API Key Encryption
      ✓ should use Plasmo Storage with secretKeyring option (2 ms)
    Fix #6: Input Validation with Zod
      ✓ should validate API request method (10 ms)
      ✓ should validate API request path (2 ms)
      ✓ should validate config schema (15 ms)
    Fix #7: JSON.parse Error Handling
      ✓ should handle malformed JSON gracefully (7 ms)
      ✓ should handle null/undefined JSON gracefully (1 ms)
      ✓ should parse valid JSON correctly (1 ms)
      ✓ should handle nested JSON parsing errors (1 ms)
    Integration: Multiple Security Layers
      ✓ should combine validation, sanitization, and error handling (3 ms)

:761:3)
        at runAndTransformResultsToJestFormat (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1918:21)
        at jestAdapter (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/runner.js:101:19)
        at runTestInternal (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:275:16)
        at runTest (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:343:7)
        at Object.worker (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:497:12) {
      type: 'not implemented'
    }

      23 |     // Mock window.location
      24 |     delete (window as any).location
    > 25 |     ;(window as any).location = {
         |                              ^
      26 |       href: 'https://example.com/path/to/page?query=value#hash',
      27 |       pathname: '/path/to/page',
      28 |       hostname: 'example.com',

      at VirtualConsole.<anonymous> (node_modules/@jest/environment-jsdom-abstract/build/index.js:87:23)
          at Reflect.set (<anonymous>)
      at Object.<anonymous> (src/sdk-bridge/__tests__/experiment/code-injector.test.ts:25:30)

  console.error
    Error: Not implemented: navigation (except hash changes)
        at module.exports (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/browser/not-implemented.js:9:17)
        at navigateFetch (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/navigation.js:77:3)
        at exports.navigate (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/navigation.js:55:3)
        at LocationImpl._locationObjectNavigate (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/Location-impl.js:30:5)
        at LocationImpl._locationObjectSetterNavigate (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/Location-impl.js:24:17)
        at LocationImpl.set href [as href] (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/Location-impl.js:46:10)
        at Location.set href [as href] (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/generated/Location.js:125:37)
        at Reflect.set (<anonymous>)
        at Window.set location [as location] (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/browser/Window.js:424:15)
        at Object.<anonymous> (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/src/sdk-bridge/__tests__/experiment/code-injector.test.ts:25:30)
        at Promise.finally.completed (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1557:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1497:10)
        at _callCircusHook (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:976:40)
        at processTicksAndRejections (node:internal/process/task_queues:105:5)
        at _runTest (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:941:5)
        at /Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:849:7
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:862:11)
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:857:11)
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:857:11)
        at run (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:761:3)
        at runAndTransformResultsToJestFormat (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1918:21)
        at jestAdapter (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/runner.js:101:19)
        at runTestInternal (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:275:16)
        at runTest (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:343:7)
        at Object.worker (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:497:12) {
      type: 'not implemented'
    }

      23 |     // Mock window.location
      24 |     delete (window as any).location
    > 25 |     ;(window as any).location = {
         |                              ^
      26 |       href: 'https://example.com/path/to/page?query=value#hash',
      27 |       pathname: '/path/to/page',
      28 |       hostname: 'example.com',

      at VirtualConsole.<anonymous> (node_modules/@jest/environment-jsdom-abstract/build/index.js:87:23)
          at Reflect.set (<anonymous>)
      at Object.<anonymous> (src/sdk-bridge/__tests__/experiment/code-injector.test.ts:25:30)

  console.error
    Error: Not implemented: navigation (except hash changes)
        at module.exports (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/browser/not-implemented.js:9:17)
        at navigateFetch (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/navigation.js:77:3)
        at exports.navigate (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/navigation.js:55:3)
        at LocationImpl._locationObjectNavigate (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/Location-impl.js:30:5)
        at LocationImpl._locationObjectSetterNavigate (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/Location-impl.js:24:17)
        at LocationImpl.set href [as href] (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/Location-impl.js:46:10)
        at Location.set href [as href] (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/generated/Location.js:125:37)
        at Reflect.set (<anonymous>)
        at Window.set location [as location] (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/browser/Window.js:424:15)
        at Object.<anonymous> (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/src/sdk-bridge/__tests__/experiment/code-injector.test.ts:25:30)
        at Promise.finally.completed (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1557:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1497:10)
        at _callCircusHook (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:976:40)
        at processTicksAndRejections (node:internal/process/task_queues:105:5)
        at _runTest (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules  console.log
    [VisualEditor] Constructor called with options: {
      variantName: 'test-variant',
      experimentName: 'test-experiment',
      logoUrl: 'https://example.com/logo.png',
      onChangesUpdate: [Function: mockConstructor] {
        _isMockFunction: true,
        getMockImplementation: [Function (anonymous)],
        mock: [Getter/Setter],
        mockClear: [Function (anonymous)],
        mockReset: [Function (anonymous)],
        mockRestore: [Function (anonymous)],
        mockReturnValueOnce: [Function (anonymous)],
        mockResolvedValueOnce: [Function (anonymous)],
        mockRejectedValueOnce: [Function (anonymous)],
        mockReturnValue: [Function (anonymous)],
        mockResolvedValue: [Function (anonymous)],
        mockRejectedValue: [Function (anonymous)],
        mockImplementationOnce: [Function (anonymous)],
        withImplementation: [Function: bound withImplementation],
        mockImplementation: [Function (anonymous)],
        mockReturnThis: [Function (anonymous)],
        mockName: [Function (anonymous)],
        getMockName: [Function (anonymous)],
        [Symbol(nodejs.dispose)]: [Function (anonymous)]
      },
      initialChanges: []
    }

      at new VisualEditor (src/visual-editor/core/visual-editor.ts:53:13)

  console.log
    [VisualEditor] Experiment name from options: test-experiment

      at new VisualEditor (src/visual-editor/core/visual-editor.ts:54:13)

  console.log
    [handleEditAction] START for element: HTMLDivElement {}

      at EditorCoordinator.handleEditAction (src/visual-editor/core/editor-coordinator.ts:360:13)

  console.log
    [EventsDebugPage] ✅ SDK_EVENT_BROADCAST received, adding event: {
      eventName: 'ready',
      data: null,
      timestamp: '2025-01-01T10:00:00.000Z'
    }

      at handleRuntimeMessage (src/components/EventsDebugPage.tsx:57:19)
          at Array.forEach (<anonymous>)

  console.log
    [VisualEditor] Constructor called with options: {
      variantName: 'test-variant',
      experimentName: 'test-experiment',
      logoUrl: 'https://example.com/logo.png',
      onChangesUpdate: [Function: mockConstructor] {
        _isMockFunction: true,
        getMockImplementation: [Function (anonymous)],
        mock: [Getter/Setter],
        mockClear: [Function (anonymous)],
        mockReset: [Function (anonymous)],
        mockRestore: [Function (anonymous)],
        mockReturnValueOnce: [Function (anonymous)],
        mockResolvedValueOnce: [Function (anonymous)],
        mockRejectedValueOnce: [Function (anonymous)],
        mockReturnValue: [Function (anonymous)],
        mockResolvedValue: [Function (anonymous)],
        mockRejectedValue: [Function (anonymous)],
        mockImplementationOnce: [Function (anonymous)],
        withImplementation: [Function: bound withImplementation],
        mockImplementation: [Function (anonymous)],
        mockReturnThis: [Function (anonymous)],
        mockName: [Function (anonymous)],
        getMockName: [Function (anonymous)],
        [Symbol(nodejs.dispose)]: [Function (anonymous)]
      },
      initialChanges: []
    }

      at new VisualEditor (src/visual-editor/core/visual-editor.ts:53:13)

  console.log
    [handleEditAction] Element details: DIV test-element test-class

      at EditorCoordinator.handleEditAction (src/visual-editor/core/editor-coordinator.ts:361:13)

  console.log
    [EventsDebugPage] Adding event to list. Current count: 0 New count: 1

      at src/components/EventsDebugPage.tsx:66:21

  console.log
    [VisualEditor] Experiment name from options: test-experiment

      at new VisualEditor (src/visual-editor/core/visual-editor.ts:54:13)

  console.log
    [EventsDebugPage] 🔵 Received runtime message: SDK_EVENT_BROADCAST {
      type: 'SDK_EVENT_BROADCAST',
      payload: {
        eventName: 'exposure',
        data: { experiment: 'test_exp', variant: 1 },
        timestamp: '2025-01-01T10:00:01.000Z'
      }
    }

      at handleRuntimeMessage (src/components/EventsDebugPage.tsx:54:15)
          at Array.forEach (<anonymous>)

  console.log
    [EventsDebugPage] ✅ SDK_EVENT_BROADCAST received, adding event: {
      eventName: 'exposure',
      data: { experiment: 'test_exp', variant: 1 },
      timestamp: '2025-01-01T10:00:01.000Z'
    }

      at handleRuntimeMessage (src/components/EventsDebugPage.tsx:57:19)
          at Array.forEach (<anonymous>)

  console.log
    [handleEditAction] START for element: HTMLDivElement {}

      at EditorCoordinator.handleEditAction (src/visual-editor/core/editor-coordinator.ts:360:13)

  console.log
    [VisualEditor] Constructor called with options: {
      variantName: 'test-variant',
      experimentName: 'test-experiment',
      logoUrl: 'https://example.com/logo.png',
      onChangesUpdate: [Function: mockConstructor] {
        _isMockFunction: true,
        getMockImplementation: [Function (anonymous)],
        mock: [Getter/Setter],
        mockClear: [Function (anonymous)],
        mockReset: [Function (anonymous)],
        mockRestore: [Function (anonymous)],
        mockReturnValueOnce: [Function (anonymous)],
        mockResolvedValueOnce: [Function (anonymous)],
        mockRejectedValueOnce: [Function (anonymous)],
        mockReturnValue: [Function (anonymous)],
        mockResolvedValue: [Function (anonymous)],
        mockRejectedValue: [Function (anonymous)],
        mockImplementationOnce: [Function (anonymous)],
        withImplementation: [Function: bound withImplementation],
        mockImplementation: [Function (anonymous)],
        mockReturnThis: [Function (anonymous)],
        mockName: [Function (anonymous)],
        getMockName: [Function (anonymous)],
        [Symbol(nodejs.dispose)]: [Function (anonymous)]
      },
      initialChanges: [ { selector: '.test', type: 'text', value: 'Initial text' } ]
    }

      at new VisualEditor (src/visual-editor/core/visual-editor.ts:53:13)

  console.log
    [handleEditAction] Element details: DIV test-element test-class

      at EditorCoordinator.handleEditAction (src/visual-editor/core/editor-coordinator.ts:361:13)

  console.log
    [EventsDebugPage] Adding event to list. Current count: 1 New count: 2

      at src/components/EventsDebugPage.tsx:66:21

PASS src/visual-editor/core/__tests__/undo-redo-manager.test.ts
  UndoRedoManager
    Basic functionality
      ✓ should start with empty stacks (1 ms)
      ✓ should add changes to undo stack (1 ms)
      ✓ should clear redo stack when new change is added
    Individual change tracking (no auto-squashing)
      ✓ should track multiple changes to same element individually (1 ms)
      ✓ should track changes to different selectors individually
      ✓ should track changes to different types individually
    Undo functionality
      ✓ should undo a single change (1 ms)
      ✓ should undo multiple changes in correct order
      ✓ should return null when undo stack is empty (1 ms)
    Redo functionality
      ✓ should redo a single change (1 ms)
      ✓ should redo multiple changes in correct order
      ✓ should return null when redo stack is empty
    squashChanges() method
      ✓ should squash multiple changes to same element (3 ms)
      ✓ should not squash changes to different selectors
      ✓ should not squash changes to different types (1 ms)
      ✓ should squash mixed changes correctly
      ✓ should return empty array when no changes (1 ms)
      ✓ should squash style changes correctly
    Reference isolation
      ✓ should deep copy changes to prevent mutation (1 ms)
      ✓ should deep copy old values to prevent mutation
      ✓ should isolate undo and redo stacks
    Stack size limit
      ✓ should respect max stack size (1 ms)
      ✓ should not exceed max size without squashing
    Clear functionality
      ✓ should clear all stacks
    Complex scenarios
      ✓ should handle alternating undo/redo operations with individual changes (1 ms)
  E2E scenario simulation
    ✓ should handle the exact E2E test flow: 3 text changes, 3 undos, 3 redos (2 ms)
  Change counting accuracy
    ✓ should correctly count undo changes with pointer approach (1 ms)
    ✓ should count changes correctly after adding new change mid-history (74 ms)
    ✓ should maintain accurate counts with mixed operations (2 ms)
    ✓ should count squashed changes correctly regardless of undo/redo state
    ✓ should handle edge case: canUndo/canRedo at boundaries (4 ms)

  console.log
    [VisualEditor] Experiment name from options: test-experiment

      at new VisualEditor (src/visual-editor/core/visual-editor.ts:54:13)

  console.log
    [EventsDebugPage] ❌ Removing message listeners

      at src/components/EventsDebugPage.tsx:88:15
          at Array.forEach (<anonymous>)

  console.log
    [handleSelectRelativeElement] Called with element: HTMLDivElement {}

      at EditorCoordinator.handleSelectRelativeElement (src/visual-editor/core/editor-coordinator.ts:493:13)

  console.log
    [handleSelectRelativeElement] Element details: DIV test-element test-class

      at EditorCoordinator.handleSelectRelativeElement (src/visual-editor/core/editor-coordinator.ts:494:13)

  console.log
    [VisualEditor] Constructor called with options: {
      variantName: 'test-variant',
      experimentName: 'test-experiment',
      logoUrl: 'https://example.com/logo.png',
      onChangesUpdate: [Function: mockConstructor] {
        _isMockFunction: true,
        getMockImplementation: [Function (anonymous)],
        mock: [Getter/Setter],
        mockClear: [Function (anonymous)],
        mockReset: [Function (anonymous)],
        mockRestore: [Function (anonymous)],
        mockReturnValueOnce: [Function (anonymous)],
        mockResolvedValueOnce: [Function (anonymous)],
        mockRejectedValueOnce: [Function (anonymous)],
        mockReturnValue: [Function (anonymous)],
        mockResolvedValue: [Function (anonymous)],
        mockRejectedValue: [Function (anonymous)],
        mockImplementationOnce: [Function (anonymous)],
        withImplementation: [Function: bound withImplementation],
        mockImplementation: [Function (anonymous)],
        mockReturnThis: [Function (anonymous)],
        mockName: [Function (anonymous)],
        getMockName: [Function (anonymous)],
        [Symbol(nodejs.dispose)]: [Function (anonymous)]
      },
      initialChanges: []
    }

      at new VisualEditor (src/visual-editor/core/visual-editor.ts:53:13)

  console.warn
    Failed to get development environment: Error: Storage error
        at Object.<anonymous> (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/src/__tests__/overrides-storage.test.ts:92:41)
        at Promise.finally.completed (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1557:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1497:10)
        at _callCircusTest (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1007:40)
        at processTicksAndRejections (node:internal/process/task_queues:105:5)
        at _runTest (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:947:3)
        at /Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:849:7
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:862:11)
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:857:11)
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:857:11)
        at run (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:761:3)
        at runAndTransformResultsToJestFormat (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1918:21)
        at jestAdapter (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/runner.js:101:19)
        at runTestInternal (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:275:16)
        at runTest (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:343:7)
        at Object.worker (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:497:12)

      269 |     return envName || null
      270 |   } catch (error) {
    > 271 |     console.warn('Failed to get development environment:', error)
          |             ^
      272 |     return null
      273 |   }
      274 | }

      at getDevelopmentEnvironment (src/utils/overrides.ts:271:13)
      at syncOverridesToCookie (src/utils/overrides.ts:283:20)
      at saveOverrides (src/utils/overrides.ts:230:5)
      at Object.<anonymous> (src/__tests__/overrides-storage.test.ts:123:7)

  console.log
    [ABsmartly] Syncing to cookie - overrides: { experiment1: 1, experiment2: { variant: 2, env: 1 } } devEnv: null

      at syncOverridesToCookie (src/utils/overrides.ts:284:13)

  console.log
    [ABsmartly] saveOverrides called with: {
      enabled: 1,
      disabled: -1,
      objectDisabled: { variant: -1, env: 1 },
      objectEnabled: { variant: 2, env: 1 }
    }

      at saveOverrides (src/utils/overrides.ts:215:13)

  console.log
    [handleSelectRelativeElement] Called with element: HTMLDivElement {}

      at EditorCoordinator.handleSelectRelativeElement (src/visual-editor/core/editor-coordinator.ts:493:13)

  console.log
    [handleSelectRelativeElement] Element details: DIV test-element test-class

      at EditorCoordinator.handleSelectRelativeElement (src/visual-editor/core/editor-coordinator.ts:494:13)

  console.log
    [VisualEditor] Experiment name from options: test-experiment

      at new VisualEditor (src/visual-editor/core/visual-editor.ts:54:13)

  console.log
    [EventsDebugPage] 🔵 Component mounted, fetching buffered events...

      at src/components/EventsDebugPage.tsx:33:13

  console.log
    [EventsDebugPage] GET_BUFFERED_EVENTS response: { success: true, events: [] }

      at src/components/EventsDebugPage.tsx:39:15

  console.log
    [ABSmartly] Starting unified visual editor - Version: 3.0-UNIFIED

      at VisualEditor.start (src/visual-editor/core/visual-editor.ts:144:13)

  console.log
    [ABsmartly] Cleaned overrides: { enabled: 1, objectEnabled: { variant: 2, env: 1 } }

      at saveOverrides (src/utils/overrides.ts:225:13)

  console.log
    [ABSmartly] Build timestamp: 2025-10-17T15:42:22.021Z

      at VisualEditor.start (src/visual-editor/core/visual-editor.ts:145:13)

  console.log
    [EventsDebugPage] ✅ Loaded 0 buffered events

      at src/components/EventsDebugPage.tsx:41:17

  console.log
    [EventsDebugPage] ✅ Registered message listeners

      at src/components/EventsDebugPage.tsx:83:13

  console.log
    [ABSmartly] Starting visual editor

      at VisualEditor.start (src/visual-editor/core/visual-editor.ts:158:13)

  console.log
    [ABSmartly] Visual editor banner created

      at VisualEditor.start (src/visual-editor/core/visual-editor.ts:180:13)

  console.log
    [EventsDebugPage] 🔵 Received runtime message: SDK_EVENT_BROADCAST {
      type: 'SDK_EVENT_BROADCAST',
      payload: {
        eventName: 'error',
        data: null,
        timestamp: '2025-10-17T15:42:22.032Z'
      }
    }

      at handleRuntimeMessage (src/components/EventsDebugPage.tsx:54:15)
          at Array.forEach (<anonymous>)

  console.log
    [ABSmartly] Visual editor is now active!

      at VisualEditor.start (src/visual-editor/core/visual-editor.ts:184:13)

  console.log
    📡 Event fired: ready

      at Context.eventLogger [as _eventLogger] (src/__tests__/sdk-api.test.ts:99:17)

  console.log
    
    🧪 Testing SDK Methods:

      at Object.<anonymous> (src/__tests__/sdk-api.test.ts:119:15)

  console.log
    Events captured so far: [ 'ready' ]

      at Object.<anonymous> (src/__tests__/sdk-api.test.ts:120:15)

  console.log
    1. Testing ready event (context creation)...

      at Object.<anonymous> (src/__tests__/sdk-api.test.ts:123:15)

  console.log
    2. Testing goal event (track)...

      at Object.<anonymous> (src/__tests__/sdk-api.test.ts:127:15)

  console.log
    📡 Event fired: goal

      at Context.eventLogger [as _eventLogger] (src/__tests__/sdk-api.test.ts:99:17)

  console.log
    3. Testing exposure event (treatment)...

      at Object.<anonymous> (src/__tests__/sdk-api.test.ts:132:15)

  console.log
    📡 Event fired: exposure

      at Context.eventLogger [as _eventLogger] (src/__tests__/sdk-api.test.ts:99:17)

  console.log
    4. Testing refresh event...

      at Object.<anonymous> (src/__tests__/sdk-api.test.ts:137:15)

  console.warn
    Failed to get development environment: Error: Storage error
        at Object.<anonymous> (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/src/__tests__/overrides-storage.test.ts:92:41)
        at Promise.finally.completed (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1557:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1497:10)
        at _callCircusTest (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1007:40)
        at processTicksAndRejections (node:internal/process/task_queues:105:5)
        at _runTest (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:947:3)
        at /Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:849:7
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:862:11)
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:857:11)
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:857:11)
        at run (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:761:3)
        at runAndTransformResultsToJestFormat (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1918:21)
        at jestAdapter (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/runner.js:101:19)
        at runTestInternal (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:275:16)
        at runTest (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:343:7)
        at Object.worker (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:497:12)

      269 |     return envName || null
      270 |   } catch (error) {
    > 271 |     console.warn('Failed to get development environment:', error)
          |             ^
      272 |     return null
      273 |   }
      274 | }

      at getDevelopmentEnvironment (src/utils/overrides.ts:271:13)
      at syncOverridesToCookie (src/utils/overrides.ts:283:20)
      at saveOverrides (src/utils/overrides.ts:230:5)
      at Object.<anonymous> (src/__tests__/overrides-storage.test.ts:152:7)

  console.log
    [ABsmartly] Syncing to cookie - overrides: { enabled: 1, objectEnabled: { variant: 2, env: 1 } } devEnv: null

      at syncOverridesToCookie (src/utils/overrides.ts:284:13)

  console.log
    [VisualEditor] Constructor called with options: {
      variantName: 'test-variant',
      experimentName: 'test-experiment',
      logoUrl: 'https://example.com/logo.png',
      onChangesUpdate: [Function: mockConstructor] {
        _isMockFunction: true,
        getMockImplementation: [Function (anonymous)],
        mock: [Getter/Setter],
        mockClear: [Function (anonymous)],
        mockReset: [Function (anonymous)],
        mockRestore: [Function (anonymous)],
        mockReturnValueOnce: [Function (anonymous)],
        mockResolvedValueOnce: [Function (anonymous)],
        mockRejectedValueOnce: [Function (anonymous)],
        mockReturnValue: [Function (anonymous)],
        mockResolvedValue: [Function (anonymous)],
        mockRejectedValue: [Function (anonymous)],
        mockImplementationOnce: [Function (anonymous)],
        withImplementation: [Function: bound withImplementation],
        mockImplementation: [Function (anonymous)],
        mockReturnThis: [Function (anonymous)],
        mockName: [Function (anonymous)],
        getMockName: [Function (anonymous)],
        [Symbol(nodejs.dispose)]: [Function (anonymous)]
      },
      initialChanges: []
    }

      at new VisualEditor (src/visual-editor/core/visual-editor.ts:53:13)

  console.log
    [ABsmartly] saveOverrides called with: { experiment1: 1 }

      at saveOverrides (src/utils/overrides.ts:215:13)

  console.log
    [ABsmartly] Cleaned overrides: { experiment1: 1 }

      at saveOverrides (src/utils/overrides.ts:225:13)

  console.log
    [VisualEditor] Experiment name from options: test-experiment

      at new VisualEditor (src/visual-editor/core/visual-editor.ts:54:13)

  console.warn
    Failed to get development environment: Error: Storage error
        at Object.<anonymous> (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/src/__tests__/overrides-storage.test.ts:92:41)
        at Promise.finally.completed (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1557:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1497:10)
        at _callCircusTest (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1007:40)
        at processTicksAndRejections (node:internal/process/task_queues:105:5)
        at _runTest (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:947:3)
        at /Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:849:7
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:862:11)
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:857:11)
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:857:11)
        at run (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:761:3)
        at runAndTransformResultsToJestFormat (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1918:21)
        at jestAdapter (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/runner.js:101:19)
        at runTestInternal (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:275:16)
        at runTest (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:343:7)
        at Object.worker (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:497:12)

      269 |     return envName || null
      270 |   } catch (error) {
    > 271 |     console.warn('Failed to get development environment:', error)
          |             ^
      272 |     return null
      273 |   }
      274 | }

      at getDevelopmentEnvironment (src/utils/overrides.ts:271:13)
      at syncOverridesToCookie (src/utils/overrides.ts:283:20)
      at saveOverrides (src/utils/overrides.ts:230:5)
      at Object.<anonymous> (src/__tests__/overrides-storage.test.ts:167:9)

  console.log
    [ABsmartly] Syncing to cookie - overrides: { experiment1: 1 } devEnv: null

      at syncOverridesToCookie (src/utils/overrides.ts:284:13)

  console.log
    [ABSmartly] Starting unified visual editor - Version: 3.0-UNIFIED

      at VisualEditor.start (src/visual-editor/core/visual-editor.ts:144:13)

  console.log
    [ABSmartly] Build timestamp: 2025-10-17T15:42:22.106Z

      at VisualEditor.start (src/visual-editor/core/visual-editor.ts:145:13)

  console.log
    [EventsDebugPage] ✅ SDK_EVENT_BROADCAST received, adding event: {
      eventName: 'error',
      data: null,
      timestamp: '2025-10-17T15:42:22.032Z'
    }

      at handleRuntimeMessage (src/components/EventsDebugPage.tsx:57:19)
          at Array.forEach (<anonymous>)

  console.log
    [ABSmartly] Starting visual editor

      at VisualEditor.start (src/visual-editor/core/visual-editor.ts:158:13)

PASS src/__tests__/overrides.test.ts
  overrides.ts
    ENV_TYPE constants
      ✓ should have correct environment type values (1 ms)
    parseCookieFormat
      ✓ should return empty overrides for null/empty input
      ✓ should parse simple running experiment format (1 ms)
      ✓ should parse development experiment format with env
      ✓ should parse full format with env and id
      ✓ should parse dev environment prefix
      ✓ should handle URL encoded dev environment names (4 ms)
      ✓ should handle URL encoded experiment names
      ✓ should handle mixed formats in the same cookie (1 ms)
      ✓ should skip malformed entries
      ✓ should handle empty experiments string with dev env (1 ms)
      ✓ should handle malformed cookie gracefully (1 ms)
      ✓ should handle special characters in experiment names
    serializeToCookieFormat
      ✓ should serialize simple running experiments (2 ms)
      ✓ should serialize development experiments with env
      ✓ should serialize API fetch experiments with full format
      ✓ should handle mixed experiment types
      ✓ should include dev environment prefix when provided
      ✓ should URL encode dev environment names
      ✓ should URL encode experiment names with special characters
      ✓ should handle object experiments with production env as simple format
      ✓ should handle development experiments without id (1 ms)
      ✓ should return empty string for empty overrides without dev env
      ✓ should include dev env prefix even with empty experiments
    round-trip tests (serialize then parse)
      ✓ should preserve simple running experiments (1 ms)
      ✓ should preserve development experiments
      ✓ should preserve API fetch experiments with IDs (1 ms)
      ✓ should preserve mixed experiment types
      ✓ should preserve dev environment names (1 ms)
      ✓ should preserve experiment names with special characters
    getCookieOverridesScript
      ✓ should generate script that parses cookie correctly
      ✓ should generate script that handles empty cookie (1 ms)
    setCookieOverridesScript
      ✓ should generate script to set cookie with overrides (2 ms)
      ✓ should generate script to clear cookie when no overrides
      ✓ should filter out disabled experiments (variant -1)
      ✓ should set expiration date 30 days in future (4 ms)
    edge cases and error handling
      ✓ should handle very long experiment names
      ✓ should handle invalid numeric values gracefully (1 ms)
      ✓ should handle empty experiment names
      ✓ should handle empty values (1 ms)
      ✓ should handle maximum cookie size considerations (1 ms)
      ✓ should handle Unicode characters in experiment names
      ✓ should handle malformed dev environment (48 ms)

  console.log
    [EventsDebugPage] Adding event to list. Current count: 0 New count: 1

      at src/components/EventsDebugPage.tsx:66:21

  console.log
    [EventsDebugPage] 🔵 Received runtime message: SDK_EVENT_BROADCAST {
      type: 'SDK_EVENT_BROADCAST',
      payload: {
        eventName: 'ready',
        data: null,
        timestamp: '2025-10-17T15:42:22.120Z'
      }
    }

      at handleRuntimeMessage (src/components/EventsDebugPage.tsx:54:15)
          at Array.forEach (<anonymous>)

  console.log
    [EventsDebugPage] ✅ SDK_EVENT_BROADCAST received, adding event: {
      eventName: 'ready',
      data: null,
      timestamp: '2025-10-17T15:42:22.120Z'
    }

      at handleRuntimeMessage (src/components/EventsDebugPage.tsx:57:19)
          at Array.forEach (<anonymous>)

  console.log
    [ABSmartly] Visual editor banner created

      at VisualEditor.start (src/visual-editor/core/visual-editor.ts:180:13)

  console.log
    [EventsDebugPage] Adding event to list. Current count: 1 New count: 2

      at src/components/EventsDebugPage.tsx:66:21

  console.log
    [EventsDebugPage] 🔵 Received runtime message: SDK_EVENT_BROADCAST {
      type: 'SDK_EVENT_BROADCAST',
      payload: {
        eventName: 'refresh',
        data: null,
        timestamp: '2025-10-17T15:42:22.131Z'
      }
    }

      at handleRuntimeMessage (src/components/EventsDebugPage.tsx:54:15)
          at Array.forEach (<anonymous>)

  console.log
    [EventsDebugPage] ✅ SDK_EVENT_BROADCAST received, adding event: {
      eventName: 'refresh',
      data: null,
      timestamp: '2025-10-17T15:42:22.131Z'
    }

      at handleRuntimeMessage (src/components/EventsDebugPage.tsx:57:19)
          at Array.forEach (<anonymous>)

  console.log
    [EventsDebugPage] Adding event to list. Current count: 2 New count: 3

      at src/components/EventsDebugPage.tsx:66:21

  console.log
    [ABsmartly] saveOverrides called with: { experiment1: 1 }

      at saveOverrides (src/utils/overrides.ts:215:13)

  console.log
    [ABsmartly] Cleaned overrides: { experiment1: 1 }

      at saveOverrides (src/utils/overrides.ts:225:13)

  console.log
    [ABSmartly] Visual editor is now active!

      at VisualEditor.start (src/visual-editor/core/visual-editor.ts:184:13)

  console.warn
    Failed to get development environment: Error: Storage error
        at Object.<anonymous> (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/src/__tests__/overrides-storage.test.ts:92:41)
        at Promise.finally.completed (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1557:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1497:10)
        at _callCircusTest (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1007:40)
        at processTicksAndRejections (node:internal/process/task_queues:105:5)
        at _runTest (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:947:3)
        at /Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:849:7
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:862:11)
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:857:11)
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:857:11)
        at run (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:761:3)
        at runAndTransformResultsToJestFormat (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1918:21)
        at jestAdapter (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/runner.js:101:19)
        at runTestInternal (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:275:16)
        at runTest (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:343:7)
        at Object.worker (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:497:12)

      269 |     return envName || null
      270 |   } catch (error) {
    > 271 |     console.warn('Failed to get development environment:', error)
          |             ^
      272 |     return null
      273 |   }
      274 | }

      at getDevelopmentEnvironment (src/utils/overrides.ts:271:13)
      at syncOverridesToCookie (src/utils/overrides.ts:283:20)
      at saveOverrides (src/utils/overrides.ts:230:5)
      at Object.<anonymous> (src/__tests__/overrides-storage.test.ts:183:7)

  console.log
    [ABsmartly] Syncing to cookie - overrides: { experiment1: 1 } devEnv: null

      at syncOverridesToCookie (src/utils/overrides.ts:284:13)

  console.log
    [ABsmartly] saveOverrides called with: { experiment1: 1 }

      at saveOverrides (src/utils/overrides.ts:215:13)

  console.log
    [VisualEditor] Constructor called with options: {
      variantName: 'test-variant',
      experimentName: 'test-experiment',
      logoUrl: 'https://example.com/logo.png',
      onChangesUpdate: [Function: mockConstructor] {
        _isMockFunction: true,
        getMockImplementation: [Function (anonymous)],
        mock: [Getter/Setter],
        mockClear: [Function (anonymous)],
        mockReset: [Function (anonymous)],
        mockRestore: [Function (anonymous)],
        mockReturnValueOnce: [Function (anonymous)],
        mockResolvedValueOnce: [Function (anonymous)],
        mockRejectedValueOnce: [Function (anonymous)],
        mockReturnValue: [Function (anonymous)],
        mockResolvedValue: [Function (anonymous)],
        mockRejectedValue: [Function (anonymous)],
        mockImplementationOnce: [Function (anonymous)],
        withImplementation: [Function: bound withImplementation],
        mockImplementation: [Function (anonymous)],
        mockReturnThis: [Function (anonymous)],
        mockName: [Function (anonymous)],
        getMockName: [Function (anonymous)],
        [Symbol(nodejs.dispose)]: [Function (anonymous)]
      },
      initialChanges: []
    }

      at new VisualEditor (src/visual-editor/core/visual-editor.ts:53:13)

  console.log
    [ABsmartly] Cleaned overrides: { experiment1: 1 }

      at saveOverrides (src/utils/overrides.ts:225:13)

  console.log
    [VisualEditor] Experiment name from options: test-experiment

      at new VisualEditor (src/visual-editor/core/visual-editor.ts:54:13)

PASS src/sdk-bridge/__tests__/sdk/sdk-detector.test.ts
  SDKDetector
    detectSDK
      ✓ should return null when no SDK or context is found (1 ms)
      ✓ should detect SDK instance with createContext method
      ✓ should detect context at window.ABsmartlyContext (2 ms)
      ✓ should detect context at window.absmartly (1 ms)
      ✓ should detect context at window.sdk.context (1 ms)
      ✓ should detect context with context property
      ✓ should detect context from contexts array (1 ms)
      ✓ should skip invalid contexts in array
      ✓ should log context details when found (1 ms)
      ✓ should return cached context on subsequent calls (3 ms)
      ✓ should prioritize SDK locations in order (1 ms)
      ✓ should prioritize context locations in order (17 ms)
    getCachedContext
      ✓ should return null when no context is cached (15 ms)
      ✓ should return cached context after detection (30 ms)
    getContextPath
      ✓ should return null when no context is cached (15 ms)
      ✓ should return context path after detection (52 ms)
    clearCache
      ✓ should clear cached context and path (2 ms)
      ✓ should allow re-detection after clearing cache (4 ms)

  console.error
    Failed to save development environment: Error: Storage error
        at Object.<anonymous> (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/src/__tests__/overrides-storage.test.ts:191:41)
        at Promise.finally.completed (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1557:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1497:10)
        at _callCircusTest (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1007:40)
        at processTicksAndRejections (node:internal/process/task_queues:105:5)
        at _runTest (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:947:3)
        at /Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:849:7
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:862:11)
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:857:11)
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:857:11)
        at run (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:761:3)
        at runAndTransformResultsToJestFormat (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1918:21)
        at jestAdapter (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/runner.js:101:19)
        at runTestInternal (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:275:16)
        at runTest (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:343:7)
        at Object.worker (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:497:12)

      257 |     }
      258 |   } catch (error) {
    > 259 |     console.error('Failed to save development environment:', error)
          |             ^
      260 |   }
      261 | }
      262 |

      at saveDevelopmentEnvironment (src/utils/overrides.ts:259:13)
      at Object.<anonymous> (src/__tests__/overrides-storage.test.ts:221:7)

  console.error
    Failed to save development environment: Error: Storage error
        at Object.<anonymous> (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/src/__tests__/overrides-storage.test.ts:191:41)
        at Promise.finally.completed (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1557:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1497:10)
        at _callCircusTest (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1007:40)
        at processTicksAndRejections (node:internal/process/task_queues:105:5)
        at _runTest (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:947:3)
        at /Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:849:7
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:862:11)
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:857:11)
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:857:11)
        at run (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:761:3)
        at runAndTransformResultsToJestFormat (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1918:21)
        at jestAdapter (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/runner.js:101:19)
        at runTestInternal (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:275:16)
        at runTest (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:343:7)
        at Object.worker (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:497:12)

      257 |     }
      258 |   } catch (error) {
    > 259 |     console.error('Failed to save development environment:', error)
          |             ^
      260 |   }
      261 | }
      262 |

      at saveDevelopmentEnvironment (src/utils/overrides.ts:259:13)
      at Object.<anonymous> (src/__tests__/overrides-storage.test.ts:242:7)

  console.log
    📡 Event fired: refresh

      at Context.eventLogger [as _eventLogger] (src/__tests__/sdk-api.test.ts:99:17)

  console.log
       ✅ Refresh succeeded

      at Object.<anonymous> (src/__tests__/sdk-api.test.ts:140:17)

  console.log
    5. Testing publish event...

      at Object.<anonymous> (src/__tests__/sdk-api.test.ts:146:15)

/jest-circus/build/jestAdapterInit.js:941:5)
        at /Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:849:7
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:862:11)
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:857:11)
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:857:11)
        at run (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:761:3)
        at runAndTransformResultsToJestFormat (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1918:21)
        at jestAdapter (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/runner.js:101:19)
        at runTestInternal (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:275:16)
        at runTest (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:343:7)
        at Object.worker (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:497:12) {
      type: 'not implemented'
    }

      23 |     // Mock window.location
      24 |     delete (window as any).location
    > 25 |     ;(window as any).location = {
         |                              ^
      26 |       href: 'https://example.com/path/to/page?query=value#hash',
      27 |       pathname: '/path/to/page',
      28 |       hostname: 'example.com',

      at VirtualConsole.<anonymous> (node_modules/@jest/environment-jsdom-abstract/build/index.js:87:23)
          at Reflect.set (<anonymous>)
      at Object.<anonymous> (src/sdk-bridge/__tests__/experiment/code-injector.test.ts:25:30)

  console.error
    Error: Not implemented: navigation (except hash changes)
        at module.exports (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/browser/not-implemented.js:9:17)
        at navigateFetch (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/navigation.js:77:3)
        at exports.navigate (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/navigation.js:55:3)
        at LocationImpl._locationObjectNavigate (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/Location-impl.js:30:5)
        at LocationImpl._locationObjectSetterNavigate (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/Location-impl.js:24:17)
        at LocationImpl.set href [as href] (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/Location-impl.js:46:10)
        at Location.set href [as href] (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/generated/Location.js:125:37)
        at Reflect.set (<anonymous>)
        at Window.set location [as location] (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/browser/Window.js:424:15)
        at Object.<anonymous> (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/src/sdk-bridge/__tests__/experiment/code-injector.test.ts:25:30)
        at Promise.finally.completed (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1557:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1497:10)
        at _callCircusHook (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:976:40)
        at processTicksAndRejections (node:internal/process/task_queues:105:5)
        at _runTest (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:941:5)
        at /Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:849:7
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:862:11)
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:857:11)
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:857:11)
        at run (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:761:3)
        at runAndTransformResultsToJestFormat (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1918:21)
        at jestAdapter (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/runner.js:101:19)
        at runTestInternal (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:275:16)
        at runTest (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:343:7)
        at Object.worker (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:497:12) {
      type: 'not implemented'
    }

      23 |     // Mock window.location
      24 |     delete (window as any).location
    > 25 |     ;(window as any).location = {
         |                              ^
      26 |       href: 'https://example.com/path/to/page?query=value#hash',
      27 |       pathname: '/path/to/page',
      28 |       hostname: 'example.com',

      at VirtualConsole.<anonymous> (node_modules/@jest/environment-jsdom-abstract/build/index.js:87:23)
          at Reflect.set (<anonymous>)
      at Object.<anonymous> (src/sdk-bridge/__tests__/experiment/code-injector.test.ts:25:30)

  console.error
    Error: Not implemented: navigation (except hash changes)
        at module.exports (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/browser/not-implemented.js:9:17)
        at navigateFetch (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/navigation.js:77:3)
        at exports.navigate (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/navigation.js:55:3)
        at LocationImpl._locationObjectNavigate (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/Location-impl.js:30:5)
        at LocationImpl._locationObjectSetterNavigate (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/Location-impl.js:24:17)
        at LocationImpl.set href [as href] (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/Location-impl.js:46:10)
        at Location.set href [as href] (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/generated/Location.js:125:37)
        at Reflect.set (<anonymous>)
        at Window.set location [as location] (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/browser/Window.js:424:15)
        at Object.<anonymous> (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/src/sdk-bridge/__tests__/experiment/code-injector.test.ts:25:30)
        at Promise.finally.completed (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1557:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1497:10)
        at _callCircusHook (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:976:40)
        at processTicksAndRejections (node:internal/process/task_queues:105:5)
        at _runTest (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:941:5)
        at /Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:849:7
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:862:11)
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:857:11)
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:857:11)
        at run (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:761:3)
        at runAndTransformResultsToJestFormat (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1918:21)
        at jestAdapter (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/runner.js:101:19)
        at runTestInternal (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:275:16)
        at runTest (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:343:7)
        at Object.worker (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:497:12) {
      type: 'not implemented'
    }

      23 |     // Mock window.location
      24 |     delete (window as any).location
    > 25 |     ;(window as any).location = {
         |                              ^
      26 |       href: 'https://example.com/path/to/page?query=value#hash',
      27 |       pathname: '/path/to/page',
      28 |       hostname: 'example.com',

      at VirtualConsole.<anonymous> (node_modules/@jest/environment-jsdom-abstract/build/index.js:87:23)
          at Reflect.set (<anonymous>)
      at Object.<anonymous> (src/sdk-bridge/__tests__/experiment/code-injector.test.ts:25:30)

  console.error
    Error: Not implemented: navigation (except hash changes)
        at module.exports (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/browser/not-implemented.js:9:17)
        at navigateFetch (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/navigation.js:77:3)
        at exports.navigate (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/navigation.js:55:3)
        at LocationImpl._locationObjectNavigate (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/Location-impl.js:30:5)
        at LocationImpl._locationObjectSetterNavigate (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/Location-impl.js:24:17)
        at LocationImpl.set href [as href] (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/Location-impl.js:46:10)
        at Location.set href [as href] (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/generated/Location.js:125:37)
        at Reflect.set (<anonymous>)
        at Window.set location [as location] (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/browser/Window.js:424:15)
        at Object.<anonymous> (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/src/sdk-bridge/__tests__/experiment/code-injector.test.ts:25:30)
        at Promise.finally.completed (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1557:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1497:10)
        at _callCircusHook (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:976:40)
        at processTicksAndRejections (node:internal/process/task_queues:105:5)
        at _runTest (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:941:5)
        at /Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:849:7
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:862:11)
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:857:11)
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:857:11)
        at run (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:761:3)
        at runAndTransformResultsToJestFormat (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1918:21)
        at jestAdapter (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/runner.js:101:19)
        at runTestInternal (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:275:16)
        at runTest (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:343:7)
        at Object.worker (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:497:12) {
      type: 'not implemented'
    }

      23 |     // Mock window.location
      24 |     delete (window as any).location
    > 25 |     ;(window as any).location = {
         |                              ^
      26 |       href: 'https://example.com/path/to/page?query=value#hash',
      27 |       pathname: '/path/to/page',
      28 |       hostname: 'example.com',

      at VirtualConsole.<anonymous> (node_modules/@jest/environment-jsdom-abstract/build/index.js:87:23)
          at Reflect.set (<anonymous>)
      at Object.<anonymous> (src/sdk-bridge/__tests__/experiment/code-injector.test.ts:25:30)

  console.error
    Error: Not implemented: navigation (except hash changes)
        at module.exports (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/browser/not-implemented.js:9:17)
        at navigateFetch (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/navigation.js:77:3)
        at exports.navigate (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/navigation.js:55:3)
        at LocationImpl._locationObjectNavigate (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/Location-impl.js:30:5)
        at LocationImpl._locationObjectSetterNavigate (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modulePASS src/sdk-bridge/__tests__/utils/logger.test.ts
  Logger
    log
      ✓ should log messages when debug is enabled (1 ms)
      ✓ should log multiple arguments (1 ms)
      ✓ should not log when debug is disabled
    error
      ✓ should log errors when debug is enabled
      ✓ should not log errors when debug is disabled
    warn
      ✓ should log warnings when debug is enabled
      ✓ should not log warnings when debug is disabled (1 ms)
    setDebug
      ✓ should enable debug mode
      ✓ should disable debug mode (1 ms)
    isDebugEnabled
      ✓ should return debug state (1 ms)

  console.error
    Failed to save development environment: Error: Storage error
        at Object.<anonymous> (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/src/__tests__/overrides-storage.test.ts:191:41)
        at Promise.finally.completed (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1557:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1497:10)
        at _callCircusTest (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1007:40)
        at processTicksAndRejections (node:internal/process/task_queues:105:5)
        at _runTest (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:947:3)
        at /Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:849:7
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:862:11)
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:857:11)
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:857:11)
        at run (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:761:3)
        at runAndTransformResultsToJestFormat (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1918:21)
        at jestAdapter (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/runner.js:101:19)
        at runTestInternal (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:275:16)
        at runTest (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:343:7)
        at Object.worker (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:497:12)

      257 |     }
      258 |   } catch (error) {
    > 259 |     console.error('Failed to save development environment:', error)
          |             ^
      260 |   }
      261 | }
      262 |

      at saveDevelopmentEnvironment (src/utils/overrides.ts:259:13)
      at Object.<anonymous> (src/__tests__/overrides-storage.test.ts:255:9)

s/jsdom/lib/jsdom/living/window/Location-impl.js:24:17)
        at LocationImpl.set href [as href] (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/window/Location-impl.js:46:10)
        at Location.set href [as href] (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/living/generated/Location.js:125:37)
        at Reflect.set (<anonymous>)
        at Window.set location [as location] (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-environment-jsdom/node_modules/jsdom/lib/jsdom/browser/Window.js:424:15)
        at Object.<anonymous> (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/src/sdk-bridge/__tests__/experiment/code-injector.test.ts:25:30)
        at Promise.finally.completed (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1557:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1497:10)
        at _callCircusHook (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:976:40)
        at processTicksAndRejections (node:internal/process/task_queues:105:5)
        at _runTest (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:941:5)
        at /Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:849:7
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:862:11)
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:857:11)
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:857:11)
        at run (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:761:3)
        at runAndTransformResultsToJestFormat (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1918:21)
        at jestAdapter (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/runner.js:101:19)
        at runTestInternal (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:275:16)
        at runTest (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:343:7)
        at Object.worker (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:497:12) {
      type: 'not implemented'
    }

      23 |     // Mock window.location
      24 |     delete (window as any).location
    > 25 |     ;(window as any).location = {
         |                              ^
      26 |       href: 'https://example.com/path/to/page?query=value#hash',
      27 |       pathname: '/path/to/page',
      28 |       hostname: 'example.com',

      at VirtualConsole.<anonymous> (node_modules/@jest/environment-jsdom-abstract/build/index.js:87:23)
          at Reflect.set (<anonymous>)
      at Object.<anonymous> (src/sdk-bridge/__tests__/experiment/code-injector.test.ts:25:30)

  console.log
    [ABSmartly] Starting unified visual editor - Version: 3.0-UNIFIED

      at VisualEditor.start (src/visual-editor/core/visual-editor.ts:144:13)

  console.log
    [ABSmartly] Build timestamp: 2025-10-17T15:42:22.167Z

      at VisualEditor.start (src/visual-editor/core/visual-editor.ts:145:13)

  console.log
    [ABSmartly] Starting visual editor

      at VisualEditor.start (src/visual-editor/core/visual-editor.ts:158:13)

  console.log
    [ABsmartly] saveOverrides called with: { experiment1: 1, experiment2: { variant: 2, env: 1, id: 123 } }

      at saveOverrides (src/utils/overrides.ts:215:13)

  console.log
    [ABSmartly] Visual editor banner created

      at VisualEditor.start (src/visual-editor/core/visual-editor.ts:180:13)

  console.log
    [ABsmartly] Cleaned overrides: { experiment1: 1, experiment2: { variant: 2, env: 1, id: 123 } }

      at saveOverrides (src/utils/overrides.ts:225:13)

  console.log
    [ABSmartly] Visual editor is now active!

      at VisualEditor.start (src/visual-editor/core/visual-editor.ts:184:13)

  console.log
    [ABSmartly] Stopping unified visual editor

      at VisualEditor.stop (src/visual-editor/core/visual-editor.ts:204:13)

  console.error
    Trace: [ABSmartly] Stop called from:
        at VisualEditor.stop (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/src/visual-editor/core/visual-editor.ts:205:13)
        at Object.<anonymous> (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/src/visual-editor/core/__tests__/visual-editor.test.ts:492:14)
        at Promise.finally.completed (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1557:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1497:10)
        at _callCircusTest (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1007:40)
        at processTicksAndRejections (node:internal/process/task_queues:105:5)
        at _runTest (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:947:3)
        at /Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:849:7
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:862:11)
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:857:11)
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:857:11)
        at run (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:761:3)
        at runAndTransformResultsToJestFormat (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1918:21)
        at jestAdapter (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/runner.js:101:19)
        at runTestInternal (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:275:16)
        at runTest (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:343:7)
        at Object.worker (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:497:12)

      203 |
      204 |     console.log('[ABSmartly] Stopping unified visual editor')
    > 205 |     console.trace('[ABSmartly] Stop called from:')
          |             ^
      206 |
      207 |     this.isActive = false
      208 |     ;(window as any).__absmartlyVisualEditorActive = false

      at VisualEditor.stop (src/visual-editor/core/visual-editor.ts:205:13)
      at Object.<anonymous> (src/visual-editor/core/__tests__/visual-editor.test.ts:492:14)

  console.error
    Failed to save overrides: Error: Storage error
        at Object.<anonymous> (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/src/__tests__/overrides-storage.test.ts:266:41)
        at Promise.finally.completed (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1557:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1497:10)
        at _callCircusTest (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1007:40)
        at processTicksAndRejections (node:internal/process/task_queues:105:5)
        at _runTest (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:947:3)
        at /Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:849:7
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:862:11)
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:857:11)
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:857:11)
        at run (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:761:3)
        at runAndTransformResultsToJestFormat (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1918:21)
        at jestAdapter (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/runner.js:101:19)
        at runTestInternal (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:275:16)
        at runTest (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:343:7)
        at Object.worker (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:497:12)

      230 |     await syncOverridesToCookie(cleanedOverrides)
      231 |   } catch (error) {
    > 232 |     console.error('Failed to save overrides:', error)
          |             ^
      233 |   }
      234 | }
      235 |

      at saveOverrides (src/utils/overrides.ts:232:13)
      at Object.<anonymous> (src/__tests__/overrides-storage.test.ts:330:7)

  console.error
    Failed to save development environment: Error: Storage error
        at Object.<anonymous> (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/src/__tests__/overrides-storage.test.ts:266:41)
        at Promise.finally.completed (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1557:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1497:10)
        at _callCircusTest (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1007:40)
        at processTicksAndRejections (node:internal/process/task_queues:105:5)
        at _runTest (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:947:3)
        at /Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:849:7
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:862:11)
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:857:11)
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:857:11)
        at run (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:761:3)
        at runAndTransformResultsToJestFormat (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1918:21)
        at jestAdapter (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/runner.js:101:19)
        at runTestInternal (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:275:16)
        at runTest (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:343:7)
        at Object.worker (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:497:12)

      257 |     }
      258 |   } catch (error) {
    > 259 |     console.error('Failed to save development environment:', error)
          |             ^
      260 |   }
      261 | }
      262 |

      at saveDevelopmentEnvironment (src/utils/overrides.ts:259:13)
      at Object.<anonymous> (src/__tests__/overrides-storage.test.ts:345:7)

  console.log
    [ABsmartly] saveOverrides called with: { experiment1: 1 }

      at saveOverrides (src/utils/overrides.ts:215:13)

  console.log
    [ABsmartly] Cleaned overrides: { experiment1: 1 }

      at saveOverrides (src/utils/overrides.ts:225:13)

  console.error
    Failed to save overrides: Error: Storage error
        at Object.<anonymous> (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/src/__tests__/overrides-storage.test.ts:266:41)
        at Promise.finally.completed (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1557:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1497:10)
        at _callCircusTest (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1007:40)
        at processTicksAndRejections (node:internal/process/task_queues:105:5)
        at _runTest (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:947:3)
        at /Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:849:7
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:862:11)
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:857:11)
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:857:11)
        at run (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:761:3)
        at runAndTransformResultsToJestFormat (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1918:21)
        at jestAdapter (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/runner.js:101:19)
        at runTestInternal (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:275:16)
        at runTest (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:343:7)
        at Object.worker (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:497:12)

      230 |     await syncOverridesToCookie(cleanedOverrides)
      231 |   } catch (error) {
    > 232 |     console.error('Failed to save overrides:', error)
          |             ^
      233 |   }
      234 | }
      235 |

      at saveOverrides (src/utils/overrides.ts:232:13)
          at async Promise.all (index 0)
      at Object.<anonymous> (src/__tests__/overrides-storage.test.ts:368:7)

  console.error
    Failed to save development environment: Error: Storage error
        at Object.<anonymous> (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/src/__tests__/overrides-storage.test.ts:266:41)
        at Promise.finally.completed (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1557:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1497:10)
        at _callCircusTest (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1007:40)
        at processTicksAndRejections (node:internal/process/task_queues:105:5)
        at _runTest (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:947:3)
        at /Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:849:7
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:862:11)
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:857:11)
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:857:11)
        at run (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:761:3)
        at runAndTransformResultsToJestFormat (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1918:21)
        at jestAdapter (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/runner.js:101:19)
        at runTestInternal (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:275:16)
        at runTest (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:343:7)
        at Object.worker (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:497:12)

      257 |     }
      258 |   } catch (error) {
    > 259 |     console.error('Failed to save development environment:', error)
          |             ^
      260 |   }
      261 | }
      262 |

      at saveDevelopmentEnvironment (src/utils/overrides.ts:259:13)
          at async Promise.all (index 1)
      at Object.<anonymous> (src/__tests__/overrides-storage.test.ts:368:7)

PASS src/__tests__/overrides-storage.test.ts
  Storage Functions
    loadOverridesFromStorage
      ✓ should load overrides from storage successfully (1 ms)
      ✓ should return empty object when no overrides in storage
      ✓ should handle storage errors gracefully (1 ms)
    saveOverrides
      ✓ should save valid overrides to storage and sync to cookie (163 ms)
      ✓ should filter out disabled experiments (variant -1) (71 ms)
      ✓ should handle chrome API not available (56 ms)
      ✓ should handle tab query errors gracefully (14 ms)
      ✓ should handle storage errors gracefully (2 ms)
    saveDevelopmentEnvironment
      ✓ should save development environment to storage and cookie (5 ms)
      ✓ should handle special characters in environment name (2 ms)
      ✓ should handle chrome API not available (9 ms)
      ✓ should handle errors gracefully (1 ms)
    getDevelopmentEnvironment
      ✓ should load development environment from storage (1 ms)
      ✓ should return null when no environment in storage (1 ms)
      ✓ should return null for empty string
      ✓ should handle storage errors gracefully (1 ms)
    integration scenarios
      ✓ should save and load overrides correctly (12 ms)
      ✓ should save and load development environment correctly (3 ms)
      ✓ should handle concurrent operations (5 ms)

  console.log
    [ABSmartly] Final changes on exit: 0

      at VisualEditor.stop (src/visual-editor/core/visual-editor.ts:212:13)

  console.log
    [EventsDebugPage] 🔵 Received runtime message: SDK_EVENT_BROADCAST {
      type: 'SDK_EVENT_BROADCAST',
      payload: {
        eventName: 'publish',
        data: null,
        timestamp: '2025-10-17T15:42:22.137Z'
      }
    }

      at handleRuntimeMessage (src/components/EventsDebugPage.tsx:54:15)
          at Array.forEach (<anonymous>)

  console.log
    [ABSmartly] Changes were already saved

      at VisualEditor.stop (src/visual-editor/core/visual-editor.ts:221:15)

  console.log
    [EventsDebugPage] ✅ SDK_EVENT_BROADCAST received, adding event: {
      eventName: 'publish',
      data: null,
      timestamp: '2025-10-17T15:42:22.137Z'
    }

      at handleRuntimeMessage (src/components/EventsDebugPage.tsx:57:19)
          at Array.forEach (<anonymous>)

  console.log
    [ABSmartly] Teardown with restoreOriginalValues: false

      at VisualEditor.stop (src/visual-editor/core/visual-editor.ts:228:13)

  console.log
    [EventsDebugPage] Adding event to list. Current count: 3 New count: 4

      at src/components/EventsDebugPage.tsx:66:21

PASS src/sdk-bridge/__tests__/utils/url-filter.test.ts
  URLFilterMatcher
    matchesUrlFilter
      ✓ should return true when no filter is provided
      string filters
        ✓ should match exact path (1 ms)
        ✓ should not match different path (1 ms)
        ✓ should match path with wildcards
        ✓ should match path with question mark wildcard (1 ms)
      array filters
        ✓ should match if any pattern matches (1 ms)
        ✓ should not match if no patterns match
      object filters with matchType
        ✓ should match by path (default)
        ✓ should match by full URL (1 ms)
        ✓ should match by domain
        ✓ should match by query string
        ✓ should match by hash (1 ms)
      exclude patterns
        ✓ should exclude URLs matching exclude patterns
        ✓ should include URLs not matching exclude patterns (1 ms)
        ✓ should exclude with wildcards
        ✓ should check exclude patterns before include patterns (2 ms)
      regex mode
        ✓ should match with regex patterns (2 ms)
        ✓ should not match non-matching regex
        ✓ should exclude with regex patterns
        ✓ should handle invalid regex patterns gracefully (6 ms)
      wildcard mode
        ✓ should convert * to .* for any characters (1 ms)
        ✓ should convert ? to . for single character
        ✓ should require exact match with wildcards (1 ms)
      empty include patterns
        ✓ should return true if no include patterns (not excluded)
        ✓ should return false if excluded with no include patterns
      logging
        ✓ should log when URL is excluded (1 ms)
        ✓ should log when URL matches pattern
        ✓ should log when URL does not match any patterns (1 ms)
      edge cases
        ✓ should handle URLs with special characters
        ✓ should handle empty path (1 ms)
        ✓ should handle case-sensitive matching

  console.log
    [EventsDebugPage] 🔵 Received runtime message: SDK_EVENT_BROADCAST {
      type: 'SDK_EVENT_BROADCAST',
      payload: {
        eventName: 'exposure',
        data: null,
        timestamp: '2025-10-17T15:42:22.217Z'
      }
    }

      at handleRuntimeMessage (src/components/EventsDebugPage.tsx:54:15)
          at Array.forEach (<anonymous>)

  console.log
    [EventsDebugPage] ✅ SDK_EVENT_BROADCAST received, adding event: {
      eventName: 'exposure',
      data: null,
      timestamp: '2025-10-17T15:42:22.217Z'
    }

      at handleRuntimeMessage (src/components/EventsDebugPage.tsx:57:19)
          at Array.forEach (<anonymous>)

  console.log
    [VisualEditor] Constructor called with options: {
      variantName: 'test-variant',
      experimentName: 'test-experiment',
      logoUrl: 'https://example.com/logo.png',
      onChangesUpdate: [Function: mockConstructor] {
        _isMockFunction: true,
        getMockImplementation: [Function (anonymous)],
        mock: [Getter/Setter],
        mockClear: [Function (anonymous)],
        mockReset: [Function (anonymous)],
        mockRestore: [Function (anonymous)],
        mockReturnValueOnce: [Function (anonymous)],
        mockResolvedValueOnce: [Function (anonymous)],
        mockRejectedValueOnce: [Function (anonymous)],
        mockReturnValue: [Function (anonymous)],
        mockResolvedValue: [Function (anonymous)],
        mockRejectedValue: [Function (anonymous)],
        mockImplementationOnce: [Function (anonymous)],
        withImplementation: [Function: bound withImplementation],
        mockImplementation: [Function (anonymous)],
        mockReturnThis: [Function (anonymous)],
        mockName: [Function (anonymous)],
        getMockName: [Function (anonymous)],
        [Symbol(nodejs.dispose)]: [Function (anonymous)]
      },
      initialChanges: []
    }

      at new VisualEditor (src/visual-editor/core/visual-editor.ts:53:13)

  console.log
    [VisualEditor] Experiment name from options: test-experiment

      at new VisualEditor (src/visual-editor/core/visual-editor.ts:54:13)

  console.log
    [EventsDebugPage] Adding event to list. Current count: 4 New count: 5

      at src/components/EventsDebugPage.tsx:66:21

  console.log
    [VisualEditor] Constructor called with options: {
      variantName: 'test-variant',
      experimentName: 'test-experiment',
      logoUrl: 'https://example.com/logo.png',
      onChangesUpdate: [Function: mockConstructor] {
        _isMockFunction: true,
        getMockImplementation: [Function (anonymous)],
        mock: [Getter/Setter],
        mockClear: [Function (anonymous)],
        mockReset: [Function (anonymous)],
        mockRestore: [Function (anonymous)],
        mockReturnValueOnce: [Function (anonymous)],
        mockResolvedValueOnce: [Function (anonymous)],
        mockRejectedValueOnce: [Function (anonymous)],
        mockReturnValue: [Function (anonymous)],
        mockResolvedValue: [Function (anonymous)],
        mockRejectedValue: [Function (anonymous)],
        mockImplementationOnce: [Function (anonymous)],
        withImplementation: [Function: bound withImplementation],
        mockImplementation: [Function (anonymous)],
        mockReturnThis: [Function (anonymous)],
        mockName: [Function (anonymous)],
        getMockName: [Function (anonymous)],
        [Symbol(nodejs.dispose)]: [Function (anonymous)]
      },
      initialChanges: []
    }

      at new VisualEditor (src/visual-editor/core/visual-editor.ts:53:13)

  console.log
    [VisualEditor] Experiment name from options: test-experiment

      at new VisualEditor (src/visual-editor/core/visual-editor.ts:54:13)

  console.log
    [EventsDebugPage] 🔵 Received runtime message: SDK_EVENT_BROADCAST {
      type: 'SDK_EVENT_BROADCAST',
      payload: {
        eventName: 'goal',
        data: null,
        timestamp: '2025-10-17T15:42:22.234Z'
      }
    }

      at handleRuntimeMessage (src/components/EventsDebugPage.tsx:54:15)
          at Array.forEach (<anonymous>)

  console.log
    [EventsDebugPage] ✅ SDK_EVENT_BROADCAST received, adding event: {
      eventName: 'goal',
      data: null,
      timestamp: '2025-10-17T15:42:22.234Z'
    }

      at handleRuntimeMessage (src/components/EventsDebugPage.tsx:57:19)
          at Array.forEach (<anonymous>)

  console.log
    [EventsDebugPage] Adding event to list. Current count: 5 New count: 6

      at src/components/EventsDebugPage.tsx:66:21

  console.log
    [VisualEditor] Constructor called with options: {
      variantName: 'test-variant',
      experimentName: 'test-experiment',
      logoUrl: 'https://example.com/logo.png',
      onChangesUpdate: [Function: mockConstructor] {
        _isMockFunction: true,
        getMockImplementation: [Function (anonymous)],
        mock: [Getter/Setter],
        mockClear: [Function (anonymous)],
        mockReset: [Function (anonymous)],
        mockRestore: [Function (anonymous)],
        mockReturnValueOnce: [Function (anonymous)],
        mockResolvedValueOnce: [Function (anonymous)],
        mockRejectedValueOnce: [Function (anonymous)],
        mockReturnValue: [Function (anonymous)],
        mockResolvedValue: [Function (anonymous)],
        mockRejectedValue: [Function (anonymous)],
        mockImplementationOnce: [Function (anonymous)],
        withImplementation: [Function: bound withImplementation],
        mockImplementation: [Function (anonymous)],
        mockReturnThis: [Function (anonymous)],
        mockName: [Function (anonymous)],
        getMockName: [Function (anonymous)],
        [Symbol(nodejs.dispose)]: [Function (anonymous)]
      },
      initialChanges: []
    }

      at new VisualEditor (src/visual-editor/core/visual-editor.ts:53:13)

  console.log
    [VisualEditor] Experiment name from options: test-experiment

      at new VisualEditor (src/visual-editor/core/visual-editor.ts:54:13)

  console.log
    [VisualEditor] Constructor called with options: {
      variantName: 'test-variant',
      experimentName: 'test-experiment',
      logoUrl: 'https://example.com/logo.png',
      onChangesUpdate: [Function: mockConstructor] {
        _isMockFunction: true,
        getMockImplementation: [Function (anonymous)],
        mock: [Getter/Setter],
        mockClear: [Function (anonymous)],
        mockReset: [Function (anonymous)],
        mockRestore: [Function (anonymous)],
        mockReturnValueOnce: [Function (anonymous)],
        mockResolvedValueOnce: [Function (anonymous)],
        mockRejectedValueOnce: [Function (anonymous)],
        mockReturnValue: [Function (anonymous)],
        mockResolvedValue: [Function (anonymous)],
        mockRejectedValue: [Function (anonymous)],
        mockImplementationOnce: [Function (anonymous)],
        withImplementation: [Function: bound withImplementation],
        mockImplementation: [Function (anonymous)],
        mockReturnThis: [Function (anonymous)],
        mockName: [Function (anonymous)],
        getMockName: [Function (anonymous)],
        [Symbol(nodejs.dispose)]: [Function (anonymous)]
      },
      initialChanges: []
    }

      at new VisualEditor (src/visual-editor/core/visual-editor.ts:53:13)

  console.log
    [VisualEditor] Experiment name from options: test-experiment

      at new VisualEditor (src/visual-editor/core/visual-editor.ts:54:13)

  console.log
    [ABSmartly] Saving changes - raw count: 2

      at VisualEditor.saveChanges (src/visual-editor/core/visual-editor.ts:470:13)

  console.log
    [EventsDebugPage] 🔵 Received runtime message: SDK_EVENT_BROADCAST {
      type: 'SDK_EVENT_BROADCAST',
      payload: {
        eventName: 'finalize',
        data: null,
        timestamp: '2025-10-17T15:42:22.241Z'
      }
    }

      at handleRuntimeMessage (src/components/EventsDebugPage.tsx:54:15)
          at Array.forEach (<anonymous>)

  console.log
    [EventsDebugPage] ✅ SDK_EVENT_BROADCAST received, adding event: {
      eventName: 'finalize',
      data: null,
      timestamp: '2025-10-17T15:42:22.241Z'
    }

      at handleRuntimeMessage (src/components/EventsDebugPage.tsx:57:19)
          at Array.forEach (<anonymous>)

  console.log
    [EventsDebugPage] Adding event to list. Current count: 6 New count: 7

      at src/components/EventsDebugPage.tsx:66:21

  console.log
    [ABSmartly] Squashing changes from 2 to consolidated list

      at VisualEditor.squashChanges (src/visual-editor/core/visual-editor.ts:347:13)

  console.log
    [ABSmartly] Squashed to 2 changes

      at VisualEditor.squashChanges (src/visual-editor/core/visual-editor.ts:377:13)

  console.log
    [ABSmartly] Squashed changes count: 2

      at VisualEditor.saveChanges (src/visual-editor/core/visual-editor.ts:474:13)

  console.log
    [ABSmartly] Storing original values in DOM for 2 changes

      at VisualEditor.storeOriginalValuesInDOM (src/visual-editor/core/visual-editor.ts:394:13)

  console.log
    [EditorCoordinator] setupAll called

      at EditorCoordinator.setupAll (src/visual-editor/core/editor-coordinator.ts:1017:13)

  console.log
    [EditorCoordinator] setupAll completed

      at EditorCoordinator.setupAll (src/visual-editor/core/editor-coordinator.ts:1027:13)

  console.log
    [ABSmartly] Sending squashed changes to sidebar:

      at VisualEditor.saveChanges (src/visual-editor/core/visual-editor.ts:480:13)

  console.log
    [EditorCoordinator] Starting teardownAll { restoreOriginalValues: true }

      at EditorCoordinator.teardownAll (src/visual-editor/core/editor-coordinator.ts:1032:13)

  console.log
    [EditorCoordinator] teardownAll completed

      at EditorCoordinator.teardownAll (src/visual-editor/core/editor-coordinator.ts:1045:13)

  console.log
    [VisualEditor] Constructor called with options: {
      variantName: 'test-variant',
      experimentName: 'test-experiment',
      logoUrl: 'https://example.com/logo.png',
      onChangesUpdate: [Function: mockConstructor] {
        _isMockFunction: true,
        getMockImplementation: [Function (anonymous)],
        mock: [Getter/Setter],
        mockClear: [Function (anonymous)],
        mockReset: [Function (anonymous)],
        mockRestore: [Function (anonymous)],
        mockReturnValueOnce: [Function (anonymous)],
        mockResolvedValueOnce: [Function (anonymous)],
        mockRejectedValueOnce: [Function (anonymous)],
        mockReturnValue: [Function (anonymous)],
        mockResolvedValue: [Function (anonymous)],
        mockRejectedValue: [Function (anonymous)],
        mockImplementationOnce: [Function (anonymous)],
        withImplementation: [Function: bound withImplementation],
        mockImplementation: [Function (anonymous)],
        mockReturnThis: [Function (anonymous)],
        mockName: [Function (anonymous)],
        getMockName: [Function (anonymous)],
        [Symbol(nodejs.dispose)]: [Function (anonymous)]
      },
      initialChanges: []
    }

      at new VisualEditor (src/visual-editor/core/visual-editor.ts:53:13)

  console.log
    [VisualEditor] Experiment name from options: test-experiment

      at new VisualEditor (src/visual-editor/core/visual-editor.ts:54:13)

  console.log
    [EventsDebugPage] ❌ Removing message listeners

      at src/components/EventsDebugPage.tsx:88:15
          at Array.forEach (<anonymous>)

  console.log
    [EditorCoordinator] setupAll called

      at EditorCoordinator.setupAll (src/visual-editor/core/editor-coordinator.ts:1017:13)

  console.log
    [VisualEditor] Constructor called with options: {
      variantName: 'test-variant',
      experimentName: 'test-experiment',
      logoUrl: 'https://example.com/logo.png',
      onChangesUpdate: [Function: mockConstructor] {
        _isMockFunction: true,
        getMockImplementation: [Function (anonymous)],
        mock: [Getter/Setter],
        mockClear: [Function (anonymous)],
        mockReset: [Function (anonymous)],
        mockRestore: [Function (anonymous)],
        mockReturnValueOnce: [Function (anonymous)],
        mockResolvedValueOnce: [Function (anonymous)],
        mockRejectedValueOnce: [Function (anonymous)],
        mockReturnValue: [Function (anonymous)],
        mockResolvedValue: [Function (anonymous)],
        mockRejectedValue: [Function (anonymous)],
        mockImplementationOnce: [Function (anonymous)],
        withImplementation: [Function: bound withImplementation],
        mockImplementation: [Function (anonymous)],
        mockReturnThis: [Function (anonymous)],
        mockName: [Function (anonymous)],
        getMockName: [Function (anonymous)],
        [Symbol(nodejs.dispose)]: [Function (anonymous)]
      },
      initialChanges: []
    }

      at new VisualEditor (src/visual-editor/core/visual-editor.ts:53:13)

  console.log
    [VisualEditor] Experiment name from options: test-experiment

      at new VisualEditor (src/visual-editor/core/visual-editor.ts:54:13)

  console.log
    [EditorCoordinator] setupAll completed

      at EditorCoordinator.setupAll (src/visual-editor/core/editor-coordinator.ts:1027:13)

  console.log
    [handleEditAction] START for element: HTMLDivElement {}

      at EditorCoordinator.handleEditAction (src/visual-editor/core/editor-coordinator.ts:360:13)

  console.log
    [handleEditAction] Element details: DIV test-element test-class

      at EditorCoordinator.handleEditAction (src/visual-editor/core/editor-coordinator.ts:361:13)

  console.log
    [EventsDebugPage] 🔵 Component mounted, fetching buffered events...

      at src/components/EventsDebugPage.tsx:33:13

  console.log
    [EventsDebugPage] GET_BUFFERED_EVENTS response: { success: true, events: [] }

      at src/components/EventsDebugPage.tsx:39:15

  console.log
    [EventsDebugPage] ✅ Loaded 0 buffered events

      at src/components/EventsDebugPage.tsx:41:17

  console.log
    [EventsDebugPage] ✅ Registered message listeners

      at src/components/EventsDebugPage.tsx:83:13

  console.log
    [ABSmartly] Saving changes - raw count: 0

      at VisualEditor.saveChanges (src/visual-editor/core/visual-editor.ts:470:13)

  console.log
    [ABSmartly] Squashing changes from 0 to consolidated list

      at VisualEditor.squashChanges (src/visual-editor/core/visual-editor.ts:347:13)

  console.log
    [EditorCoordinator] Changes/Undo/Redo updated - total changes: 1

      at src/visual-editor/core/editor-coordinator.ts:143:17

  console.log
    [EditorCoordinator] Session changes (undo count): 1

      at src/visual-editor/core/editor-coordinator.ts:144:17

  console.log
    [ABSmartly] Squashed to 0 changes

      at VisualEditor.squashChanges (src/visual-editor/core/visual-editor.ts:377:13)

  console.log
    [ABSmartly] Squashed changes count: 0

      at VisualEditor.saveChanges (src/visual-editor/core/visual-editor.ts:474:13)

  console.log
    [EditorCoordinator] Redo count: 0

      at src/visual-editor/core/editor-coordinator.ts:145:17

  console.log
    [ABSmartly] Storing original values in DOM for 0 changes

      at VisualEditor.storeOriginalValuesInDOM (src/visual-editor/core/visual-editor.ts:394:13)

  console.log
    [ABSmartly] Sending squashed changes to sidebar:

      at VisualEditor.saveChanges (src/visual-editor/core/visual-editor.ts:480:13)

  console.log
    [VisualEditor] Constructor called with options: {
      variantName: 'test-variant',
      experimentName: 'test-experiment',
      logoUrl: 'https://example.com/logo.png',
      onChangesUpdate: [Function: mockConstructor] {
        _isMockFunction: true,
        getMockImplementation: [Function (anonymous)],
        mock: [Getter/Setter],
        mockClear: [Function (anonymous)],
        mockReset: [Function (anonymous)],
        mockRestore: [Function (anonymous)],
        mockReturnValueOnce: [Function (anonymous)],
        mockResolvedValueOnce: [Function (anonymous)],
        mockRejectedValueOnce: [Function (anonymous)],
        mockReturnValue: [Function (anonymous)],
        mockResolvedValue: [Function (anonymous)],
        mockRejectedValue: [Function (anonymous)],
        mockImplementationOnce: [Function (anonymous)],
        withImplementation: [Function: bound withImplementation],
        mockImplementation: [Function (anonymous)],
        mockReturnThis: [Function (anonymous)],
        mockName: [Function (anonymous)],
        getMockName: [Function (anonymous)],
        [Symbol(nodejs.dispose)]: [Function (anonymous)]
      },
      initialChanges: []
    }

      at new VisualEditor (src/visual-editor/core/visual-editor.ts:53:13)

  console.log
    [VisualEditor] Experiment name from options: test-experiment

      at new VisualEditor (src/visual-editor/core/visual-editor.ts:54:13)

  console.log
    [ABSmartly] Saving changes - raw count: 0

      at VisualEditor.saveChanges (src/visual-editor/core/visual-editor.ts:470:13)

  console.log
    [ABSmartly] Squashing changes from 0 to consolidated list

      at VisualEditor.squashChanges (src/visual-editor/core/visual-editor.ts:347:13)

  console.log
    [ABSmartly] Squashed to 0 changes

      at VisualEditor.squashChanges (src/visual-editor/core/visual-editor.ts:377:13)

  console.log
    [ABSmartly] Squashed changes count: 0

      at VisualEditor.saveChanges (src/visual-editor/core/visual-editor.ts:474:13)

  console.log
    [ABSmartly] Storing original values in DOM for 0 changes

      at VisualEditor.storeOriginalValuesInDOM (src/visual-editor/core/visual-editor.ts:394:13)

  console.log
    [ABSmartly] Sending squashed changes to sidebar:

      at VisualEditor.saveChanges (src/visual-editor/core/visual-editor.ts:480:13)

  console.log
    [VisualEditor] Constructor called with options: {
      variantName: 'test-variant',
      experimentName: 'test-experiment',
      logoUrl: 'https://example.com/logo.png',
      onChangesUpdate: [Function: mockConstructor] {
        _isMockFunction: true,
        getMockImplementation: [Function (anonymous)],
        mock: [Getter/Setter],
        mockClear: [Function (anonymous)],
        mockReset: [Function (anonymous)],
        mockRestore: [Function (anonymous)],
        mockReturnValueOnce: [Function (anonymous)],
        mockResolvedValueOnce: [Function (anonymous)],
        mockRejectedValueOnce: [Function (anonymous)],
        mockReturnValue: [Function (anonymous)],
        mockResolvedValue: [Function (anonymous)],
        mockRejectedValue: [Function (anonymous)],
        mockImplementationOnce: [Function (anonymous)],
        withImplementation: [Function: bound withImplementation],
        mockImplementation: [Function (anonymous)],
        mockReturnThis: [Function (anonymous)],
        mockName: [Function (anonymous)],
        getMockName: [Function (anonymous)],
        [Symbol(nodejs.dispose)]: [Function (anonymous)]
      },
      initialChanges: []
    }

      at new VisualEditor (src/visual-editor/core/visual-editor.ts:53:13)

  console.log
    [VisualEditor] Experiment name from options: test-experiment

      at new VisualEditor (src/visual-editor/core/visual-editor.ts:54:13)

  console.log
    [VisualEditor] Constructor called with options: {
      variantName: 'test-variant',
      experimentName: 'test-experiment',
      logoUrl: 'https://example.com/logo.png',
      onChangesUpdate: [Function: mockConstructor] {
        _isMockFunction: true,
        getMockImplementation: [Function (anonymous)],
        mock: [Getter/Setter],
        mockClear: [Function (anonymous)],
        mockReset: [Function (anonymous)],
        mockRestore: [Function (anonymous)],
        mockReturnValueOnce: [Function (anonymous)],
        mockResolvedValueOnce: [Function (anonymous)],
        mockRejectedValueOnce: [Function (anonymous)],
        mockReturnValue: [Function (anonymous)],
        mockResolvedValue: [Function (anonymous)],
        mockRejectedValue: [Function (anonymous)],
        mockImplementationOnce: [Function (anonymous)],
        withImplementation: [Function: bound withImplementation],
        mockImplementation: [Function (anonymous)],
        mockReturnThis: [Function (anonymous)],
        mockName: [Function (anonymous)],
        getMockName: [Function (anonymous)],
        [Symbol(nodejs.dispose)]: [Function (anonymous)]
      },
      initialChanges: []
    }

      at new VisualEditor (src/visual-editor/core/visual-editor.ts:53:13)

  console.log
    [VisualEditor] Experiment name from options: test-experiment

      at new VisualEditor (src/visual-editor/core/visual-editor.ts:54:13)

  console.log
    [EventsDebugPage] 🔵 Received runtime message: SDK_EVENT_BROADCAST {
      type: 'SDK_EVENT_BROADCAST',
      payload: {
        eventName: 'ready',
        data: null,
        timestamp: '2025-10-17T15:42:22.307Z'
      }
    }

      at handleRuntimeMessage (src/components/EventsDebugPage.tsx:54:15)
          at Array.forEach (<anonymous>)

  console.log
    [EventsDebugPage] ⚠️ SDK_EVENT_BROADCAST received but capture is paused

      at handleRuntimeMessage (src/components/EventsDebugPage.tsx:70:19)
          at Array.forEach (<anonymous>)

PASS src/sdk-bridge/__tests__/utils/message-bridge.test.ts
  MessageBridge
    sendToExtension
      ✓ should post message to window (1 ms)
      ✓ should log the message (1 ms)
    onMessage
      ✓ should call handler for matching message type (1 ms)
      ✓ should not call handler for different message type
      ✓ should not call handler for messages from other sources
    onAnyMessage
      ✓ should call handler for any extension message (1 ms)
      ✓ should not call handler for non-extension messages (1 ms)

  console.log
    [VisualEditor] Constructor called with options: {
      variantName: 'test-variant',
      experimentName: 'test-experiment',
      logoUrl: 'https://example.com/logo.png',
      onChangesUpdate: [Function: mockConstructor] {
        _isMockFunction: true,
        getMockImplementation: [Function (anonymous)],
        mock: [Getter/Setter],
        mockClear: [Function (anonymous)],
        mockReset: [Function (anonymous)],
        mockRestore: [Function (anonymous)],
        mockReturnValueOnce: [Function (anonymous)],
        mockResolvedValueOnce: [Function (anonymous)],
        mockRejectedValueOnce: [Function (anonymous)],
        mockReturnValue: [Function (anonymous)],
        mockResolvedValue: [Function (anonymous)],
        mockRejectedValue: [Function (anonymous)],
        mockImplementationOnce: [Function (anonymous)],
        withImplementation: [Function: bound withImplementation],
        mockImplementation: [Function (anonymous)],
        mockReturnThis: [Function (anonymous)],
        mockName: [Function (anonymous)],
        getMockName: [Function (anonymous)],
        [Symbol(nodejs.dispose)]: [Function (anonymous)]
      },
      initialChanges: []
    }

      at new VisualEditor (src/visual-editor/core/visual-editor.ts:53:13)

  console.log
    [VisualEditor] Experiment name from options: test-experiment

      at new VisualEditor (src/visual-editor/core/visual-editor.ts:54:13)

  console.log
    [ABSmartly] Starting unified visual editor - Version: 3.0-UNIFIED

      at VisualEditor.start (src/visual-editor/core/visual-editor.ts:144:13)

  console.log
    [ABSmartly] Build timestamp: 2025-10-17T15:42:22.312Z

      at VisualEditor.start (src/visual-editor/core/visual-editor.ts:145:13)

  console.log
    [ABSmartly] Starting visual editor

      at VisualEditor.start (src/visual-editor/core/visual-editor.ts:158:13)

  console.log
    [ABSmartly] Visual editor banner created

      at VisualEditor.start (src/visual-editor/core/visual-editor.ts:180:13)

  console.log
    [ABSmartly] Visual editor is now active!

      at VisualEditor.start (src/visual-editor/core/visual-editor.ts:184:13)

  console.log
    [VisualEditor] Constructor called with options: {
      variantName: 'test-variant',
      experimentName: 'test-experiment',
      logoUrl: 'https://example.com/logo.png',
      onChangesUpdate: [Function: mockConstructor] {
        _isMockFunction: true,
        getMockImplementation: [Function (anonymous)],
        mock: [Getter/Setter],
        mockClear: [Function (anonymous)],
        mockReset: [Function (anonymous)],
        mockRestore: [Function (anonymous)],
        mockReturnValueOnce: [Function (anonymous)],
        mockResolvedValueOnce: [Function (anonymous)],
        mockRejectedValueOnce: [Function (anonymous)],
        mockReturnValue: [Function (anonymous)],
        mockResolvedValue: [Function (anonymous)],
        mockRejectedValue: [Function (anonymous)],
        mockImplementationOnce: [Function (anonymous)],
        withImplementation: [Function: bound withImplementation],
        mockImplementation: [Function (anonymous)],
        mockReturnThis: [Function (anonymous)],
        mockName: [Function (anonymous)],
        getMockName: [Function (anonymous)],
        [Symbol(nodejs.dispose)]: [Function (anonymous)]
      },
      initialChanges: []
    }

      at new VisualEditor (src/visual-editor/core/visual-editor.ts:53:13)

  console.log
    [VisualEditor] Experiment name from options: test-experiment

      at new VisualEditor (src/visual-editor/core/visual-editor.ts:54:13)

  console.log
    [ABSmartly] Starting unified visual editor - Version: 3.0-UNIFIED

      at VisualEditor.start (src/visual-editor/core/visual-editor.ts:144:13)

PASS src/visual-editor/core/__tests__/editor-coordinator.test.ts (8.257 s)
  EditorCoordinator
    Constructor
      ✓ should initialize with all dependencies (22 ms)
      ✓ should store all dependencies as instance properties (173 ms)
      ✓ should initialize internal state properties (54 ms)
    setupModuleIntegrations
      ✓ should connect event handlers to context menu (4 ms)
      ✓ should connect context menu to action handlers (206 ms)
      ✓ should connect UI components to callbacks (2 ms)
      ✓ should register cleanup handlers (14 ms)
    setupStateListeners
      ✓ should register state change listener (1 ms)
      ✓ should update local state when state changes (5 ms)
      ✓ should update toolbar on state change (6 ms)
    setupEventListeners & removeEventListeners
      ✓ should setup all event listeners (2 ms)
      ✓ should remove all event listeners (2 ms)
      ✓ should handle placeholder events without errors (5 ms)
    setupKeyboardHandlers
      ✓ should setup keyboard event listener (6 ms)
      ✓ should handle Ctrl+Z for undo (2 ms)
      ✓ should handle Cmd+Z for undo on Mac (3 ms)
      ✓ should handle Ctrl+Y for redo (23 ms)
      ✓ should handle Ctrl+Shift+Z for redo (1 ms)
      ✓ should handle Ctrl+Shift+C for copy selector (3 ms)
      ✓ should handle Delete key for element deletion (4 ms)
      ✓ should not handle Delete key when in editing mode (3 ms)
      ✓ should not handle shortcuts when no element is selected (1 ms)
    setupMessageHandlers
      ✓ should setup message event listener (3 ms)
      ✓ should handle ABSMARTLY_VISUAL_EDITOR_EXIT message (2 ms)
      ✓ should ignore messages not from window (2 ms)
    handleMenuAction
      ✓ should handle edit action (16 ms)
      ✓ should handle edit-element action (56 ms)
      ✓ should handle editHtml action (15 ms)
      ✓ should handle edit-html action (12 ms)
      ✓ should handle rearrange action (10 ms)
      ✓ should handle resize action (11 ms)
      ✓ should handle select-relative action (42 ms)
      ✓ should handle selectRelative action (41 ms)
      ✓ should handle hide action (11 ms)
      ✓ should handle delete action (6 ms)
      ✓ should handle copy action (7 ms)
      ✓ should handle copy-selector action (17 ms)
      ✓ should handle copySelector action (44 ms)
      ✓ should handle move-up action (16 ms)
      ✓ should handle move-down action (29 ms)
      ✓ should handle insert-block action (14 ms)
      ✓ should handle unknown action with notification (8 ms)
      ✓ should preserve original state for all actions (18 ms)
    handleEditAction
      ✓ should setup element for editing (8 ms)
      ✓ should handle blur event and create change (15 ms)
      ✓ should handle Enter key to finish editing (30 ms)
      ✓ should handle Shift+Enter without finishing editing (23 ms)
      ✓ should handle Escape key to cancel editing (17 ms)
      ✓ should prevent click events during editing (5 ms)
    handleEditHtmlAction
      ✓ should open HTML editor and handle changes (16 ms)
    handleSelectRelativeElement
      ✓ should show relative element selector panel (40 ms)
      ✓ should remove context menu before showing selector (5 ms)
    startMutationObserver & stopMutationObserver
      ✓ should create and start mutation observer
      ✓ should ignore mutations when isInternalChange is true (3 ms)
      ✓ should stop and disconnect mutation observer (114 ms)
      ✓ should handle stopMutationObserver when observer is null (8 ms)
    makeElementsEditable & makeElementsNonEditable
      ✓ should make all non-extension elements editable (13 ms)
      ✓ should make all elements non-editable (3 ms)
    showContextMenu & removeContextMenu
      ✓ should show context menu for selected element (1 ms)
      ✓ should not show context menu when no element is selected (41 ms)
      ✓ should remove context menu elements from DOM (16 ms)
    isExtensionElement
      ✓ should identify elements with absmartly in id (2 ms)
      ✓ should identify elements with absmartly in className (5 ms)
      ✓ should identify elements with absmartly parent (12 ms)
      ✓ should handle SVG elements with baseVal className (3 ms)
      ✓ should return false for non-extension elements (20 ms)
    setupAll
      ✓ should call all setup methods in correct order (4 ms)
    teardownAll
      ✓ should call all teardown methods in correct order (5 ms)
    Integration Tests
      ✓ should handle complete edit workflow (8 ms)
      ✓ should handle keyboard shortcuts integration (9 ms)
      ✓ should handle state changes and update UI (5 ms)
    Event Cleanup
      ✓ should register keydown event cleanup handler (3 ms)
      ✓ should register message event cleanup handler (3 ms)
      ✓ should handle message event for visual editor exit (5 ms)

  console.log
    [ABSmartly] Build timestamp: 2025-10-17T15:42:22.317Z

      at VisualEditor.start (src/visual-editor/core/visual-editor.ts:145:13)

  console.log
    [ABSmartly] Starting visual editor

      at VisualEditor.start (src/visual-editor/core/visual-editor.ts:158:13)

  console.log
    [ABSmartly] Visual editor banner created

      at VisualEditor.start (src/visual-editor/core/visual-editor.ts:180:13)

  console.log
    [ABSmartly] Visual editor is now active!

      at VisualEditor.start (src/visual-editor/core/visual-editor.ts:184:13)

  console.log
    [ABSmartly] Stopping unified visual editor

      at VisualEditor.stop (src/visual-editor/core/visual-editor.ts:204:13)

  console.error
    Trace: [ABSmartly] Stop called from:
        at VisualEditor.stop (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/src/visual-editor/core/visual-editor.ts:205:13)
        at Object.<anonymous> (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/src/visual-editor/core/__tests__/visual-editor.test.ts:704:14)
        at Promise.finally.completed (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1557:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1497:10)
        at _callCircusTest (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1007:40)
        at processTicksAndRejections (node:internal/process/task_queues:105:5)
        at _runTest (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:947:3)
        at /Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:849:7
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:862:11)
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:857:11)
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:857:11)
        at run (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:761:3)
        at runAndTransformResultsToJestFormat (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1918:21)
        at jestAdapter (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/runner.js:101:19)
        at runTestInternal (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:275:16)
        at runTest (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:343:7)
        at Object.worker (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:497:12)

      203 |
      204 |     console.log('[ABSmartly] Stopping unified visual editor')
    > 205 |     console.trace('[ABSmartly] Stop called from:')
          |             ^
      206 |
      207 |     this.isActive = false
      208 |     ;(window as any).__absmartlyVisualEditorActive = false

      at VisualEditor.stop (src/visual-editor/core/visual-editor.ts:205:13)
      at Object.<anonymous> (src/visual-editor/core/__tests__/visual-editor.test.ts:704:14)

  console.log
    [ABSmartly] Final changes on exit: 0

      at VisualEditor.stop (src/visual-editor/core/visual-editor.ts:212:13)

  console.log
    [ABSmartly] Changes were already saved

      at VisualEditor.stop (src/visual-editor/core/visual-editor.ts:221:15)

  console.log
    [ABSmartly] Teardown with restoreOriginalValues: false

      at VisualEditor.stop (src/visual-editor/core/visual-editor.ts:228:13)

  console.log
    [VisualEditor] Constructor called with options: {
      variantName: 'test-variant',
      experimentName: 'test-experiment',
      logoUrl: 'https://example.com/logo.png',
      onChangesUpdate: [Function: mockConstructor] {
        _isMockFunction: true,
        getMockImplementation: [Function (anonymous)],
        mock: [Getter/Setter],
        mockClear: [Function (anonymous)],
        mockReset: [Function (anonymous)],
        mockRestore: [Function (anonymous)],
        mockReturnValueOnce: [Function (anonymous)],
        mockResolvedValueOnce: [Function (anonymous)],
        mockRejectedValueOnce: [Function (anonymous)],
        mockReturnValue: [Function (anonymous)],
        mockResolvedValue: [Function (anonymous)],
        mockRejectedValue: [Function (anonymous)],
        mockImplementationOnce: [Function (anonymous)],
        withImplementation: [Function: bound withImplementation],
        mockImplementation: [Function (anonymous)],
        mockReturnThis: [Function (anonymous)],
        mockName: [Function (anonymous)],
        getMockName: [Function (anonymous)],
        [Symbol(nodejs.dispose)]: [Function (anonymous)]
      },
      initialChanges: []
    }

      at new VisualEditor (src/visual-editor/core/visual-editor.ts:53:13)

  console.log
    [VisualEditor] Experiment name from options: test-experiment

      at new VisualEditor (src/visual-editor/core/visual-editor.ts:54:13)

  console.log
    [VisualEditor] Constructor called with options: {
      variantName: 'test-variant',
      experimentName: 'test-experiment',
      logoUrl: 'https://example.com/logo.png',
      onChangesUpdate: [Function: mockConstructor] {
        _isMockFunction: true,
        getMockImplementation: [Function (anonymous)],
        mock: [Getter/Setter],
        mockClear: [Function (anonymous)],
        mockReset: [Function (anonymous)],
        mockRestore: [Function (anonymous)],
        mockReturnValueOnce: [Function (anonymous)],
        mockResolvedValueOnce: [Function (anonymous)],
        mockRejectedValueOnce: [Function (anonymous)],
        mockReturnValue: [Function (anonymous)],
        mockResolvedValue: [Function (anonymous)],
        mockRejectedValue: [Function (anonymous)],
        mockImplementationOnce: [Function (anonymous)],
        withImplementation: [Function: bound withImplementation],
        mockImplementation: [Function (anonymous)],
        mockReturnThis: [Function (anonymous)],
        mockName: [Function (anonymous)],
        getMockName: [Function (anonymous)],
        [Symbol(nodejs.dispose)]: [Function (anonymous)]
      },
      initialChanges: []
    }

      at new VisualEditor (src/visual-editor/core/visual-editor.ts:53:13)

  console.log
    [VisualEditor] Experiment name from options: test-experiment

      at new VisualEditor (src/visual-editor/core/visual-editor.ts:54:13)

  console.log
    [VisualEditor] Constructor called with options: {
      variantName: 'test-variant',
      experimentName: 'test-experiment',
      logoUrl: 'https://example.com/logo.png',
      onChangesUpdate: [Function: mockConstructor] {
        _isMockFunction: true,
        getMockImplementation: [Function (anonymous)],
        mock: [Getter/Setter],
        mockClear: [Function (anonymous)],
        mockReset: [Function (anonymous)],
        mockRestore: [Function (anonymous)],
        mockReturnValueOnce: [Function (anonymous)],
        mockResolvedValueOnce: [Function (anonymous)],
        mockRejectedValueOnce: [Function (anonymous)],
        mockReturnValue: [Function (anonymous)],
        mockResolvedValue: [Function (anonymous)],
        mockRejectedValue: [Function (anonymous)],
        mockImplementationOnce: [Function (anonymous)],
        withImplementation: [Function: bound withImplementation],
        mockImplementation: [Function (anonymous)],
        mockReturnThis: [Function (anonymous)],
        mockName: [Function (anonymous)],
        getMockName: [Function (anonymous)],
        [Symbol(nodejs.dispose)]: [Function (anonymous)]
      },
      initialChanges: []
    }

      at new VisualEditor (src/visual-editor/core/visual-editor.ts:53:13)

  console.log
    [VisualEditor] Experiment name from options: test-experiment

      at new VisualEditor (src/visual-editor/core/visual-editor.ts:54:13)

  console.log
    [ABSmartly] Starting unified visual editor - Version: 3.0-UNIFIED

      at VisualEditor.start (src/visual-editor/core/visual-editor.ts:144:13)

  console.log
    [ABSmartly] Build timestamp: 2025-10-17T15:42:22.339Z

      at VisualEditor.start (src/visual-editor/core/visual-editor.ts:145:13)

  console.log
    [ABSmartly] Starting visual editor

      at VisualEditor.start (src/visual-editor/core/visual-editor.ts:158:13)

  console.log
    [ABSmartly] Visual editor banner created

      at VisualEditor.start (src/visual-editor/core/visual-editor.ts:180:13)

  console.log
    [ABSmartly] Visual editor is now active!

      at VisualEditor.start (src/visual-editor/core/visual-editor.ts:184:13)

  console.log
    [VisualEditor] Constructor called with options: {
      variantName: 'test-variant',
      experimentName: 'test-experiment',
      logoUrl: 'https://example.com/logo.png',
      onChangesUpdate: [Function: mockConstructor] {
        _isMockFunction: true,
        getMockImplementation: [Function (anonymous)],
        mock: [Getter/Setter],
        mockClear: [Function (anonymous)],
        mockReset: [Function (anonymous)],
        mockRestore: [Function (anonymous)],
        mockReturnValueOnce: [Function (anonymous)],
        mockResolvedValueOnce: [Function (anonymous)],
        mockRejectedValueOnce: [Function (anonymous)],
        mockReturnValue: [Function (anonymous)],
        mockResolvedValue: [Function (anonymous)],
        mockRejectedValue: [Function (anonymous)],
        mockImplementationOnce: [Function (anonymous)],
        withImplementation: [Function: bound withImplementation],
        mockImplementation: [Function (anonymous)],
        mockReturnThis: [Function (anonymous)],
        mockName: [Function (anonymous)],
        getMockName: [Function (anonymous)],
        [Symbol(nodejs.dispose)]: [Function (anonymous)]
      },
      initialChanges: []
    }

      at new VisualEditor (src/visual-editor/core/visual-editor.ts:53:13)

  console.log
    [VisualEditor] Experiment name from options: test-experiment

      at new VisualEditor (src/visual-editor/core/visual-editor.ts:54:13)

  console.log
    [VisualEditor] Constructor called with options: {
      variantName: 'test-variant',
      experimentName: 'test-experiment',
      logoUrl: 'https://example.com/logo.png',
      onChangesUpdate: [Function: mockConstructor] {
        _isMockFunction: true,
        getMockImplementation: [Function (anonymous)],
        mock: [Getter/Setter],
        mockClear: [Function (anonymous)],
        mockReset: [Function (anonymous)],
        mockRestore: [Function (anonymous)],
        mockReturnValueOnce: [Function (anonymous)],
        mockResolvedValueOnce: [Function (anonymous)],
        mockRejectedValueOnce: [Function (anonymous)],
        mockReturnValue: [Function (anonymous)],
        mockResolvedValue: [Function (anonymous)],
        mockRejectedValue: [Function (anonymous)],
        mockImplementationOnce: [Function (anonymous)],
        withImplementation: [Function: bound withImplementation],
        mockImplementation: [Function (anonymous)],
        mockReturnThis: [Function (anonymous)],
        mockName: [Function (anonymous)],
        getMockName: [Function (anonymous)],
        [Symbol(nodejs.dispose)]: [Function (anonymous)]
      },
      initialChanges: []
    }

      at new VisualEditor (src/visual-editor/core/visual-editor.ts:53:13)

  console.log
    [VisualEditor] Experiment name from options: test-experiment

      at new VisualEditor (src/visual-editor/core/visual-editor.ts:54:13)

  console.log
    [ABSmartly] Starting unified visual editor - Version: 3.0-UNIFIED

      at VisualEditor.start (src/visual-editor/core/visual-editor.ts:144:13)

  console.log
    [ABSmartly] Build timestamp: 2025-10-17T15:42:22.350Z

      at VisualEditor.start (src/visual-editor/core/visual-editor.ts:145:13)

  console.log
    [ABSmartly] Starting visual editor

      at VisualEditor.start (src/visual-editor/core/visual-editor.ts:158:13)

  console.log
    [ABSmartly] Visual editor banner created

      at VisualEditor.start (src/visual-editor/core/visual-editor.ts:180:13)

  console.log
    [ABSmartly] Visual editor is now active!

      at VisualEditor.start (src/visual-editor/core/visual-editor.ts:184:13)

  console.log
    [ABSmartly] Starting unified visual editor - Version: 3.0-UNIFIED

      at VisualEditor.start (src/visual-editor/core/visual-editor.ts:144:13)

  console.log
    [ABSmartly] Build timestamp: 2025-10-17T15:42:22.352Z

      at VisualEditor.start (src/visual-editor/core/visual-editor.ts:145:13)

  console.log
    [ABSmartly] Visual editor already active

      at VisualEditor.start (src/visual-editor/core/visual-editor.ts:149:15)

  console.log
    [ABSmartly] Starting unified visual editor - Version: 3.0-UNIFIED

      at VisualEditor.start (src/visual-editor/core/visual-editor.ts:144:13)

  console.log
    [ABSmartly] Build timestamp: 2025-10-17T15:42:22.365Z

      at VisualEditor.start (src/visual-editor/core/visual-editor.ts:145:13)

  console.log
    [ABSmartly] Visual editor already active

      at VisualEditor.start (src/visual-editor/core/visual-editor.ts:149:15)

  console.log
    [VisualEditor] Constructor called with options: {
      variantName: 'test-variant',
      experimentName: 'test-experiment',
      logoUrl: 'https://example.com/logo.png',
      onChangesUpdate: [Function: mockConstructor] {
        _isMockFunction: true,
        getMockImplementation: [Function (anonymous)],
        mock: [Getter/Setter],
        mockClear: [Function (anonymous)],
        mockReset: [Function (anonymous)],
        mockRestore: [Function (anonymous)],
        mockReturnValueOnce: [Function (anonymous)],
        mockResolvedValueOnce: [Function (anonymous)],
        mockRejectedValueOnce: [Function (anonymous)],
        mockReturnValue: [Function (anonymous)],
        mockResolvedValue: [Function (anonymous)],
        mockRejectedValue: [Function (anonymous)],
        mockImplementationOnce: [Function (anonymous)],
        withImplementation: [Function: bound withImplementation],
        mockImplementation: [Function (anonymous)],
        mockReturnThis: [Function (anonymous)],
        mockName: [Function (anonymous)],
        getMockName: [Function (anonymous)],
        [Symbol(nodejs.dispose)]: [Function (anonymous)]
      },
      initialChanges: []
    }

      at new VisualEditor (src/visual-editor/core/visual-editor.ts:53:13)

  console.log
    [VisualEditor] Experiment name from options: test-experiment

      at new VisualEditor (src/visual-editor/core/visual-editor.ts:54:13)

  console.log
    [ABSmartly] Starting unified visual editor - Version: 3.0-UNIFIED

      at VisualEditor.start (src/visual-editor/core/visual-editor.ts:144:13)

  console.log
    [ABSmartly] Build timestamp: 2025-10-17T15:42:22.374Z

      at VisualEditor.start (src/visual-editor/core/visual-editor.ts:145:13)

  console.log
    [ABSmartly] Starting visual editor

      at VisualEditor.start (src/visual-editor/core/visual-editor.ts:158:13)

  console.warn
    Error: Unauthorized
        at /Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/@absmartly/javascript-sdk/lib/client.js:123:27
        at processTicksAndRejections (node:internal/process/task_queues:105:5) {
      _bail: true
    }

      at node_modules/@absmartly/javascript-sdk/lib/client.js:144:17

  console.log
    📡 Event fired: error

      at Context.eventLogger [as _eventLogger] (src/__tests__/sdk-api.test.ts:99:17)

  console.log
    [ABSmartly] Visual editor banner created

      at VisualEditor.start (src/visual-editor/core/visual-editor.ts:180:13)

  console.log
    [ABSmartly] Visual editor is now active!

      at VisualEditor.start (src/visual-editor/core/visual-editor.ts:184:13)

  console.log
    [ABSmartly] Stopping unified visual editor

      at VisualEditor.stop (src/visual-editor/core/visual-editor.ts:204:13)

  console.error
    Trace: [ABSmartly] Stop called from:
        at VisualEditor.stop (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/src/visual-editor/core/visual-editor.ts:205:13)
        at /Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/src/visual-editor/core/__tests__/visual-editor.test.ts:774:16
        at Object.<anonymous> (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/expect/build/index.js:1824:9)
        at Object.throwingMatcher [as toThrow] (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/expect/build/index.js:2235:93)
        at Object.<anonymous> (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/src/visual-editor/core/__tests__/visual-editor.test.ts:777:14)
        at Promise.finally.completed (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1557:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1497:10)
        at _callCircusTest (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1007:40)
        at processTicksAndRejections (node:internal/process/task_queues:105:5)
        at _runTest (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:947:3)
        at /Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:849:7
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:862:11)
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:857:11)
        at _runTestsForDescribeBlock (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:857:11)
        at run (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:761:3)
        at runAndTransformResultsToJestFormat (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/jestAdapterInit.js:1918:21)
        at jestAdapter (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-circus/build/runner.js:101:19)
        at runTestInternal (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:275:16)
        at runTest (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:343:7)
        at Object.worker (/Users/joalves/git_tree/ext-dev6-refactor-sdk-plugin/node_modules/jest-runner/build/testWorker.js:497:12)

      203 |
      204 |     console.log('[ABSmartly] Stopping unified visual editor')
    > 205 |     console.trace('[ABSmartly] Stop called from:')
          |             ^
      206 |
      207 |     this.isActive = false
      208 |     ;(window as any).__absmartlyVisualEditorActive = false

      at VisualEditor.stop (src/visual-editor/core/visual-editor.ts:205:13)
      at src/visual-editor/core/__tests__/visual-editor.test.ts:774:16
      at Object.<anonymous> (node_modules/expect/build/index.js:1824:9)
      at Object.throwingMatcher [as toThrow] (node_modules/expect/build/index.js:2235:93)
      at Object.<anonymous> (src/visual-editor/core/__tests__/visual-editor.test.ts:777:14)

  console.log
    [ABSmartly] Final changes on exit: 0

      at VisualEditor.stop (src/visual-editor/core/visual-editor.ts:212:13)

  console.log
       ⚠️  Publish failed: Unauthorized

      at Object.<anonymous> (src/__tests__/sdk-api.test.ts:151:17)

  console.log
    6. Testing finalize event (close)...

      at Object.<anonymous> (src/__tests__/sdk-api.test.ts:155:15)

  console.log
       ⚠️  Close failed: context.close is not a function

      at Object.<anonymous> (src/__tests__/sdk-api.test.ts:160:17)

  console.log
    
    📊 Events Summary:

      at Object.<anonymous> (src/__tests__/sdk-api.test.ts:163:15)

  console.log
    Total events fired: 5

      at Object.<anonymous> (src/__tests__/sdk-api.test.ts:164:15)

  console.log
    [ABSmartly] Changes were already saved

      at VisualEditor.stop (src/visual-editor/core/visual-editor.ts:221:15)

  console.log
    [ABSmartly] Teardown with restoreOriginalValues: false

      at VisualEditor.stop (src/visual-editor/core/visual-editor.ts:228:13)

  console.log
    Event types: ready, goal, exposure, refresh, error

      at Object.<anonymous> (src/__tests__/sdk-api.test.ts:165:15)

  console.log
    
    ✅ At least ready and goal events work

      at Object.<anonymous> (src/__tests__/sdk-api.test.ts:170:15)

  console.log
    
    ⚠️  Note: Error events detected. This is expected if API calls fail.

      at Object.<anonymous> (src/__tests__/sdk-api.test.ts:175:17)

  console.log
    Error events will be fired for failed refresh/publish/close operations.

      at Object.<anonymous> (src/__tests__/sdk-api.test.ts:176:17)

  console.log
    [VisualEditor] Constructor called with options: {
      variantName: 'test-variant',
      experimentName: 'test-experiment',
      logoUrl: 'https://example.com/logo.png',
      onChangesUpdate: [Function: mockConstructor] {
        _isMockFunction: true,
        getMockImplementation: [Function (anonymous)],
        mock: [Getter/Setter],
        mockClear: [Function (anonymous)],
        mockReset: [Function (anonymous)],
        mockRestore: [Function (anonymous)],
        mockReturnValueOnce: [Function (anonymous)],
        mockResolvedValueOnce: [Function (anonymous)],
        mockRejectedValueOnce: [Function (anonymous)],
        mockReturnValue: [Function (anonymous)],
        mockResolvedValue: [Function (anonymous)],
        mockRejectedValue: [Function (anonymous)],
        mockImplementationOnce: [Function (anonymous)],
        withImplementation: [Function: bound withImplementation],
        mockImplementation: [Function (anonymous)],
        mockReturnThis: [Function (anonymous)],
        mockName: [Function (anonymous)],
        getMockName: [Function (anonymous)],
        [Symbol(nodejs.dispose)]: [Function (anonymous)]
      },
      initialChanges: []
    }

      at new VisualEditor (src/visual-editor/core/visual-editor.ts:53:13)

  console.log
    [VisualEditor] Experiment name from options: test-experiment

      at new VisualEditor (src/visual-editor/core/visual-editor.ts:54:13)

PASS src/__tests__/sdk-api.test.ts
  ABsmartly SDK API Connection
    ✓ should create SDK instance (3 ms)
    ✓ should create context and check experiments (158 ms)
    ✓ should test SDK event methods (531 ms)

  console.log
    [VisualEditor] Constructor called with options: {
      variantName: 'test-variant',
      experimentName: 'test-experiment',
      logoUrl: 'https://example.com/logo.png',
      onChangesUpdate: [Function: mockConstructor] {
        _isMockFunction: true,
        getMockImplementation: [Function (anonymous)],
        mock: [Getter/Setter],
        mockClear: [Function (anonymous)],
        mockReset: [Function (anonymous)],
        mockRestore: [Function (anonymous)],
        mockReturnValueOnce: [Function (anonymous)],
        mockResolvedValueOnce: [Function (anonymous)],
        mockRejectedValueOnce: [Function (anonymous)],
        mockReturnValue: [Function (anonymous)],
        mockResolvedValue: [Function (anonymous)],
        mockRejectedValue: [Function (anonymous)],
        mockImplementationOnce: [Function (anonymous)],
        withImplementation: [Function: bound withImplementation],
        mockImplementation: [Function (anonymous)],
        mockReturnThis: [Function (anonymous)],
        mockName: [Function (anonymous)],
        getMockName: [Function (anonymous)],
        [Symbol(nodejs.dispose)]: [Function (anonymous)]
      },
      initialChanges: []
    }

      at new VisualEditor (src/visual-editor/core/visual-editor.ts:53:13)

  console.log
    [VisualEditor] Experiment name from options: test-experiment

      at new VisualEditor (src/visual-editor/core/visual-editor.ts:54:13)

  console.log
    [ABSmartly] Starting unified visual editor - Version: 3.0-UNIFIED

      at VisualEditor.start (src/visual-editor/core/visual-editor.ts:144:13)

  console.log
    [ABSmartly] Build timestamp: 2025-10-17T15:42:22.391Z

      at VisualEditor.start (src/visual-editor/core/visual-editor.ts:145:13)

  console.log
    [ABSmartly] Already active, returning

      at VisualEditor.start (src/visual-editor/core/visual-editor.ts:154:15)

  console.log
    [VisualEditor] Constructor called with options: {
      variantName: 'test-variant',
      experimentName: 'test-experiment',
      logoUrl: 'https://example.com/logo.png',
      onChangesUpdate: [Function: mockConstructor] {
        _isMockFunction: true,
        getMockImplementation: [Function (anonymous)],
        mock: [Getter/Setter],
        mockClear: [Function (anonymous)],
        mockReset: [Function (anonymous)],
        mockRestore: [Function (anonymous)],
        mockReturnValueOnce: [Function (anonymous)],
        mockResolvedValueOnce: [Function (anonymous)],
        mockRejectedValueOnce: [Function (anonymous)],
        mockReturnValue: [Function (anonymous)],
        mockResolvedValue: [Function (anonymous)],
        mockRejectedValue: [Function (anonymous)],
        mockImplementationOnce: [Function (anonymous)],
        withImplementation: [Function: bound withImplementation],
        mockImplementation: [Function (anonymous)],
        mockReturnThis: [Function (anonymous)],
        mockName: [Function (anonymous)],
        getMockName: [Function (anonymous)],
        [Symbol(nodejs.dispose)]: [Function (anonymous)]
      },
      initialChanges: []
    }

      at new VisualEditor (src/visual-editor/core/visual-editor.ts:53:13)

  console.log
    [VisualEditor] Experiment name from options: test-experiment

      at new VisualEditor (src/visual-editor/core/visual-editor.ts:54:13)

  console.log
    [VisualEditor] Constructor called with options: {
      variantName: 'test-variant',
      experimentName: 'test-experiment',
      logoUrl: 'https://example.com/logo.png',
      onChangesUpdate: [Function: mockConstructor] {
        _isMockFunction: true,
        getMockImplementation: [Function (anonymous)],
        mock: [Getter/Setter],
        mockClear: [Function (anonymous)],
        mockReset: [Function (anonymous)],
        mockRestore: [Function (anonymous)],
        mockReturnValueOnce: [Function (anonymous)],
        mockResolvedValueOnce: [Function (anonymous)],
        mockRejectedValueOnce: [Function (anonymous)],
        mockReturnValue: [Function (anonymous)],
        mockResolvedValue: [Function (anonymous)],
        mockRejectedValue: [Function (anonymous)],
        mockImplementationOnce: [Function (anonymous)],
        withImplementation: [Function: bound withImplementation],
        mockImplementation: [Function (anonymous)],
        mockReturnThis: [Function (anonymous)],
        mockName: [Function (anonymous)],
        getMockName: [Function (anonymous)],
        [Symbol(nodejs.dispose)]: [Function (anonymous)]
      },
      initialChanges: []
    }

      at new VisualEditor (src/visual-editor/core/visual-editor.ts:53:13)

  console.log
    [VisualEditor] Experiment name from options: test-experiment

      at new VisualEditor (src/visual-editor/core/visual-editor.ts:54:13)

  console.log
    [ABSmartly] Saving changes - raw count: 0

      at VisualEditor.saveChanges (src/visual-editor/core/visual-editor.ts:470:13)

  console.log
    [ABSmartly] Squashing changes from 0 to consolidated list

      at VisualEditor.squashChanges (src/visual-editor/core/visual-editor.ts:347:13)

  console.log
    [ABSmartly] Squashed to 0 changes

      at VisualEditor.squashChanges (src/visual-editor/core/visual-editor.ts:377:13)

  console.log
    [ABSmartly] Squashed changes count: 0

      at VisualEditor.saveChanges (src/visual-editor/core/visual-editor.ts:474:13)

  console.log
    [ABSmartly] Storing original values in DOM for 0 changes

      at VisualEditor.storeOriginalValuesInDOM (src/visual-editor/core/visual-editor.ts:394:13)

  console.log
    [ABSmartly] Sending squashed changes to sidebar:

      at VisualEditor.saveChanges (src/visual-editor/core/visual-editor.ts:480:13)

  console.log
    [VisualEditor] Constructor called with options: {
      variantName: 'test-variant',
      experimentName: 'test-experiment',
      logoUrl: 'https://example.com/logo.png',
      onChangesUpdate: [Function: mockConstructor] {
        _isMockFunction: true,
        getMockImplementation: [Function (anonymous)],
        mock: [Getter/Setter],
        mockClear: [Function (anonymous)],
        mockReset: [Function (anonymous)],
        mockRestore: [Function (anonymous)],
        mockReturnValueOnce: [Function (anonymous)],
        mockResolvedValueOnce: [Function (anonymous)],
        mockRejectedValueOnce: [Function (anonymous)],
        mockReturnValue: [Function (anonymous)],
        mockResolvedValue: [Function (anonymous)],
        mockRejectedValue: [Function (anonymous)],
        mockImplementationOnce: [Function (anonymous)],
        withImplementation: [Function: bound withImplementation],
        mockImplementation: [Function (anonymous)],
        mockReturnThis: [Function (anonymous)],
        mockName: [Function (anonymous)],
        getMockName: [Function (anonymous)],
        [Symbol(nodejs.dispose)]: [Function (anonymous)]
      },
      initialChanges: []
    }

      at new VisualEditor (src/visual-editor/core/visual-editor.ts:53:13)

  console.log
    [EventsDebugPage] ❌ Removing message listeners

      at src/components/EventsDebugPage.tsx:88:15
          at Array.forEach (<anonymous>)

  console.log
    [EventsDebugPage] 🔵 Component mounted, fetching buffered events...

      at src/components/EventsDebugPage.tsx:33:13

  console.log
    [VisualEditor] Experiment name from options: test-experiment

      at new VisualEditor (src/visual-editor/core/visual-editor.ts:54:13)

  console.log
    [EventsDebugPage] GET_BUFFERED_EVENTS response: { success: true, events: [] }

      at src/components/EventsDebugPage.tsx:39:15

  console.log
    [ABSmartly] Saving changes - raw count: 0

      at VisualEditor.saveChanges (src/visual-editor/core/visual-editor.ts:470:13)

  console.log
    [EventsDebugPage] ✅ Loaded 0 buffered events

      at src/components/EventsDebugPage.tsx:41:17

  console.log
    [EventsDebugPage] ✅ Registered message listeners

      at src/components/EventsDebugPage.tsx:83:13

  console.log
    [ABSmartly] Squashing changes from 0 to consolidated list

      at VisualEditor.squashChanges (src/visual-editor/core/visual-editor.ts:347:13)

  console.log
    [ABSmartly] Squashed to 0 changes

      at VisualEditor.squashChanges (src/visual-editor/core/visual-editor.ts:377:13)

  console.log
    [ABSmartly] Squashed changes count: 0

      at VisualEditor.saveChanges (src/visual-editor/core/visual-editor.ts:474:13)

PASS src/sdk-bridge/__tests__/sdk/sdk-interceptor.test.ts
  SDKInterceptor
    interceptEventLogger
      ✓ should intercept event logger on context (2 ms)
      ✓ should not intercept if context is null
      ✓ should not intercept if already intercepted
      ✓ should warn if _eventLogger is undefined (1 ms)
      ✓ should call callback with event data (1 ms)
      ✓ should call original event logger (4 ms)
      ✓ should handle null event data (2 ms)
      ✓ should handle callback errors gracefully (1 ms)
      ✓ should work without callback (3 ms)
      ✓ should clone event data to prevent mutation (1 ms)
      ✓ should log context details (1 ms)
    interceptSDKCreateContext
      ✓ should intercept SDK createContext method
      ✓ should not intercept if SDK is null
      ✓ should not intercept if createContext does not exist
      ✓ should not intercept if already intercepted
      ✓ should call original createContext (1 ms)
      ✓ should return context from original createContext
      ✓ should intercept eventLogger on new context
      ✓ should log interception (1 ms)
    interceptSDKConstructor
      ✓ should intercept SDK constructor
      ✓ should not intercept if sdkModule is null
      ✓ should not intercept if SDK class does not exist
      ✓ should not intercept if already intercepted
      ✓ should create SDK instance with original constructor
      ✓ should intercept createContext on new SDK instance (1 ms)
      ✓ should preserve static properties
      ✓ should log constructor interception (1 ms)
      ✓ should handle SDK instance without createContext
    constructor
      ✓ should accept callbacks
      ✓ should work without callbacks (1 ms)

  console.log
    [ABSmartly] Storing original values in DOM for 0 changes

      at VisualEditor.storeOriginalValuesInDOM (src/visual-editor/core/visual-editor.ts:394:13)

  console.log
    [ABSmartly] Sending squashed changes to sidebar:

      at VisualEditor.saveChanges (src/visual-editor/core/visual-editor.ts:480:13)

  console.log
    [ABSmartly] Initializing unified visual editor

      at initVisualEditor (src/visual-editor/core/visual-editor.ts:576:11)

  console.log
    [VisualEditor] Constructor called with options: {
      variantName: 'test-variant',
      experimentName: 'test-experiment',
      logoUrl: 'https://example.com/logo.png',
      initialChanges: [],
      onChangesUpdate: [Function: onChangesUpdate]
    }

      at new VisualEditor (src/visual-editor/core/visual-editor.ts:53:13)

  console.log
    [VisualEditor] Experiment name from options: test-experiment

      at new VisualEditor (src/visual-editor/core/visual-editor.ts:54:13)

  console.log
    [ABSmartly] Starting unified visual editor - Version: 3.0-UNIFIED

      at VisualEditor.start (src/visual-editor/core/visual-editor.ts:144:13)

  console.log
    [ABSmartly] Build timestamp: 2025-10-17T15:42:22.442Z

      at VisualEditor.start (src/visual-editor/core/visual-editor.ts:145:13)

  console.log
    [ABSmartly] Starting visual editor

      at VisualEditor.start (src/visual-editor/core/visual-editor.ts:158:13)

  console.log
    [ABSmartly] Visual editor banner created

      at VisualEditor.start (src/visual-editor/core/visual-editor.ts:180:13)

  console.log
    [ABSmartly] Visual editor is now active!

      at VisualEditor.start (src/visual-editor/core/visual-editor.ts:184:13)

  console.log
    [EventsDebugPage] 🔵 Received runtime message: SDK_EVENT_BROADCAST {
      type: 'SDK_EVENT_BROADCAST',
      payload: {
        eventName: 'ready',
        data: null,
        timestamp: '2025-10-17T15:42:22.445Z'
      }
    }

      at handleRuntimeMessage (src/components/EventsDebugPage.tsx:54:15)
          at Array.forEach (<anonymous>)

  console.log
    [ABSmartly] Initializing unified visual editor

      at initVisualEditor (src/visual-editor/core/visual-editor.ts:576:11)

  console.log
    [EventsDebugPage] ✅ SDK_EVENT_BROADCAST received, adding event: {
      eventName: 'ready',
      data: null,
      timestamp: '2025-10-17T15:42:22.445Z'
    }

      at handleRuntimeMessage (src/components/EventsDebugPage.tsx:57:19)
          at Array.forEach (<anonymous>)

  console.log
    [VisualEditor] Constructor called with options: {
      variantName: 'test-variant',
      experimentName: 'test-experiment',
      logoUrl: 'https://example.com/logo.png',
      initialChanges: [ { selector: '.test', type: 'text', value: 'Test content' } ],
      onChangesUpdate: [Function: onChangesUpdate]
    }

      at new VisualEditor (src/visual-editor/core/visual-editor.ts:53:13)

  console.log
    [EventsDebugPage] Adding event to list. Current count: 0 New count: 1

      at src/components/EventsDebugPage.tsx:66:21

  console.log
    [VisualEditor] Experiment name from options: test-experiment

      at new VisualEditor (src/visual-editor/core/visual-editor.ts:54:13)

  console.log
    [ABSmartly] Starting unified visual editor - Version: 3.0-UNIFIED

      at VisualEditor.start (src/visual-editor/core/visual-editor.ts:144:13)

  console.log
    [ABSmartly] Build timestamp: 2025-10-17T15:42:22.447Z

      at VisualEditor.start (src/visual-editor/core/visual-editor.ts:145:13)

  console.log
    [ABSmartly] Starting visual editor

      at VisualEditor.start (src/visual-editor/core/visual-editor.ts:158:13)

  console.log
    [ABSmartly] Visual editor banner created

      at VisualEditor.start (src/visual-editor/core/visual-editor.ts:180:13)

  console.log
    [ABSmartly] Visual editor is now active!

      at VisualEditor.start (src/visual-editor/core/visual-editor.ts:184:13)

  console.log
    [ABSmartly] Initializing unified visual editor

      at initVisualEditor (src/visual-editor/core/visual-editor.ts:576:11)

  console.log
    [VisualEditor] Constructor called with options: {
      variantName: 'test-variant',
      experimentName: 'test-experiment',
      logoUrl: 'https://example.com/logo.png',
      initialChanges: [],
      onChangesUpdate: [Function: onChangesUpdate]
    }

      at new VisualEditor (src/visual-editor/core/visual-editor.ts:53:13)

  console.log
    [VisualEditor] Experiment name from options: test-experiment

      at new VisualEditor (src/visual-editor/core/visual-editor.ts:54:13)

  console.log
    [EventsDebugPage] ❌ Removing message listeners

      at src/components/EventsDebugPage.tsx:88:15
          at Array.forEach (<anonymous>)

  console.log
    [ABSmartly] Starting unified visual editor - Version: 3.0-UNIFIED

      at VisualEditor.start (src/visual-editor/core/visual-editor.ts:144:13)

  console.log
    [ABSmartly] Build timestamp: 2025-10-17T15:42:22.452Z

      at VisualEditor.start (src/visual-editor/core/visual-editor.ts:145:13)

  console.log
    [ABSmartly] Starting visual editor

      at VisualEditor.start (src/visual-editor/core/visual-editor.ts:158:13)

  console.log
    [ABSmartly] Visual editor banner created

      at VisualEditor.start (src/visual-editor/core/visual-editor.ts:180:13)

  console.log
    [ABSmartly] Visual editor is now active!

      at VisualEditor.start (src/visual-editor/core/visual-editor.ts:184:13)

  console.log
    [ABSmartly] Initializing unified visual editor

      at initVisualEditor (src/visual-editor/core/visual-editor.ts:576:11)

  console.log
    [VisualEditor] Constructor called with options: {
      variantName: 'test-variant',
      experimentName: 'test-experiment',
      logoUrl: 'https://example.com/logo.png',
      initialChanges: [],
      onChangesUpdate: [Function: onChangesUpdate]
    }

      at new VisualEditor (src/visual-editor/core/visual-editor.ts:53:13)

  console.log
    [VisualEditor] Experiment name from options: test-experiment

      at new VisualEditor (src/visual-editor/core/visual-editor.ts:54:13)

  console.log
    [ABSmartly] Starting unified visual editor - Version: 3.0-UNIFIED

      at VisualEditor.start (src/visual-editor/core/visual-editor.ts:144:13)

  console.log
    [ABSmartly] Build timestamp: 2025-10-17T15:42:22.457Z

      at VisualEditor.start (src/visual-editor/core/visual-editor.ts:145:13)

  console.log
    [ABSmartly] Visual editor already active

      at VisualEditor.start (src/visual-editor/core/visual-editor.ts:149:15)

  console.log
    [ABSmartly] Initializing unified visual editor

      at initVisualEditor (src/visual-editor/core/visual-editor.ts:576:11)

  console.log
    [VisualEditor] Constructor called with options: {
      variantName: 'test-variant',
      experimentName: 'test-experiment',
      logoUrl: 'https://example.com/logo.png',
      initialChanges: [],
      onChangesUpdate: [Function: onChangesUpdate]
    }

      at new VisualEditor (src/visual-editor/core/visual-editor.ts:53:13)

  console.log
    [VisualEditor] Experiment name from options: test-experiment

      at new VisualEditor (src/visual-editor/core/visual-editor.ts:54:13)

  console.log
    [EventsDebugPage] 🔵 Component mounted, fetching buffered events...

      at src/components/EventsDebugPage.tsx:33:13

  console.log
    [EventsDebugPage] GET_BUFFERED_EVENTS response: { success: true, events: [] }

      at src/components/EventsDebugPage.tsx:39:15

  console.log
    [EventsDebugPage] ✅ Loaded 0 buffered events

      at src/components/EventsDebugPage.tsx:41:17

  console.log
    [EventsDebugPage] ✅ Registered message listeners

      at src/components/EventsDebugPage.tsx:83:13

  console.log
    [EventsDebugPage] 🔵 Received runtime message: SDK_EVENT_BROADCAST {
      type: 'SDK_EVENT_BROADCAST',
      payload: {
        eventName: 'ready',
        data: null,
        timestamp: '2025-10-17T15:42:22.460Z'
      }
    }

      at handleRuntimeMessage (src/components/EventsDebugPage.tsx:54:15)
          at Array.forEach (<anonymous>)

  console.log
    [EventsDebugPage] ✅ SDK_EVENT_BROADCAST received, adding event: {
      eventName: 'ready',
      data: null,
      timestamp: '2025-10-17T15:42:22.460Z'
    }

      at handleRuntimeMessage (src/components/EventsDebugPage.tsx:57:19)
          at Array.forEach (<anonymous>)

  console.log
    [EventsDebugPage] Adding event to list. Current count: 0 New count: 1

      at src/components/EventsDebugPage.tsx:66:21

  console.log
    [EventsDebugPage] 🔵 Received runtime message: SDK_EVENT_BROADCAST {
      type: 'SDK_EVENT_BROADCAST',
      payload: {
        eventName: 'exposure',
        data: { experiment: 'test' },
        timestamp: '2025-10-17T15:42:22.465Z'
      }
    }

      at handleRuntimeMessage (src/components/EventsDebugPage.tsx:54:15)
          at Array.forEach (<anonymous>)

  console.log
    [EventsDebugPage] ✅ SDK_EVENT_BROADCAST received, adding event: {
      eventName: 'exposure',
      data: { experiment: 'test' },
      timestamp: '2025-10-17T15:42:22.465Z'
    }

      at handleRuntimeMessage (src/components/EventsDebugPage.tsx:57:19)
          at Array.forEach (<anonymous>)

  console.log
    [EventsDebugPage] Adding event to list. Current count: 1 New count: 2

      at src/components/EventsDebugPage.tsx:66:21

  console.log
    [ABSmartly] Starting unified visual editor - Version: 3.0-UNIFIED

      at VisualEditor.start (src/visual-editor/core/visual-editor.ts:144:13)

  console.log
    [ABSmartly] Build timestamp: 2025-10-17T15:42:22.470Z

      at VisualEditor.start (src/visual-editor/core/visual-editor.ts:145:13)

  console.log
    [ABSmartly] Starting visual editor

      at VisualEditor.start (src/visual-editor/core/visual-editor.ts:158:13)

  console.log
    [ABSmartly] Visual editor banner created

      at VisualEditor.start (src/visual-editor/core/visual-editor.ts:180:13)

  console.log
    [ABSmartly] Visual editor is now active!

      at VisualEditor.start (src/visual-editor/core/visual-editor.ts:184:13)

  console.log
    [ABSmartly] Initializing unified visual editor

      at initVisualEditor (src/visual-editor/core/visual-editor.ts:576:11)

  console.log
    [VisualEditor] Constructor called with options: {
      variantName: 'test-variant',
      experimentName: 'test-experiment',
      logoUrl: 'https://example.com/logo.png',
      initialChanges: [],
      onChangesUpdate: [Function: onChangesUpdate]
    }

      at new VisualEditor (src/visual-editor/core/visual-editor.ts:53:13)

  console.log
    [VisualEditor] Experiment name from options: test-experiment

      at new VisualEditor (src/visual-editor/core/visual-editor.ts:54:13)

  console.log
    [ABSmartly] Starting unified visual editor - Version: 3.0-UNIFIED

      at VisualEditor.start (src/visual-editor/core/visual-editor.ts:144:13)

  console.log
    [ABSmartly] Build timestamp: 2025-10-17T15:42:22.474Z

      at VisualEditor.start (src/visual-editor/core/visual-editor.ts:145:13)

  console.log
    [ABSmartly] Starting visual editor

      at VisualEditor.start (src/visual-editor/core/visual-editor.ts:158:13)

  console.log
    [ABSmartly] Visual editor banner created

      at VisualEditor.start (src/visual-editor/core/visual-editor.ts:180:13)

  console.log
    [ABSmartly] Visual editor is now active!

      at VisualEditor.start (src/visual-editor/core/visual-editor.ts:184:13)

PASS src/sdk-bridge/__tests__/utils/html-sanitizer.test.ts
  sanitizeHTML
    basic functionality
      ✓ should return empty string for null/undefined/empty input (3 ms)
      ✓ should preserve safe HTML (25 ms)
      ✓ should preserve safe elements (6 ms)
    dangerous tag removal
      ✓ should remove script tags (4 ms)
      ✓ should remove iframe tags (5 ms)
      ✓ should remove object tags (1 ms)
      ✓ should remove embed tags (3 ms)
      ✓ should remove link tags (3 ms)
      ✓ should remove style tags (5 ms)
      ✓ should remove meta tags (1 ms)
      ✓ should remove base tags (1 ms)
    event handler removal
      ✓ should remove onerror attributes (1 ms)
      ✓ should remove onclick attributes (1 ms)
      ✓ should remove onload attributes (1 ms)
      ✓ should remove all on* event handlers (4 ms)
      ✓ should remove mixed case event handlers (1 ms)
    dangerous URI removal
      ✓ should remove javascript: URIs from href (2 ms)
      ✓ should remove javascript: URIs from src (1 ms)
      ✓ should remove data: URIs from href
      ✓ should remove data: URIs from src (1 ms)
      ✓ should allow safe URLs
      ✓ should allow safe image sources (2 ms)
    complex XSS attempts
      ✓ should handle multiple attack vectors in one string (2 ms)
      ✓ should handle nested malicious elements (1 ms)
      ✓ should handle encoded attack attempts (2 ms)
    edge cases
      ✓ should handle empty tags
      ✓ should handle self-closing tags (3 ms)
      ✓ should handle deeply nested safe HTML (1 ms)
      ✓ should handle HTML with attributes (1 ms)
      ✓ should handle mixed safe and unsafe content (2 ms)
    real-world use cases
      ✓ should sanitize user-generated content (1 ms)
      ✓ should sanitize rich text editor output (2 ms)
      ✓ should handle DOM changes from experiments (10 ms)

PASS src/visual-editor/core/__tests__/visual-editor.test.ts (8.372 s)
  VisualEditor
    Constructor
      ✓ should initialize with valid options (130 ms)
      ✓ should initialize with initial changes (23 ms)
      ✓ should initialize all core modules (4 ms)
      ✓ should initialize ElementActions with correct parameters (9 ms)
      ✓ should initialize EditorCoordinator with all modules and callbacks (4 ms)
    start()
      ✓ should start successfully when not active (31 ms)
      ✓ should return already active when global flag is set (6 ms)
      ✓ should return already active when editor is already active (20 ms)
      ✓ should inject styles when starting (87 ms)
      ✓ should keep preview header visible when starting (53 ms)
      ✓ should set isActive flag when starting (25 ms)
      ✓ should log version and timestamp (7 ms)
    stop()
      ✓ should stop when active and not send changes (44 ms)
      ✓ should not call teardown when not active (27 ms)
      ✓ should remove styles when stopping (120 ms)
      ✓ should reset isActive flag when stopping (7 ms)
      ✓ should not send unsaved changes when stopping (12 ms)
    destroy()
      ✓ should call stop when destroyed (32 ms)
    getChanges()
      ✓ should return empty array by default (25 ms)
      ✓ should return initial changes if provided (32 ms)
    Style Management
      ✓ should inject editor styles (82 ms)
      ✓ should inject global styles (90 ms)
      ✓ should remove styles when stopped (71 ms)
    Change Management
      ✓ should add text change to undoRedoManager but not auto-save (11 ms)
      ✓ should add style change to undoRedoManager but not auto-save (7 ms)
      ✓ should save changes when saveChanges is called (24 ms)
      ✓ should handle multiple change types (6 ms)
    saveChanges()
      ✓ should save changes and show notification (23 ms)
      ✓ should handle empty changes (10 ms)
    Integration with ElementActions
      ✓ should delegate getSelector to ElementActions (3 ms)
      ✓ should delegate element operations to ElementActions (7 ms)
    Integration with EditorCoordinator
      ✓ should setup all modules when starting (6 ms)
      ✓ should teardown all modules when stopping (15 ms)
      ✓ should provide correct callbacks to coordinator (2 ms)
      ✓ should call stop through coordinator callback (2 ms)
    Edge Cases and Error Handling
      ✓ should handle missing preview header gracefully (9 ms)
      ✓ should handle chrome API errors gracefully (4 ms)
      ✓ should handle multiple start calls gracefully (22 ms)
      ✓ should handle multiple stop calls gracefully (12 ms)
      ✓ should handle removeStyles callback (6 ms)
      ✓ should return early when already active (7 ms)
      ✓ should handle onChangesUpdate callback errors in saveChanges (13 ms)
      ✓ should handle chrome API unavailable gracefully (30 ms)
  initVisualEditor
    ✓ should create and start visual editor (8 ms)
    ✓ should handle initial changes (4 ms)
    ✓ should setup message handler for changes (4 ms)
    ✓ should return already active when global editor exists (5 ms)
    ✓ should store editor instance globally (14 ms)
    ✓ should handle onChangesUpdate callback correctly (4 ms)

  console.log
    [EventsDebugPage] ❌ Removing message listeners

      at src/components/EventsDebugPage.tsx:88:15
          at Array.forEach (<anonymous>)

  console.log
    [EventsDebugPage] 🔵 Component mounted, fetching buffered events...

      at src/components/EventsDebugPage.tsx:33:13

  console.log
    [EventsDebugPage] GET_BUFFERED_EVENTS response: { success: true, events: [] }

      at src/components/EventsDebugPage.tsx:39:15

  console.log
    [EventsDebugPage] ✅ Loaded 0 buffered events

      at src/components/EventsDebugPage.tsx:41:17

  console.log
    [EventsDebugPage] ✅ Registered message listeners

      at src/components/EventsDebugPage.tsx:83:13

  console.log
    [EventsDebugPage] 🔵 Received runtime message: SDK_EVENT_BROADCAST {
      type: 'SDK_EVENT_BROADCAST',
      payload: {
        eventName: 'ready',
        data: null,
        timestamp: '2025-10-17T15:42:22.506Z'
      }
    }

      at handleRuntimeMessage (src/components/EventsDebugPage.tsx:54:15)
          at Array.forEach (<anonymous>)

  console.log
    [EventsDebugPage] ✅ SDK_EVENT_BROADCAST received, adding event: {
      eventName: 'ready',
      data: null,
      timestamp: '2025-10-17T15:42:22.506Z'
    }

      at handleRuntimeMessage (src/components/EventsDebugPage.tsx:57:19)
          at Array.forEach (<anonymous>)

  console.log
    [EventsDebugPage] Adding event to list. Current count: 0 New count: 1

      at src/components/EventsDebugPage.tsx:66:21

  console.log
    [EventsDebugPage] ❌ Removing message listeners

      at src/components/EventsDebugPage.tsx:88:15
          at Array.forEach (<anonymous>)

  console.log
    [EventsDebugPage] 🔵 Component mounted, fetching buffered events...

      at src/components/EventsDebugPage.tsx:33:13

  console.log
    [EventsDebugPage] GET_BUFFERED_EVENTS response: { success: true, events: [] }

      at src/components/EventsDebugPage.tsx:39:15

  console.log
    [EventsDebugPage] ✅ Loaded 0 buffered events

      at src/components/EventsDebugPage.tsx:41:17

  console.log
    [EventsDebugPage] ✅ Registered message listeners

      at src/components/EventsDebugPage.tsx:83:13

  console.log
    [EventsDebugPage] 🔵 Received runtime message: SDK_EVENT_BROADCAST {
      type: 'SDK_EVENT_BROADCAST',
      payload: {
        eventName: 'ready',
        data: { test: 'data' },
        timestamp: '2025-10-17T15:42:22.535Z'
      }
    }

      at handleRuntimeMessage (src/components/EventsDebugPage.tsx:54:15)
          at Array.forEach (<anonymous>)

  console.log
    [EventsDebugPage] ✅ SDK_EVENT_BROADCAST received, adding event: {
      eventName: 'ready',
      data: { test: 'data' },
      timestamp: '2025-10-17T15:42:22.535Z'
    }

      at handleRuntimeMessage (src/components/EventsDebugPage.tsx:57:19)
          at Array.forEach (<anonymous>)

  console.log
    [EventsDebugPage] Adding event to list. Current count: 0 New count: 1

      at src/components/EventsDebugPage.tsx:66:21

  console.log
    [EventsDebugPage] 🔵 Received runtime message: SDK_EVENT_BROADCAST {
      type: 'SDK_EVENT_BROADCAST',
      payload: {
        eventName: 'exposure',
        data: { variant: 1 },
        timestamp: '2025-10-17T15:42:22.538Z'
      }
    }

      at handleRuntimeMessage (src/components/EventsDebugPage.tsx:54:15)
          at Array.forEach (<anonymous>)

  console.log
    [EventsDebugPage] ✅ SDK_EVENT_BROADCAST received, adding event: {
      eventName: 'exposure',
      data: { variant: 1 },
      timestamp: '2025-10-17T15:42:22.538Z'
    }

      at handleRuntimeMessage (src/components/EventsDebugPage.tsx:57:19)
          at Array.forEach (<anonymous>)

  console.log
    [EventsDebugPage] Adding event to list. Current count: 1 New count: 2

      at src/components/EventsDebugPage.tsx:66:21

  console.log
    [EventsDebugPage] ❌ Removing message listeners

      at src/components/EventsDebugPage.tsx:88:15
          at Array.forEach (<anonymous>)

  console.log
    [EventsDebugPage] 🔵 Component mounted, fetching buffered events...

      at src/components/EventsDebugPage.tsx:33:13

  console.log
    [EventsDebugPage] GET_BUFFERED_EVENTS response: { success: true, events: [] }

      at src/components/EventsDebugPage.tsx:39:15

  console.log
    [EventsDebugPage] ✅ Loaded 0 buffered events

      at src/components/EventsDebugPage.tsx:41:17

  console.log
    [EventsDebugPage] ✅ Registered message listeners

      at src/components/EventsDebugPage.tsx:83:13

  console.log
    [EventsDebugPage] 🔵 Received runtime message: SDK_EVENT_BROADCAST {
      type: 'SDK_EVENT_BROADCAST',
      payload: {
        eventName: 'exposure',
        data: { experiment: 'test_exp', variant: 1 },
        timestamp: '2025-10-17T15:42:22.561Z'
      }
    }

      at handleRuntimeMessage (src/components/EventsDebugPage.tsx:54:15)
          at Array.forEach (<anonymous>)

  console.log
    [EventsDebugPage] ✅ SDK_EVENT_BROADCAST received, adding event: {
      eventName: 'exposure',
      data: { experiment: 'test_exp', variant: 1 },
      timestamp: '2025-10-17T15:42:22.561Z'
    }

      at handleRuntimeMessage (src/components/EventsDebugPage.tsx:57:19)
          at Array.forEach (<anonymous>)

  console.log
    [EventsDebugPage] Adding event to list. Current count: 0 New count: 1

      at src/components/EventsDebugPage.tsx:66:21

  console.log
    [EventsDebugPage] ❌ Removing message listeners

      at src/components/EventsDebugPage.tsx:88:15
          at Array.forEach (<anonymous>)

  console.log
    [EventsDebugPage] 🔵 Component mounted, fetching buffered events...

      at src/components/EventsDebugPage.tsx:33:13

  console.log
    [EventsDebugPage] GET_BUFFERED_EVENTS response: { success: true, events: [] }

      at src/components/EventsDebugPage.tsx:39:15

  console.log
    [EventsDebugPage] ✅ Loaded 0 buffered events

      at src/components/EventsDebugPage.tsx:41:17

  console.log
    [EventsDebugPage] ✅ Registered message listeners

      at src/components/EventsDebugPage.tsx:83:13

  console.log
    [EventsDebugPage] 🔵 Received runtime message: SDK_EVENT_BROADCAST {
      type: 'SDK_EVENT_BROADCAST',
      payload: {
        eventName: 'ready',
        data: null,
        timestamp: '2025-10-17T15:42:22.576Z'
      }
    }

      at handleRuntimeMessage (src/components/EventsDebugPage.tsx:54:15)
          at Array.forEach (<anonymous>)

  console.log
    [EventsDebugPage] ✅ SDK_EVENT_BROADCAST received, adding event: {
      eventName: 'ready',
      data: null,
      timestamp: '2025-10-17T15:42:22.576Z'
    }

      at handleRuntimeMessage (src/components/EventsDebugPage.tsx:57:19)
          at Array.forEach (<anonymous>)

  console.log
    [EventsDebugPage] Adding event to list. Current count: 0 New count: 1

      at src/components/EventsDebugPage.tsx:66:21

  console.log
    [EventsDebugPage] ❌ Removing message listeners

      at src/components/EventsDebugPage.tsx:88:15
          at Array.forEach (<anonymous>)

  console.log
    [EventsDebugPage] 🔵 Component mounted, fetching buffered events...

      at src/components/EventsDebugPage.tsx:33:13

  console.log
    [EventsDebugPage] GET_BUFFERED_EVENTS response: { success: true, events: [] }

      at src/components/EventsDebugPage.tsx:39:15

  console.log
    [EventsDebugPage] ✅ Loaded 0 buffered events

      at src/components/EventsDebugPage.tsx:41:17

  console.log
    [EventsDebugPage] ✅ Registered message listeners

      at src/components/EventsDebugPage.tsx:83:13

  console.log
    [EventsDebugPage] 🔵 Received runtime message: SDK_EVENT_BROADCAST {
      type: 'SDK_EVENT_BROADCAST',
      payload: {
        eventName: 'ready',
        data: { experiments: [Array] },
        timestamp: '2025-10-17T15:42:22.592Z'
      }
    }

      at handleRuntimeMessage (src/components/EventsDebugPage.tsx:54:15)
          at Array.forEach (<anonymous>)

  console.log
    [EventsDebugPage] ✅ SDK_EVENT_BROADCAST received, adding event: {
      eventName: 'ready',
      data: { experiments: [ 'exp1' ] },
      timestamp: '2025-10-17T15:42:22.592Z'
    }

      at handleRuntimeMessage (src/components/EventsDebugPage.tsx:57:19)
          at Array.forEach (<anonymous>)

  console.log
    [EventsDebugPage] Adding event to list. Current count: 0 New count: 1

      at src/components/EventsDebugPage.tsx:66:21

  console.log
    [EventsDebugPage] 🔵 Received runtime message: SDK_EVENT_BROADCAST {
      type: 'SDK_EVENT_BROADCAST',
      payload: {
        eventName: 'exposure',
        data: { variant: 2 },
        timestamp: '2025-10-17T15:42:22.597Z'
      }
    }

      at handleRuntimeMessage (src/components/EventsDebugPage.tsx:54:15)
          at Array.forEach (<anonymous>)

  console.log
    [EventsDebugPage] ✅ SDK_EVENT_BROADCAST received, adding event: {
      eventName: 'exposure',
      data: { variant: 2 },
      timestamp: '2025-10-17T15:42:22.597Z'
    }

      at handleRuntimeMessage (src/components/EventsDebugPage.tsx:57:19)
          at Array.forEach (<anonymous>)

  console.log
    [EventsDebugPage] Adding event to list. Current count: 1 New count: 2

      at src/components/EventsDebugPage.tsx:66:21

  console.log
    [EventsDebugPage] ❌ Removing message listeners

      at src/components/EventsDebugPage.tsx:88:15
          at Array.forEach (<anonymous>)

  console.log
    [EventsDebugPage] 🔵 Component mounted, fetching buffered events...

      at src/components/EventsDebugPage.tsx:33:13

  console.log
    [EventsDebugPage] GET_BUFFERED_EVENTS response: { success: true, events: [] }

      at src/components/EventsDebugPage.tsx:39:15

  console.log
    [EventsDebugPage] ✅ Loaded 0 buffered events

      at src/components/EventsDebugPage.tsx:41:17

  console.log
    [EventsDebugPage] ✅ Registered message listeners

      at src/components/EventsDebugPage.tsx:83:13

  console.log
    [EventsDebugPage] 🔵 Received runtime message: SDK_EVENT_BROADCAST {
      type: 'SDK_EVENT_BROADCAST',
      payload: {
        eventName: 'goal',
        data: {
          message: 'aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa',
          nested: [Object]
        },
        timestamp: '2025-10-17T15:42:22.613Z'
      }
    }

      at handleRuntimeMessage (src/components/EventsDebugPage.tsx:54:15)
          at Array.forEach (<anonymous>)

  console.log
    [EventsDebugPage] ✅ SDK_EVENT_BROADCAST received, adding event: {
      eventName: 'goal',
      data: {
        message: 'aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa',
        nested: { deep: [Object] }
      },
      timestamp: '2025-10-17T15:42:22.613Z'
    }

      at handleRuntimeMessage (src/components/EventsDebugPage.tsx:57:19)
          at Array.forEach (<anonymous>)

  console.log
    [EventsDebugPage] Adding event to list. Current count: 0 New count: 1

      at src/components/EventsDebugPage.tsx:66:21

  console.log
    [EventsDebugPage] ❌ Removing message listeners

      at src/components/EventsDebugPage.tsx:88:15
          at Array.forEach (<anonymous>)

  console.log
    [EventsDebugPage] 🔵 Component mounted, fetching buffered events...

      at src/components/EventsDebugPage.tsx:33:13

  console.log
    [EventsDebugPage] GET_BUFFERED_EVENTS response: { success: true, events: [] }

      at src/components/EventsDebugPage.tsx:39:15

  console.log
    [EventsDebugPage] ✅ Loaded 0 buffered events

      at src/components/EventsDebugPage.tsx:41:17

  console.log
    [EventsDebugPage] ✅ Registered message listeners

      at src/components/EventsDebugPage.tsx:83:13

  console.log
    [EventsDebugPage] 🔵 Received runtime message: SDK_EVENT_BROADCAST {
      type: 'SDK_EVENT_BROADCAST',
      payload: {
        eventName: 'ready',
        data: null,
        timestamp: '2025-01-01T14:30:45.123Z'
      }
    }

      at handleRuntimeMessage (src/components/EventsDebugPage.tsx:54:15)
          at Array.forEach (<anonymous>)

  console.log
    [EventsDebugPage] ✅ SDK_EVENT_BROADCAST received, adding event: {
      eventName: 'ready',
      data: null,
      timestamp: '2025-01-01T14:30:45.123Z'
    }

      at handleRuntimeMessage (src/components/EventsDebugPage.tsx:57:19)
          at Array.forEach (<anonymous>)

  console.log
    [EventsDebugPage] Adding event to list. Current count: 0 New count: 1

      at src/components/EventsDebugPage.tsx:66:21

  console.log
    [EventsDebugPage] ❌ Removing message listeners

      at src/components/EventsDebugPage.tsx:88:15
          at Array.forEach (<anonymous>)

  console.log
    [EventsDebugPage] 🔵 Component mounted, fetching buffered events...

      at src/components/EventsDebugPage.tsx:33:13

  console.log
    [EventsDebugPage] GET_BUFFERED_EVENTS response: { success: true, events: [] }

      at src/components/EventsDebugPage.tsx:39:15

  console.log
    [EventsDebugPage] ✅ Loaded 0 buffered events

      at src/components/EventsDebugPage.tsx:41:17

  console.log
    [EventsDebugPage] ✅ Registered message listeners

      at src/components/EventsDebugPage.tsx:83:13

  console.log
    [EventsDebugPage] 🔵 Received runtime message: SDK_EVENT_BROADCAST {
      type: 'SDK_EVENT_BROADCAST',
      payload: {
        eventName: 'finalize',
        data: null,
        timestamp: '2025-10-17T15:42:22.644Z'
      }
    }

      at handleRuntimeMessage (src/components/EventsDebugPage.tsx:54:15)
          at Array.forEach (<anonymous>)

  console.log
    [EventsDebugPage] ✅ SDK_EVENT_BROADCAST received, adding event: {
      eventName: 'finalize',
      data: null,
      timestamp: '2025-10-17T15:42:22.644Z'
    }

      at handleRuntimeMessage (src/components/EventsDebugPage.tsx:57:19)
          at Array.forEach (<anonymous>)

  console.log
    [EventsDebugPage] Adding event to list. Current count: 0 New count: 1

      at src/components/EventsDebugPage.tsx:66:21

  console.log
    [EventsDebugPage] ❌ Removing message listeners

      at src/components/EventsDebugPage.tsx:88:15
          at Array.forEach (<anonymous>)

  console.log
    [EventsDebugPage] 🔵 Component mounted, fetching buffered events...

      at src/components/EventsDebugPage.tsx:33:13

  console.log
    [EventsDebugPage] GET_BUFFERED_EVENTS response: { success: true, events: [] }

      at src/components/EventsDebugPage.tsx:39:15

  console.log
    [EventsDebugPage] ✅ Loaded 0 buffered events

      at src/components/EventsDebugPage.tsx:41:17

  console.log
    [EventsDebugPage] ✅ Registered message listeners

      at src/components/EventsDebugPage.tsx:83:13

  console.log
    [EventsDebugPage] ❌ Removing message listeners

      at src/components/EventsDebugPage.tsx:88:15
          at Array.forEach (<anonymous>)

  console.log
    [EventsDebugPage] 🔵 Component mounted, fetching buffered events...

      at src/components/EventsDebugPage.tsx:33:13

  console.log
    [EventsDebugPage] GET_BUFFERED_EVENTS response: { success: true, events: [] }

      at src/components/EventsDebugPage.tsx:39:15

  console.log
    [EventsDebugPage] ✅ Loaded 0 buffered events

      at src/components/EventsDebugPage.tsx:41:17

  console.log
    [EventsDebugPage] ✅ Registered message listeners

      at src/components/EventsDebugPage.tsx:83:13

  console.log
    [EventsDebugPage] 🔵 Received runtime message: SDK_EVENT_BROADCAST {
      type: 'SDK_EVENT_BROADCAST',
      payload: {
        eventName: 'ready',
        data: null,
        timestamp: '2025-10-17T15:42:22.765Z'
      }
    }

      at handleRuntimeMessage (src/components/EventsDebugPage.tsx:54:15)
          at Array.forEach (<anonymous>)

  console.log
    [EventsDebugPage] ✅ SDK_EVENT_BROADCAST received, adding event: {
      eventName: 'ready',
      data: null,
      timestamp: '2025-10-17T15:42:22.765Z'
    }

      at handleRuntimeMessage (src/components/EventsDebugPage.tsx:57:19)
          at Array.forEach (<anonymous>)

  console.log
    [EventsDebugPage] Adding event to list. Current count: 0 New count: 1

      at src/components/EventsDebugPage.tsx:66:21

  console.log
    [EventsDebugPage] 🔵 Received runtime message: SDK_EVENT_BROADCAST {
      type: 'SDK_EVENT_BROADCAST',
      payload: {
        eventName: 'exposure',
        data: null,
        timestamp: '2025-10-17T15:42:22.772Z'
      }
    }

      at handleRuntimeMessage (src/components/EventsDebugPage.tsx:54:15)
          at Array.forEach (<anonymous>)

  console.log
    [EventsDebugPage] ⚠️ SDK_EVENT_BROADCAST received but capture is paused

      at handleRuntimeMessage (src/components/EventsDebugPage.tsx:70:19)
          at Array.forEach (<anonymous>)

  console.log
    [EventsDebugPage] ❌ Removing message listeners

      at src/components/EventsDebugPage.tsx:88:15
          at Array.forEach (<anonymous>)

PASS src/components/__tests__/EventsDebugPage.test.tsx (8.785 s)
  EventsDebugPage
    Initial State
      ✓ renders empty state when no events (148 ms)
      ✓ renders pause and clear buttons (159 ms)
    Event Capture
      ✓ captures SDK events from chrome.runtime.onMessage (60 ms)
      ✓ captures SDK events from window.postMessage (sidebar forwarding) (99 ms)
      ✓ captures multiple events in chronological order (newest first) (74 ms)
      ✓ displays different event types with correct colors (299 ms)
    Pause/Resume Functionality
      ✓ pauses event capture when pause button clicked (154 ms)
      ✓ resumes event capture when resume button clicked (33 ms)
    Clear Functionality
      ✓ shows confirmation dialog and clears events when confirmed (45 ms)
      ✓ cancels clear when cancel button clicked (31 ms)
      ✓ clears all events when confirmed (28 ms)
    Event Selection and Event Viewer
      ✓ opens event viewer when event is clicked (14 ms)
      ✓ sends correct data for event with null data (15 ms)
      ✓ opens event viewer for different events (21 ms)
    Event Data Formatting
      ✓ truncates long event data preview in list (17 ms)
    Timestamp Formatting
      ✓ formats timestamp as HH:MM:SS.mmm in event list (14 ms)
    Edge Cases
      ✓ handles events without data (13 ms)
      ✓ ignores non-SDK events (107 ms)
      ✓ handles events while paused without losing existing events (120 ms)

FAIL src/sdk-bridge/__tests__/core/orchestrator.test.ts
  ● Test suite failed to run

    [96msrc/sdk-bridge/__tests__/core/orchestrator.test.ts[0m:[93m6[0m:[93m29[0m - [91merror[0m[90m TS2307: [0mCannot find module '../../sdk/detector' or its corresponding type declarations.

    [7m6[0m import { SDKDetector } from '../../sdk/detector'
    [7m [0m [91m                            ~~~~~~~~~~~~~~~~~~~~[0m

Summary of all failing tests
FAIL src/sdk-bridge/__tests__/experiment/override-manager.test.ts (6.858 s)
  ● OverrideManager › parseCookieOverrides › should return empty overrides for empty string

    TypeError: Cannot redefine property: cookie
        at Function.defineProperty (<anonymous>)

      16 |     // Mock document.cookie for JSDOM once
      17 |     mockCookies = {}
    > 18 |     Object.defineProperty(document, 'cookie', {
         |            ^
      19 |       get: () => {
      20 |         return Object.entries(mockCookies)
      21 |           .map(([name, value]) => `${name}=${value}`)

      at Object.<anonymous> (src/sdk-bridge/__tests__/experiment/override-manager.test.ts:18:12)

  ● OverrideManager › parseCookieOverrides › should parse simple format (variant only)

    TypeError: Cannot redefine property: cookie
        at Function.defineProperty (<anonymous>)

      16 |     // Mock document.cookie for JSDOM once
      17 |     mockCookies = {}
    > 18 |     Object.defineProperty(document, 'cookie', {
         |            ^
      19 |       get: () => {
      20 |         return Object.entries(mockCookies)
      21 |           .map(([name, value]) => `${name}=${value}`)

      at Object.<anonymous> (src/sdk-bridge/__tests__/experiment/override-manager.test.ts:18:12)

  ● OverrideManager › parseCookieOverrides › should parse format with env (variant.env)

    TypeError: Cannot redefine property: cookie
        at Function.defineProperty (<anonymous>)

      16 |     // Mock document.cookie for JSDOM once
      17 |     mockCookies = {}
    > 18 |     Object.defineProperty(document, 'cookie', {
         |            ^
      19 |       get: () => {
      20 |         return Object.entries(mockCookies)
      21 |           .map(([name, value]) => `${name}=${value}`)

      at Object.<anonymous> (src/sdk-bridge/__tests__/experiment/override-manager.test.ts:18:12)

  ● OverrideManager › parseCookieOverrides › should parse full format (variant.env.id)

    TypeError: Cannot redefine property: cookie
        at Function.defineProperty (<anonymous>)

      16 |     // Mock document.cookie for JSDOM once
      17 |     mockCookies = {}
    > 18 |     Object.defineProperty(document, 'cookie', {
         |            ^
      19 |       get: () => {
      20 |         return Object.entries(mockCookies)
      21 |           .map(([name, value]) => `${name}=${value}`)

      at Object.<anonymous> (src/sdk-bridge/__tests__/experiment/override-manager.test.ts:18:12)

  ● OverrideManager › parseCookieOverrides › should parse devEnv prefix

    TypeError: Cannot redefine property: cookie
        at Function.defineProperty (<anonymous>)

      16 |     // Mock document.cookie for JSDOM once
      17 |     mockCookies = {}
    > 18 |     Object.defineProperty(document, 'cookie', {
         |            ^
      19 |       get: () => {
      20 |         return Object.entries(mockCookies)
      21 |           .map(([name, value]) => `${name}=${value}`)

      at Object.<anonymous> (src/sdk-bridge/__tests__/experiment/override-manager.test.ts:18:12)

  ● OverrideManager › parseCookieOverrides › should decode URL-encoded devEnv

    TypeError: Cannot redefine property: cookie
        at Function.defineProperty (<anonymous>)

      16 |     // Mock document.cookie for JSDOM once
      17 |     mockCookies = {}
    > 18 |     Object.defineProperty(document, 'cookie', {
         |            ^
      19 |       get: () => {
      20 |         return Object.entries(mockCookies)
      21 |           .map(([name, value]) => `${name}=${value}`)

      at Object.<anonymous> (src/sdk-bridge/__tests__/experiment/override-manager.test.ts:18:12)

  ● OverrideManager › parseCookieOverrides › should decode URL-encoded experiment names

    TypeError: Cannot redefine property: cookie
        at Function.defineProperty (<anonymous>)

      16 |     // Mock document.cookie for JSDOM once
      17 |     mockCookies = {}
    > 18 |     Object.defineProperty(document, 'cookie', {
         |            ^
      19 |       get: () => {
      20 |         return Object.entries(mockCookies)
      21 |           .map(([name, value]) => `${name}=${value}`)

      at Object.<anonymous> (src/sdk-bridge/__tests__/experiment/override-manager.test.ts:18:12)

  ● OverrideManager › parseCookieOverrides › should handle mixed format overrides

    TypeError: Cannot redefine property: cookie
        at Function.defineProperty (<anonymous>)

      16 |     // Mock document.cookie for JSDOM once
      17 |     mockCookies = {}
    > 18 |     Object.defineProperty(document, 'cookie', {
         |            ^
      19 |       get: () => {
      20 |         return Object.entries(mockCookies)
      21 |           .map(([name, value]) => `${name}=${value}`)

      at Object.<anonymous> (src/sdk-bridge/__tests__/experiment/override-manager.test.ts:18:12)

  ● OverrideManager › parseCookieOverrides › should skip invalid entries with no name

    TypeError: Cannot redefine property: cookie
        at Function.defineProperty (<anonymous>)

      16 |     // Mock document.cookie for JSDOM once
      17 |     mockCookies = {}
    > 18 |     Object.defineProperty(document, 'cookie', {
         |            ^
      19 |       get: () => {
      20 |         return Object.entries(mockCookies)
      21 |           .map(([name, value]) => `${name}=${value}`)

      at Object.<anonymous> (src/sdk-bridge/__tests__/experiment/override-manager.test.ts:18:12)

  ● OverrideManager › parseCookieOverrides › should skip invalid entries with no values

    TypeError: Cannot redefine property: cookie
        at Function.defineProperty (<anonymous>)

      16 |     // Mock document.cookie for JSDOM once
      17 |     mockCookies = {}
    > 18 |     Object.defineProperty(document, 'cookie', {
         |            ^
      19 |       get: () => {
      20 |         return Object.entries(mockCookies)
      21 |           .map(([name, value]) => `${name}=${value}`)

      at Object.<anonymous> (src/sdk-bridge/__tests__/experiment/override-manager.test.ts:18:12)

  ● OverrideManager › parseCookieOverrides › should skip invalid entries with no colon

    TypeError: Cannot redefine property: cookie
        at Function.defineProperty (<anonymous>)

      16 |     // Mock document.cookie for JSDOM once
      17 |     mockCookies = {}
    > 18 |     Object.defineProperty(document, 'cookie', {
         |            ^
      19 |       get: () => {
      20 |         return Object.entries(mockCookies)
      21 |           .map(([name, value]) => `${name}=${value}`)

      at Object.<anonymous> (src/sdk-bridge/__tests__/experiment/override-manager.test.ts:18:12)

  ● OverrideManager › parseCookieOverrides › should handle devEnv without experiments

    TypeError: Cannot redefine property: cookie
        at Function.defineProperty (<anonymous>)

      16 |     // Mock document.cookie for JSDOM once
      17 |     mockCookies = {}
    > 18 |     Object.defineProperty(document, 'cookie', {
         |            ^
      19 |       get: () => {
      20 |         return Object.entries(mockCookies)
      21 |           .map(([name, value]) => `${name}=${value}`)

      at Object.<anonymous> (src/sdk-bridge/__tests__/experiment/override-manager.test.ts:18:12)

  ● OverrideManager › parseCookieOverrides › should handle empty devEnv

    TypeError: Cannot redefine property: cookie
        at Function.defineProperty (<anonymous>)

      16 |     // Mock document.cookie for JSDOM once
      17 |     mockCookies = {}
    > 18 |     Object.defineProperty(document, 'cookie', {
         |            ^
      19 |       get: () => {
      20 |         return Object.entries(mockCookies)
      21 |           .map(([name, value]) => `${name}=${value}`)

      at Object.<anonymous> (src/sdk-bridge/__tests__/experiment/override-manager.test.ts:18:12)

  ● OverrideManager › parseCookieOverrides › should handle malformed cookie gracefully

    TypeError: Cannot redefine property: cookie
        at Function.defineProperty (<anonymous>)

      16 |     // Mock document.cookie for JSDOM once
      17 |     mockCookies = {}
    > 18 |     Object.defineProperty(document, 'cookie', {
         |            ^
      19 |       get: () => {
      20 |         return Object.entries(mockCookies)
      21 |           .map(([name, value]) => `${name}=${value}`)

      at Object.<anonymous> (src/sdk-bridge/__tests__/experiment/override-manager.test.ts:18:12)

  ● OverrideManager › parseCookieOverrides › should log warning for parsing errors

    TypeError: Cannot redefine property: cookie
        at Function.defineProperty (<anonymous>)

      16 |     // Mock document.cookie for JSDOM once
      17 |     mockCookies = {}
    > 18 |     Object.defineProperty(document, 'cookie', {
         |            ^
      19 |       get: () => {
      20 |         return Object.entries(mockCookies)
      21 |           .map(([name, value]) => `${name}=${value}`)

      at Object.<anonymous> (src/sdk-bridge/__tests__/experiment/override-manager.test.ts:18:12)

  ● OverrideManager › parseCookieOverrides › should handle single experiment

    TypeError: Cannot redefine property: cookie
        at Function.defineProperty (<anonymous>)

      16 |     // Mock document.cookie for JSDOM once
      17 |     mockCookies = {}
    > 18 |     Object.defineProperty(document, 'cookie', {
         |            ^
      19 |       get: () => {
      20 |         return Object.entries(mockCookies)
      21 |           .map(([name, value]) => `${name}=${value}`)

      at Object.<anonymous> (src/sdk-bridge/__tests__/experiment/override-manager.test.ts:18:12)

  ● OverrideManager › parseCookieOverrides › should parse variant numbers correctly

    TypeError: Cannot redefine property: cookie
        at Function.defineProperty (<anonymous>)

      16 |     // Mock document.cookie for JSDOM once
      17 |     mockCookies = {}
    > 18 |     Object.defineProperty(document, 'cookie', {
         |            ^
      19 |       get: () => {
      20 |         return Object.entries(mockCookies)
      21 |           .map(([name, value]) => `${name}=${value}`)

      at Object.<anonymous> (src/sdk-bridge/__tests__/experiment/override-manager.test.ts:18:12)

  ● OverrideManager › checkOverridesCookie › should log when cookie is found

    TypeError: Cannot redefine property: cookie
        at Function.defineProperty (<anonymous>)

      16 |     // Mock document.cookie for JSDOM once
      17 |     mockCookies = {}
    > 18 |     Object.defineProperty(document, 'cookie', {
         |            ^
      19 |       get: () => {
      20 |         return Object.entries(mockCookies)
      21 |           .map(([name, value]) => `${name}=${value}`)

      at Object.<anonymous> (src/sdk-bridge/__tests__/experiment/override-manager.test.ts:18:12)

  ● OverrideManager › checkOverridesCookie › should log when cookie is not found

    TypeError: Cannot redefine property: cookie
        at Function.defineProperty (<anonymous>)

      16 |     // Mock document.cookie for JSDOM once
      17 |     mockCookies = {}
    > 18 |     Object.defineProperty(document, 'cookie', {
         |            ^
      19 |       get: () => {
      20 |         return Object.entries(mockCookies)
      21 |           .map(([name, value]) => `${name}=${value}`)

      at Object.<anonymous> (src/sdk-bridge/__tests__/experiment/override-manager.test.ts:18:12)

  ● OverrideManager › checkOverridesCookie › should log devEnv when present

    TypeError: Cannot redefine property: cookie
        at Function.defineProperty (<anonymous>)

      16 |     // Mock document.cookie for JSDOM once
      17 |     mockCookies = {}
    > 18 |     Object.defineProperty(document, 'cookie', {
         |            ^
      19 |       get: () => {
      20 |         return Object.entries(mockCookies)
      21 |           .map(([name, value]) => `${name}=${value}`)

      at Object.<anonymous> (src/sdk-bridge/__tests__/experiment/override-manager.test.ts:18:12)

  ● OverrideManager › checkOverridesCookie › should decode devEnv URL encoding

    TypeError: Cannot redefine property: cookie
        at Function.defineProperty (<anonymous>)

      16 |     // Mock document.cookie for JSDOM once
      17 |     mockCookies = {}
    > 18 |     Object.defineProperty(document, 'cookie', {
         |            ^
      19 |       get: () => {
      20 |         return Object.entries(mockCookies)
      21 |           .map(([name, value]) => `${name}=${value}`)

      at Object.<anonymous> (src/sdk-bridge/__tests__/experiment/override-manager.test.ts:18:12)

  ● OverrideManager › checkOverridesCookie › should handle errors gracefully

    TypeError: Cannot redefine property: cookie
        at Function.defineProperty (<anonymous>)

      16 |     // Mock document.cookie for JSDOM once
      17 |     mockCookies = {}
    > 18 |     Object.defineProperty(document, 'cookie', {
         |            ^
      19 |       get: () => {
      20 |         return Object.entries(mockCookies)
      21 |           .map(([name, value]) => `${name}=${value}`)

      at Object.<anonymous> (src/sdk-bridge/__tests__/experiment/override-manager.test.ts:18:12)

  ● OverrideManager › getCookieValue › should return cookie value when cookie exists

    TypeError: Cannot redefine property: cookie
        at Function.defineProperty (<anonymous>)

      16 |     // Mock document.cookie for JSDOM once
      17 |     mockCookies = {}
    > 18 |     Object.defineProperty(document, 'cookie', {
         |            ^
      19 |       get: () => {
      20 |         return Object.entries(mockCookies)
      21 |           .map(([name, value]) => `${name}=${value}`)

      at Object.<anonymous> (src/sdk-bridge/__tests__/experiment/override-manager.test.ts:18:12)

  ● OverrideManager › getCookieValue › should return null when cookie does not exist

    TypeError: Cannot redefine property: cookie
        at Function.defineProperty (<anonymous>)

      16 |     // Mock document.cookie for JSDOM once
      17 |     mockCookies = {}
    > 18 |     Object.defineProperty(document, 'cookie', {
         |            ^
      19 |       get: () => {
      20 |         return Object.entries(mockCookies)
      21 |           .map(([name, value]) => `${name}=${value}`)

      at Object.<anonymous> (src/sdk-bridge/__tests__/experiment/override-manager.test.ts:18:12)

  ● OverrideManager › getCookieValue › should handle multiple cookies

    TypeError: Cannot redefine property: cookie
        at Function.defineProperty (<anonymous>)

      16 |     // Mock document.cookie for JSDOM once
      17 |     mockCookies = {}
    > 18 |     Object.defineProperty(document, 'cookie', {
         |            ^
      19 |       get: () => {
      20 |         return Object.entries(mockCookies)
      21 |           .map(([name, value]) => `${name}=${value}`)

      at Object.<anonymous> (src/sdk-bridge/__tests__/experiment/override-manager.test.ts:18:12)

  ● OverrideManager › getCookieValue › should handle errors gracefully

    TypeError: Cannot redefine property: cookie
        at Function.defineProperty (<anonymous>)

      16 |     // Mock document.cookie for JSDOM once
      17 |     mockCookies = {}
    > 18 |     Object.defineProperty(document, 'cookie', {
         |            ^
      19 |       get: () => {
      20 |         return Object.entries(mockCookies)
      21 |           .map(([name, value]) => `${name}=${value}`)

      at Object.<anonymous> (src/sdk-bridge/__tests__/experiment/override-manager.test.ts:18:12)

  ● OverrideManager › getOverrides › should return parsed overrides when cookie exists

    TypeError: Cannot redefine property: cookie
        at Function.defineProperty (<anonymous>)

      16 |     // Mock document.cookie for JSDOM once
      17 |     mockCookies = {}
    > 18 |     Object.defineProperty(document, 'cookie', {
         |            ^
      19 |       get: () => {
      20 |         return Object.entries(mockCookies)
      21 |           .map(([name, value]) => `${name}=${value}`)

      at Object.<anonymous> (src/sdk-bridge/__tests__/experiment/override-manager.test.ts:18:12)

  ● OverrideManager › getOverrides › should return empty overrides when cookie does not exist

    TypeError: Cannot redefine property: cookie
        at Function.defineProperty (<anonymous>)

      16 |     // Mock document.cookie for JSDOM once
      17 |     mockCookies = {}
    > 18 |     Object.defineProperty(document, 'cookie', {
         |            ^
      19 |       get: () => {
      20 |         return Object.entries(mockCookies)
      21 |           .map(([name, value]) => `${name}=${value}`)

      at Object.<anonymous> (src/sdk-bridge/__tests__/experiment/override-manager.test.ts:18:12)

  ● OverrideManager › getOverrides › should return parsed overrides with devEnv

    TypeError: Cannot redefine property: cookie
        at Function.defineProperty (<anonymous>)

      16 |     // Mock document.cookie for JSDOM once
      17 |     mockCookies = {}
    > 18 |     Object.defineProperty(document, 'cookie', {
         |            ^
      19 |       get: () => {
      20 |         return Object.entries(mockCookies)
      21 |           .map(([name, value]) => `${name}=${value}`)

      at Object.<anonymous> (src/sdk-bridge/__tests__/experiment/override-manager.test.ts:18:12)

  ● OverrideManager › custom cookie name › should use custom cookie name

    TypeError: Cannot redefine property: cookie
        at Function.defineProperty (<anonymous>)

      16 |     // Mock document.cookie for JSDOM once
      17 |     mockCookies = {}
    > 18 |     Object.defineProperty(document, 'cookie', {
         |            ^
      19 |       get: () => {
      20 |         return Object.entries(mockCookies)
      21 |           .map(([name, value]) => `${name}=${value}`)

      at Object.<anonymous> (src/sdk-bridge/__tests__/experiment/override-manager.test.ts:18:12)

  ● OverrideManager › custom cookie name › should check custom cookie name

    TypeError: Cannot redefine property: cookie
        at Function.defineProperty (<anonymous>)

      16 |     // Mock document.cookie for JSDOM once
      17 |     mockCookies = {}
    > 18 |     Object.defineProperty(document, 'cookie', {
         |            ^
      19 |       get: () => {
      20 |         return Object.entries(mockCookies)
      21 |           .map(([name, value]) => `${name}=${value}`)

      at Object.<anonymous> (src/sdk-bridge/__tests__/experiment/override-manager.test.ts:18:12)

  ● OverrideManager › edge cases › should handle very long experiment names

    TypeError: Cannot redefine property: cookie
        at Function.defineProperty (<anonymous>)

      16 |     // Mock document.cookie for JSDOM once
      17 |     mockCookies = {}
    > 18 |     Object.defineProperty(document, 'cookie', {
         |            ^
      19 |       get: () => {
      20 |         return Object.entries(mockCookies)
      21 |           .map(([name, value]) => `${name}=${value}`)

      at Object.<anonymous> (src/sdk-bridge/__tests__/experiment/override-manager.test.ts:18:12)

  ● OverrideManager › edge cases › should handle many experiments

    TypeError: Cannot redefine property: cookie
        at Function.defineProperty (<anonymous>)

      16 |     // Mock document.cookie for JSDOM once
      17 |     mockCookies = {}
    > 18 |     Object.defineProperty(document, 'cookie', {
         |            ^
      19 |       get: () => {
      20 |         return Object.entries(mockCookies)
      21 |           .map(([name, value]) => `${name}=${value}`)

      at Object.<anonymous> (src/sdk-bridge/__tests__/experiment/override-manager.test.ts:18:12)

  ● OverrideManager › edge cases › should handle special characters in experiment names

    TypeError: Cannot redefine property: cookie
        at Function.defineProperty (<anonymous>)

      16 |     // Mock document.cookie for JSDOM once
      17 |     mockCookies = {}
    > 18 |     Object.defineProperty(document, 'cookie', {
         |            ^
      19 |       get: () => {
      20 |         return Object.entries(mockCookies)
      21 |           .map(([name, value]) => `${name}=${value}`)

      at Object.<anonymous> (src/sdk-bridge/__tests__/experiment/override-manager.test.ts:18:12)

  ● OverrideManager › edge cases › should handle whitespace in cookie value

    TypeError: Cannot redefine property: cookie
        at Function.defineProperty (<anonymous>)

      16 |     // Mock document.cookie for JSDOM once
      17 |     mockCookies = {}
    > 18 |     Object.defineProperty(document, 'cookie', {
         |            ^
      19 |       get: () => {
      20 |         return Object.entries(mockCookies)
      21 |           .map(([name, value]) => `${name}=${value}`)

      at Object.<anonymous> (src/sdk-bridge/__tests__/experiment/override-manager.test.ts:18:12)

  ● OverrideManager › edge cases › should handle variant value of 0

    TypeError: Cannot redefine property: cookie
        at Function.defineProperty (<anonymous>)

      16 |     // Mock document.cookie for JSDOM once
      17 |     mockCookies = {}
    > 18 |     Object.defineProperty(document, 'cookie', {
         |            ^
      19 |       get: () => {
      20 |         return Object.entries(mockCookies)
      21 |           .map(([name, value]) => `${name}=${value}`)

      at Object.<anonymous> (src/sdk-bridge/__tests__/experiment/override-manager.test.ts:18:12)

  ● OverrideManager › edge cases › should handle large variant numbers

    TypeError: Cannot redefine property: cookie
        at Function.defineProperty (<anonymous>)

      16 |     // Mock document.cookie for JSDOM once
      17 |     mockCookies = {}
    > 18 |     Object.defineProperty(document, 'cookie', {
         |            ^
      19 |       get: () => {
      20 |         return Object.entries(mockCookies)
      21 |           .map(([name, value]) => `${name}=${value}`)

      at Object.<anonymous> (src/sdk-bridge/__tests__/experiment/override-manager.test.ts:18:12)

FAIL src/sdk-bridge/__tests__/experiment/code-injector.test.ts (7.455 s)
  ● CodeInjector › injectExperimentCode › should handle errors during injection

    expect(jest.fn()).toHaveBeenCalledWith(...expected)

    Expected: "[ABsmartly Extension] Error processing experiment 0:", Any<Error>
    Received: "[ABsmartly Extension] Failed to execute script from headStart:", [Error: Insert error]

    Number of calls: 1

      314 |       injector.injectExperimentCode(context)
      315 |
    > 316 |       expect(mockLogger.error).toHaveBeenCalledWith(
          |                                ^
      317 |         '[ABsmartly Extension] Error processing experiment 0:',
      318 |         expect.any(Error)
      319 |       )

      at Object.<anonymous> (src/sdk-bridge/__tests__/experiment/code-injector.test.ts:316:32)

  ● CodeInjector › executeScriptsInHTML › should extract and execute external scripts

    expect(received).toBe(expected) // Object.is equality

    Expected: "test.js"
    Received: "http://localhost/test.js"

      374 |       const scripts = document.head.querySelectorAll('script[data-absmartly-injected]')
      375 |       expect(scripts.length).toBe(1)
    > 376 |       expect(scripts[0].getAttribute('src')).toBe('test.js')
          |                                              ^
      377 |       expect(scripts[0].getAttribute('data-absmartly-injected')).toBe('headEnd')
      378 |     })
      379 |

      at Object.<anonymous> (src/sdk-bridge/__tests__/experiment/code-injector.test.ts:376:46)

  ● CodeInjector › executeScriptsInHTML › should preserve script async attribute

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: undefined

      384 |
      385 |       const scripts = document.head.querySelectorAll('script')
    > 386 |       expect(scripts[0].async).toBe(true)
          |                                ^
      387 |     })
      388 |
      389 |     it('should preserve script defer attribute', () => {

      at Object.<anonymous> (src/sdk-bridge/__tests__/experiment/code-injector.test.ts:386:32)

  ● CodeInjector › executeScriptsInHTML › should process multiple external scripts

    expect(received).toBe(expected) // Object.is equality

    Expected: "test1.js"
    Received: "http://localhost/test1.js"

      415 |       const scripts = document.body.querySelectorAll('script[data-absmartly-injected]')
      416 |       expect(scripts.length).toBe(2)
    > 417 |       expect(scripts[0].getAttribute('src')).toBe('test1.js')
          |                                              ^
      418 |       expect(scripts[1].getAttribute('src')).toBe('test2.js')
      419 |     })
      420 |

      at Object.<anonymous> (src/sdk-bridge/__tests__/experiment/code-injector.test.ts:417:46)

  ● CodeInjector › executeScriptsInHTML › should handle mixed inline and external scripts

    expect(received).toBe(expected) // Object.is equality

    Expected: "external.js"
    Received: "http://localhost/external.js"

      450 |       const scripts = document.head.querySelectorAll('script')
      451 |       expect(scripts.length).toBe(1) // Only external script
    > 452 |       expect(scripts[0].getAttribute('src')).toBe('external.js')
          |                                              ^
      453 |       expect(mockLogger.warn).toHaveBeenCalledWith(
      454 |         '[ABsmartly Extension] Inline script execution disabled for security from headEnd'
      455 |       )

      at Object.<anonymous> (src/sdk-bridge/__tests__/experiment/code-injector.test.ts:452:46)

  ● CodeInjector › matchesUrlFilter › should match simple string pattern

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      540 |
      541 |     it('should match simple string pattern', () => {
    > 542 |       expect(injector.matchesUrlFilter('/path/to/page')).toBe(true)
          |                                                          ^
      543 |     })
      544 |
      545 |     it('should not match different string pattern', () => {

      at Object.<anonymous> (src/sdk-bridge/__tests__/experiment/code-injector.test.ts:542:58)

  ● CodeInjector › matchesUrlFilter › should match wildcard pattern *

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      548 |
      549 |     it('should match wildcard pattern *', () => {
    > 550 |       expect(injector.matchesUrlFilter('/path/*')).toBe(true)
          |                                                    ^
      551 |     })
      552 |
      553 |     it('should match wildcard pattern ?', () => {

      at Object.<anonymous> (src/sdk-bridge/__tests__/experiment/code-injector.test.ts:550:52)

  ● CodeInjector › matchesUrlFilter › should match wildcard pattern ?

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      552 |
      553 |     it('should match wildcard pattern ?', () => {
    > 554 |       expect(injector.matchesUrlFilter('/path/to/pag?')).toBe(true)
          |                                                          ^
      555 |     })
      556 |
      557 |     it('should match array of patterns', () => {

      at Object.<anonymous> (src/sdk-bridge/__tests__/experiment/code-injector.test.ts:554:58)

  ● CodeInjector › matchesUrlFilter › should match array of patterns

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      556 |
      557 |     it('should match array of patterns', () => {
    > 558 |       expect(injector.matchesUrlFilter(['/wrong', '/path/to/page', '/also-wrong'])).toBe(true)
          |                                                                                     ^
      559 |     })
      560 |
      561 |     it('should not match when none in array match', () => {

      at Object.<anonymous> (src/sdk-bridge/__tests__/experiment/code-injector.test.ts:558:85)

  ● CodeInjector › matchesUrlFilter › should match include patterns

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      568 |           include: ['/path/*']
      569 |         })
    > 570 |       ).toBe(true)
          |         ^
      571 |     })
      572 |
      573 |     it('should exclude before include', () => {

      at Object.<anonymous> (src/sdk-bridge/__tests__/experiment/code-injector.test.ts:570:9)

  ● CodeInjector › matchesUrlFilter › should match regex pattern

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      586 |           mode: 'regex'
      587 |         })
    > 588 |       ).toBe(true)
          |         ^
      589 |     })
      590 |
      591 |     it('should handle invalid regex gracefully', () => {

      at Object.<anonymous> (src/sdk-bridge/__tests__/experiment/code-injector.test.ts:588:9)

  ● CodeInjector › matchesUrlFilter › should match full URL when matchType is full-url

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      609 |           matchType: 'full-url'
      610 |         })
    > 611 |       ).toBe(true)
          |         ^
      612 |     })
      613 |
      614 |     it('should match domain when matchType is domain', () => {

      at Object.<anonymous> (src/sdk-bridge/__tests__/experiment/code-injector.test.ts:611:9)

  ● CodeInjector › matchesUrlFilter › should match domain when matchType is domain

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      618 |           matchType: 'domain'
      619 |         })
    > 620 |       ).toBe(true)
          |         ^
      621 |     })
      622 |
      623 |     it('should match query when matchType is query', () => {

      at Object.<anonymous> (src/sdk-bridge/__tests__/experiment/code-injector.test.ts:620:9)

  ● CodeInjector › matchesUrlFilter › should match query when matchType is query

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      627 |           matchType: 'query'
      628 |         })
    > 629 |       ).toBe(true)
          |         ^
      630 |     })
      631 |
      632 |     it('should match hash when matchType is hash', () => {

      at Object.<anonymous> (src/sdk-bridge/__tests__/experiment/code-injector.test.ts:629:9)

  ● CodeInjector › matchesUrlFilter › should match hash when matchType is hash

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      636 |           matchType: 'hash'
      637 |         })
    > 638 |       ).toBe(true)
          |         ^
      639 |     })
      640 |
      641 |     it('should match path by default', () => {

      at Object.<anonymous> (src/sdk-bridge/__tests__/experiment/code-injector.test.ts:638:9)

  ● CodeInjector › matchesUrlFilter › should match path by default

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      644 |           include: ['/path/to/page']
      645 |         })
    > 646 |       ).toBe(true)
          |         ^
      647 |     })
      648 |
      649 |     it('should return true when no include patterns', () => {

      at Object.<anonymous> (src/sdk-bridge/__tests__/experiment/code-injector.test.ts:646:9)

FAIL src/sdk-bridge/__tests__/core/orchestrator.test.ts
  ● Test suite failed to run

    [96msrc/sdk-bridge/__tests__/core/orchestrator.test.ts[0m:[93m6[0m:[93m29[0m - [91merror[0m[90m TS2307: [0mCannot find module '../../sdk/detector' or its corresponding type declarations.

    [7m6[0m import { SDKDetector } from '../../sdk/detector'
    [7m [0m [91m                            ~~~~~~~~~~~~~~~~~~~~[0m


Test Suites: 3 failed, 25 passed, 28 total
Tests:       53 failed, 819 passed, 872 total
Snapshots:   0 total
Time:        11.017 s
Ran all test suites.
